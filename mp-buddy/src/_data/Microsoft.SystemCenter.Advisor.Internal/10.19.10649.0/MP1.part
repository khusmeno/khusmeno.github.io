<ManagementPack xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" ContentReadable="true" SchemaVersion="2.0" OriginalSchemaVersion="2.0"><Manifest><Identity><ID>Microsoft.SystemCenter.Advisor.Internal</ID><Version>10.19.10649.0</Version></Identity><Name>Microsoft SystemCenter Advisor Internal ManagementPack</Name><References><Reference Alias="SC"><ID>Microsoft.SystemCenter.Library</ID><Version>7.0.8443.6</Version><PublicKeyToken>31bf3856ad364e35</PublicKeyToken></Reference><Reference Alias="Windows"><ID>Microsoft.Windows.Library</ID><Version>7.5.8500.0</Version><PublicKeyToken>31bf3856ad364e35</PublicKeyToken></Reference><Reference Alias="Health"><ID>System.Health.Library</ID><Version>7.0.8443.6</Version><PublicKeyToken>31bf3856ad364e35</PublicKeyToken></Reference><Reference Alias="System"><ID>System.Library</ID><Version>7.5.8500.0</Version><PublicKeyToken>31bf3856ad364e35</PublicKeyToken></Reference><Reference
Alias="InstanceGroup"><ID>Microsoft.SystemCenter.InstanceGroup.Library</ID><Version>7.5.8500.0</Version><PublicKeyToken>31bf3856ad364e35</PublicKeyToken></Reference><Reference Alias="Cluster"><ID>Microsoft.Windows.Cluster.Library</ID><Version>7.0.8443.6</Version><PublicKeyToken>31bf3856ad364e35</PublicKeyToken></Reference></References></Manifest><TypeDefinitions><EntityTypes><ClassTypes><ClassType ID="Microsoft.SystemCenter.Advisor.Internal.AdvisorConnector" Accessibility="Public" Abstract="false" Base="Windows!Microsoft.Windows.LocalApplication" Hosted="true" Singleton="false" Extension="false"><Property ID="AgentID" Type="string" AutoIncrement="false" Key="true" CaseSensitive="false" MaxLength="256" MinLength="0" Required="false" Scale="0" /><Property ID="PrincipalName" Type="string" AutoIncrement="false" Key="false" CaseSensitive="false" MaxLength="256" MinLength="0" Required="false" Scale="0" /><Property ID="Version" Type="string" AutoIncrement="false" Key="false"
CaseSensitive="false" MaxLength="256" MinLength="0" Required="false" Scale="0" /></ClassType><ClassType ID="Microsoft.SystemCenter.Advisor.Internal.Advisor_Lync" Accessibility="Internal" Abstract="false" Base="Windows!Microsoft.Windows.ApplicationComponent" Hosted="true" Singleton="false" Extension="false"><Property ID="LyncDiscovered" Type="int" AutoIncrement="false" Key="true" CaseSensitive="false" MaxLength="256" MinLength="0" Required="false" Scale="0" /></ClassType><ClassType ID="Microsoft.SystemCenter.Advisor.Internal.Advisor_Sharepoint" Accessibility="Internal" Abstract="false" Base="Windows!Microsoft.Windows.ApplicationComponent" Hosted="true" Singleton="false" Extension="false"><Property ID="SharepointDiscovered" Type="int" AutoIncrement="false" Key="true" CaseSensitive="false" MaxLength="256" MinLength="0" Required="false" Scale="0" /></ClassType><ClassType ID="Microsoft.SystemCenter.Advisor.Library.ServerOptInOutGroup" Accessibility="Public" Abstract="false"
Base="InstanceGroup!Microsoft.SystemCenter.InstanceGroup" Hosted="false" Singleton="true" Extension="false" /></ClassTypes><RelationshipTypes><RelationshipType ID="AdvisorHostLync" Accessibility="Internal" Abstract="false" Base="System!System.Hosting"><Source ID="AdvisorConnectorSource" MinCardinality="0" MaxCardinality="2147483647" Type="Microsoft.SystemCenter.Advisor.Internal.AdvisorConnector" /><Target ID="LyncTarget" MinCardinality="0" MaxCardinality="2147483647" Type="Microsoft.SystemCenter.Advisor.Internal.Advisor_Lync" /></RelationshipType><RelationshipType ID="AdvisorHostSharepoint" Accessibility="Internal" Abstract="false" Base="System!System.Hosting"><Source ID="AdvisorConnectorSource" MinCardinality="0" MaxCardinality="2147483647" Type="Microsoft.SystemCenter.Advisor.Internal.AdvisorConnector" /><Target ID="SharepointTarget" MinCardinality="0" MaxCardinality="2147483647" Type="Microsoft.SystemCenter.Advisor.Internal.Advisor_Sharepoint"
/></RelationshipType></RelationshipTypes></EntityTypes><SecureReferences><SecureReference ID="Microsoft.SharePoint.Foundation.2010.AdminAccount" Accessibility="Public" Context="System!System.Entity" /><SecureReference ID="Microsoft.KnowledgeServices.ElevatedAccount" Accessibility="Public" Context="System!System.Entity" /></SecureReferences><ModuleTypes><DataSourceModuleType ID="Microsoft.SystemCenter.Advisor.Monitoring.AgentCabDataSource" Accessibility="Public" RunAs="System!System.PrivilegedMonitoringAccount" Batching="false"><Configuration><xsd:element xmlns:xsd="http://www.w3.org/2001/XMLSchema" name="Frequency" type="xsd:int" /><xsd:element xmlns:xsd="http://www.w3.org/2001/XMLSchema" name="AgentId" type="xsd:string" /></Configuration><OverrideableParameters><OverrideableParameter ID="Frequency" Selector="$Config/Frequency$" ParameterType="int" /></OverrideableParameters><ModuleImplementation Isolation="Any"><Composite><MemberModules><DataSource ID="SS"
TypeID="System!System.SimpleScheduler"><IntervalSeconds>$Config/Frequency$</IntervalSeconds><SyncTime>12:00</SyncTime></DataSource><ProbeAction ID="ACP" TypeID="Microsoft.SystemCenter.Advisor.Monitoring.AgentCabProbeAction"><AgentId>$Config/AgentId$</AgentId></ProbeAction></MemberModules><Composition><Node ID="ACP"><Node ID="SS" /></Node></Composition></Composite></ModuleImplementation><OutputType>System!System.PropertyBagData</OutputType></DataSourceModuleType><DataSourceModuleType ID="Microsoft.SystemCenter.Advisor.Monitoring.ComputerOptInCompatibleDataSource" Accessibility="Internal" RunAs="System!System.PrivilegedMonitoringAccount" Batching="false"><Configuration><xsd:element xmlns:xsd="http://www.w3.org/2001/XMLSchema" name="EnableConnector" type="xsd:boolean" /><xsd:element xmlns:xsd="http://www.w3.org/2001/XMLSchema" name="ManagementGroupId" type="xsd:string" /></Configuration><OverrideableParameters><OverrideableParameter ID="EnableConnector"
Selector="$Config/EnableConnector$" ParameterType="bool" /></OverrideableParameters><ModuleImplementation Isolation="Any"><Managed><Assembly>Res.Microsoft.SystemCenter.Advisor.Internal</Assembly><Type>Microsoft.SystemCenter.Advisor.Internal.DataSource.ServerOptInCompatibleDataSource</Type></Managed></ModuleImplementation><OutputType>System!System.PropertyBagData</OutputType></DataSourceModuleType><DataSourceModuleType ID="Microsoft.SystemCenter.Advisor.Monitoring.ServerOptInOutDataSource" Accessibility="Internal" RunAs="System!System.PrivilegedMonitoringAccount" Batching="false"><Configuration><xsd:element xmlns:xsd="http://www.w3.org/2001/XMLSchema" name="EnableConnector" type="xsd:boolean" /><xsd:element xmlns:xsd="http://www.w3.org/2001/XMLSchema" name="ManagementGroupId" type="xsd:string" /></Configuration><OverrideableParameters><OverrideableParameter ID="EnableConnector" Selector="$Config/EnableConnector$" ParameterType="bool" /></OverrideableParameters><ModuleImplementation
Isolation="Any"><Managed><Assembly>Res.Microsoft.SystemCenter.Advisor.Internal</Assembly><Type>Microsoft.SystemCenter.Advisor.Internal.DataSource.ServerOptInOutDataSource</Type></Managed></ModuleImplementation><OutputType>System!System.PropertyBagData</OutputType></DataSourceModuleType><ProbeActionModuleType ID="Microsoft.SystemCenter.Advisor.Monitoring.AgentCabProbeAction" Accessibility="Public" Batching="false" PassThrough="false"><Configuration><xsd:element xmlns:xsd="http://www.w3.org/2001/XMLSchema" name="AgentId" type="xsd:string" /></Configuration><ModuleImplementation Isolation="Any"><Managed><Assembly>Res.Microsoft.SystemCenter.Advisor.Internal</Assembly><Type>Microsoft.SystemCenter.Advisor.Internal.ProbeAction.CabProbeAction</Type></Managed></ModuleImplementation><OutputType>System!System.PropertyBagData</OutputType><InputType>System!System.BaseData</InputType></ProbeActionModuleType><WriteActionModuleType
ID="Microsoft.SystemCenter.Advisor.Monitoring.RestartHealthServiceAction" Accessibility="Internal" RunAs="System!System.PrivilegedMonitoringAccount" Batching="false"><Configuration><IncludeSchemaTypes><SchemaType>Windows!Microsoft.Windows.WindowsEventLogEventTypeSchema</SchemaType></IncludeSchemaTypes><xsd:element xmlns:xsd="http://www.w3.org/2001/XMLSchema" name="EventId" type="xsd:integer" /><xsd:element xmlns:xsd="http://www.w3.org/2001/XMLSchema" name="EventType" type="WindowsEventLogEventType" /><xsd:element xmlns:xsd="http://www.w3.org/2001/XMLSchema" name="RestartReason" type="xsd:string" /><xsd:element xmlns:xsd="http://www.w3.org/2001/XMLSchema" name="RestartAttempts" type="xsd:integer" /><xsd:element xmlns:xsd="http://www.w3.org/2001/XMLSchema" name="Timeout" type="xsd:integer" /></Configuration><OverrideableParameters><OverrideableParameter ID="RestartAttempts" Selector="$Config/RestartAttempts$" ParameterType="int" /><OverrideableParameter ID="Timeout"
Selector="$Config/Timeout$" ParameterType="int" /></OverrideableParameters><ModuleImplementation Isolation="Any"><Composite><MemberModules><WriteAction ID="RestartHealthService" TypeID="System!System.CommandExecuter"><ApplicationName>%windir%\system32\cscript.exe</ApplicationName><WorkingDirectory /><CommandLine>$File/LaunchRestartHealthService.js$ $Config/EventId$ $Config/EventType$ $Config/RestartAttempts$ $Config/Timeout$ "$Config/RestartReason$"</CommandLine><TimeoutSeconds>300</TimeoutSeconds><RequireOutput>true</RequireOutput><Files><File><Name>LaunchRestartHealthService.js</Name><Contents>
                      
var oAPI = new ActiveXObject("MOM.ScriptAPI");
var oShell = new ActiveXObject("WScript.Shell");
var oArgs = WScript.Arguments;
var SCRIPT_NAME = "LaunchRestartHealthService.js";
var ENU_MESSAGE_BASE = "Launching Restart Health Service. ";
var SW_HIDE = 0;
var CREATE_BREAKAWAY_FROM_JOB = 0x1000000;
// Process Arguments:
//      0 - EventId
//      1 - EventType
//      2 - RestartAttempts
//      3 - Timeout
//      4 - RestartReason
var EventId, EventType, RestartReason, RestartAttempts, Timeout;
EventId         = oArgs(0);
EventType       = oArgs(1);
RestartAttempts = oArgs(2);
Timeout         = oArgs(3);
RestartReason   = oArgs(4);
var EVENTLOG_SUCCESS =              0x0000;     /*  Information event    */
var EVENTLOG_AUDIT_FAILURE =        0x0010;     /*  Failure Audit event  */
var EVENTLOG_AUDIT_SUCCESS =        0x0008;     /*  Success Audit event  */
var EVENTLOG_ERROR_TYPE =           0x0001;     /*  Error event          */
var EVENTLOG_INFORMATION_TYPE =     0x0004;     /*  Information event    */
var EVENTLOG_WARNING_TYPE =         0x0002;     /*  Warning event        */
switch (EventType) 
{
    case "Success" :
        EventType = EVENTLOG_SUCCESS;
        break;
    case "AuditFailure" :
        EventType = EVENTLOG_AUDIT_FAILURE;
        break;
    case "AuditSuccess" :
        EventType = EVENTLOG_AUDIT_SUCCESS;
        break;
    case "Error" :
        EventType = EVENTLOG_ERROR_TYPE;
        break;
    case "Information" :
        EventType = EVENTLOG_INFORMATION_TYPE;
        break;
    case "Warning" :
        EventType = EVENTLOG_WARNING_TYPE;
        break;
}
RestartReason = ENU_MESSAGE_BASE + RestartReason;
oAPI.LogScriptEvent(SCRIPT_NAME, EventId, EventType, RestartReason);
oShell.Run("%ComSpec% /c copy \"" + GetPath() + "RestartHealthService.js\" %Temp%\\RestartHealthService.js");
var strCommand = oShell.ExpandEnvironmentStrings("%ComSpec% /c cscript.exe %Temp%\\RestartHealthService.js " + RestartAttempts + " " + Timeout);
var objWMIService = GetObject("winmgmts:{impersonationLevel=impersonate}!\\\\.\\root\\cimv2");
// Configure the process to break away from the job
var objStartup = objWMIService.Get("Win32_ProcessStartup");
var objConfig = objStartup.SpawnInstance_();
objConfig.ShowWindow = SW_HIDE;
objConfig.CreateFlags = CREATE_BREAKAWAY_FROM_JOB;
// Create the process
var objProcess = objWMIService.Get("Win32_Process");
var intProcessID;
var intReturn = objProcess.Create(strCommand, null, objConfig, intProcessID);
function GetPath() 
{ 
    var path = WScript.ScriptFullName;
    path = path.substr(0, path.lastIndexOf("\\") + 1); 
    return path;
}
                                
                    </Contents><Unicode>false</Unicode></File><File><Name>RestartHealthService.js</Name><Contents>
                      
var oShell = new ActiveXObject("WScript.Shell");
var oAPI = new ActiveXObject("MOM.ScriptAPI");
var objWMIService = GetObject("winmgmts:{impersonationLevel=impersonate}!\\\\.\\root\\cimv2");
var oArgs = WScript.Arguments;
var RestartAttempts = oArgs(0);
var TimeOut         = parseInt(oArgs(1)) * 1000;
var SCRIPT_NAME = "RestartHealthService.js";
var ENU_MESSAGE_BASE = "Restarting Health Service. ";
var EVENTLOG_SUCCESS      = 0x0000; // Information event
var EVENTLOG_ERROR_TYPE   = 0x0001; // Error event
var EVENTLOG_WARNING_TYPE = 0x0002; // Warning event
var eventIdWarning  = 6060;
var eventIdError    = 6061;
var eventIdSuccess  = 6062;
var ServiceScript = "SELECT ProcessId, State FROM Win32_Service WHERE name = 'HealthService'";
var successul = false;
for (var i=0; i&lt;RestartAttempts; i++)
{
    try
    {
        // Stop Service
        oShell.Run("net stop HealthService");
        if (GetServiceState() != "Stopped")
        {
            WScript.Sleep(TimeOut);
            if (GetServiceState() != "Stopped")
            {
                // Terminate in case service failed to stop
                var serviceItems = new Enumerator(objWMIService.ExecQuery(ServiceScript));
                var procItems = new Enumerator(objWMIService.ExecQuery("SELECT ProcessId FROM Win32_Process WHERE ProcessId = " + serviceItems.item().ProcessId));
                var terminated = false;
                
                while (!procItems.atEnd())
                {
                    var successful = 1;
                    var counter = 0;
                    while (successful != 0 &amp;&amp; counter &lt; RestartAttempts)
                    {
                        successful = procItems.item().Terminate();
                        if (successful == 0)
                        {
                            terminated = true;
                            break;
                        }
                        counter++;
                    }
                    procItems.moveNext()
                }
                
                if (!terminated)
                {
                    throw "Failed to Terminate Health Service";
                }
            }
        }
        for (var j=0; j&lt;3; j++)
        {
            // Start Service
            oShell.Run("net start HealthService");
            WScript.Sleep(TimeOut);
            if (GetServiceState() == "Running")
            {
                successful = true;
                break;
            }
        }
        if (successful) break;
    }
    catch(e)
    {
        if (e != 0)
        {
            var errorMessage = ENU_MESSAGE_BASE + "Error: " + e;
            oAPI.LogScriptEvent(SCRIPT_NAME, eventIdWarning, EVENTLOG_WARNING_TYPE, errorMessage);
        }
    }
}
if (successful)
{
    var message = ENU_MESSAGE_BASE + "Service successfully restarted.";
    oAPI.LogScriptEvent(SCRIPT_NAME, eventIdSuccess, EVENTLOG_SUCCESS, message);
}
else
{
    var errorMessage = ENU_MESSAGE_BASE + "Failed to restart service.";
    oAPI.LogScriptEvent(SCRIPT_NAME, eventIdError, EVENTLOG_ERROR_TYPE, errorMessage);
}
function GetServiceState()
{ 
      var serviceItems = new Enumerator(objWMIService.ExecQuery(ServiceScript));
      if (null == serviceItems || null == serviceItems.item())
      {
          throw "HealthService does not exist!";
      }
      return serviceItems.item().State;
}
                                
                    </Contents><Unicode>false</Unicode></File></Files></WriteAction></MemberModules><Composition><Node ID="RestartHealthService" /></Composition></Composite></ModuleImplementation><OutputType>System!System.CommandOutput</OutputType><InputType>System!System.PropertyBagData</InputType></WriteActionModuleType><WriteActionModuleType ID="Microsoft.SystemCenter.Advisor.WriteAction.StoreCredentialWriteAction" Accessibility="Public" RunAs="System!System.PrivilegedMonitoringAccount" Batching="false"><Configuration><xsd:element xmlns:xsd="http://www.w3.org/2001/XMLSchema" name="ActionAccountName" type="xsd:string" /><xsd:element xmlns:xsd="http://www.w3.org/2001/XMLSchema" name="UserName" type="xsd:string" /><xsd:element xmlns:xsd="http://www.w3.org/2001/XMLSchema" name="Domain" type="xsd:string" /><xsd:element xmlns:xsd="http://www.w3.org/2001/XMLSchema" name="Password" type="xsd:string" /></Configuration><ModuleImplementation
Isolation="Any"><Managed><Assembly>Res.Microsoft.SystemCenter.Advisor.Internal</Assembly><Type>Microsoft.SystemCenter.Advisor.Internal.WriteAction.StoreCredentialWriteAction</Type></Managed></ModuleImplementation><InputType>System!System.BaseData</InputType></WriteActionModuleType></ModuleTypes><MonitorTypes><UnitMonitorType ID="Microsoft.SystemCenter.Advisor.ComputerOptInCompatibleMonitorType" Accessibility="Internal"><MonitorTypeStates><MonitorTypeState ID="Compatible" NoDetection="false" /><MonitorTypeState ID="Incompatible" NoDetection="false" /></MonitorTypeStates><Configuration><xsd:element xmlns:xsd="http://www.w3.org/2001/XMLSchema" name="EnableConnector" type="xsd:boolean" /><xsd:element xmlns:xsd="http://www.w3.org/2001/XMLSchema" name="ManagementGroupId" type="xsd:string" /></Configuration><OverrideableParameters><OverrideableParameter ID="EnableConnector" Selector="$Config/EnableConnector$" ParameterType="bool"
/></OverrideableParameters><MonitorImplementation><MemberModules><DataSource ID="CompatibleDS" TypeID="Microsoft.SystemCenter.Advisor.Monitoring.ComputerOptInCompatibleDataSource"><EnableConnector>$Config/EnableConnector$</EnableConnector><ManagementGroupId>$Config/ManagementGroupId$</ManagementGroupId></DataSource><ConditionDetection ID="IncompatibleDetection" TypeID="System!System.ExpressionFilter"><Expression><SimpleExpression><ValueExpression><XPathQuery Type="String">Property[@Name='State']</XPathQuery></ValueExpression><Operator>Equal</Operator><ValueExpression><Value Type="String">Failure</Value></ValueExpression></SimpleExpression></Expression></ConditionDetection><ConditionDetection ID="CompatibleDetection" TypeID="System!System.ExpressionFilter"><Expression><SimpleExpression><ValueExpression><XPathQuery Type="String">Property[@Name='State']</XPathQuery></ValueExpression><Operator>Equal</Operator><ValueExpression><Value
Type="String">Success</Value></ValueExpression></SimpleExpression></Expression></ConditionDetection></MemberModules><RegularDetections><RegularDetection MonitorTypeStateID="Compatible"><Node ID="CompatibleDetection"><Node ID="CompatibleDS" /></Node></RegularDetection><RegularDetection MonitorTypeStateID="Incompatible"><Node ID="IncompatibleDetection"><Node ID="CompatibleDS" /></Node></RegularDetection></RegularDetections></MonitorImplementation></UnitMonitorType></MonitorTypes></TypeDefinitions><Monitoring><Discoveries><Discovery ID="Microsoft.SystemCenter.Advisor.Internal.AdvisorConnectorDiscovery" Enabled="true" Target="Windows!Microsoft.Windows.Computer" ConfirmDelivery="false" Remotable="true" Priority="Normal"><Category>Discovery</Category><DiscoveryTypes><DiscoveryClass TypeID="Microsoft.SystemCenter.Advisor.Internal.AdvisorConnector"><Property TypeID="Microsoft.SystemCenter.Advisor.Internal.AdvisorConnector" PropertyID="AgentID" /><Property
TypeID="Microsoft.SystemCenter.Advisor.Internal.AdvisorConnector" PropertyID="PrincipalName" /><Property TypeID="Microsoft.SystemCenter.Advisor.Internal.AdvisorConnector" PropertyID="Version" /><Property TypeID="System!System.Entity" PropertyID="DisplayName" /></DiscoveryClass></DiscoveryTypes><DataSource ID="DS" RunAs="System!System.PrivilegedMonitoringAccount" TypeID="Windows!Microsoft.Windows.FilteredRegistryDiscoveryProvider"><ComputerName>$Target/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName><RegistryAttributeDefinitions><RegistryAttributeDefinition><AttributeName>AdvisorConnectorActivated</AttributeName><Path>SYSTEM\CurrentControlSet\services\HealthService\Parameters\Management Groups\AdvisorMonitorV2\Connector CLSID</Path><PathType>1</PathType><AttributeType>0</AttributeType></RegistryAttributeDefinition><RegistryAttributeDefinition><AttributeName>Version</AttributeName><Path>SOFTWARE\Microsoft\System Center Operations
Manager\12\Advisor\Version</Path><PathType>1</PathType><AttributeType>1</AttributeType></RegistryAttributeDefinition><RegistryAttributeDefinition><AttributeName>RegisterToManagementGroup</AttributeName><Path>SOFTWARE\Microsoft\System Center Operations
Manager\12\Advisor\RegisterToManagementGroup</Path><PathType>1</PathType><AttributeType>1</AttributeType></RegistryAttributeDefinition></RegistryAttributeDefinitions><Frequency>600</Frequency><ClassId>$MPElement[Name="Microsoft.SystemCenter.Advisor.Internal.AdvisorConnector"]$</ClassId><InstanceSettings><Settings><Setting><Name>$MPElement[Name="Microsoft.SystemCenter.Advisor.Internal.AdvisorConnector"]/AgentID$</Name><Value>$Target/Id$</Value></Setting><Setting><Name>$MPElement[Name="Windows!Microsoft.Windows.Computer"]/PrincipalName$</Name><Value>$Target/Property[Type="Windows!Microsoft.Windows.Computer"]/PrincipalName$</Value></Setting><Setting><Name>$MPElement[Name="Microsoft.SystemCenter.Advisor.Internal.AdvisorConnector"]/PrincipalName$</Name><Value>$Target/Property[Type="Windows!Microsoft.Windows.Computer"]/PrincipalName$</Value></Setting><Setting><Name>$MPElement[Name="Microsoft.SystemCenter.Advisor.Internal.AdvisorConnector"]/Version$</Name><Value>$Data/Values/Version$</Value><
/Setting><Setting><Name>$MPElement[Name="System!System.Entity"]/DisplayName$</Name><Value>$Target/Property[Type="System!System.Entity"]/DisplayName$</Value></Setting></Settings></InstanceSettings><Expression><And><Expression><SimpleExpression><ValueExpression><XPathQuery Type="String">Values/AdvisorConnectorActivated</XPathQuery></ValueExpression><Operator>Equal</Operator><ValueExpression><Value Type="String">True</Value></ValueExpression></SimpleExpression></Expression><Expression><SimpleExpression><ValueExpression><XPathQuery Type="String">Values/RegisterToManagementGroup</XPathQuery></ValueExpression><Operator>Equal</Operator><ValueExpression><Value Type="String">$Target/ManagementGroup/Id$</Value></ValueExpression></SimpleExpression></Expression></And></Expression></DataSource></Discovery><Discovery ID="Microsoft.SystemCenter.Advisor.Internal.Lync" Enabled="true" Target="Microsoft.SystemCenter.Advisor.Internal.AdvisorConnector" ConfirmDelivery="false" Remotable="true"
Priority="Normal"><Category>Discovery</Category><DiscoveryTypes><DiscoveryClass TypeID="Microsoft.SystemCenter.Advisor.Internal.Advisor_Lync" /></DiscoveryTypes><DataSource ID="DS" TypeID="Windows!Microsoft.Windows.FilteredRegistryDiscoveryProvider"><ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName><RegistryAttributeDefinitions><RegistryAttributeDefinition><AttributeName>Lync</AttributeName><Path>SOFTWARE\Microsoft\System Center Operations
Manager\12\Advisor\Workloads\Lync</Path><PathType>1</PathType><AttributeType>2</AttributeType></RegistryAttributeDefinition></RegistryAttributeDefinitions><Frequency>600</Frequency><ClassId>$MPElement[Name="Microsoft.SystemCenter.Advisor.Internal.Advisor_Lync"]$</ClassId><InstanceSettings><Settings><Setting><Name>$MPElement[Name="Microsoft.SystemCenter.Advisor.Internal.Advisor_Lync"]/LyncDiscovered$</Name><Value>1</Value></Setting><Setting><Name>$MPElement[Name="Microsoft.SystemCenter.Advisor.Internal.AdvisorConnector"]/AgentID$</Name><Value>$Target/Property[Type="Microsoft.SystemCenter.Advisor.Internal.AdvisorConnector"]/AgentID$</Value></Setting><Setting><Name>$MPElement[Name="Windows!Microsoft.Windows.Computer"]/PrincipalName$</Name><Value>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/PrincipalName$</Value></Setting><Setting><Name>$MPElement[Name="System!System.Entity"]/DisplayName$</Name><Value>$Target/Property[Type="System!System.Entity"]/DisplayName$</Value></S
etting></Settings></InstanceSettings><Expression><SimpleExpression><ValueExpression><XPathQuery Type="String">Values/Lync</XPathQuery></ValueExpression><Operator>Equal</Operator><ValueExpression><Value Type="String">1</Value></ValueExpression></SimpleExpression></Expression></DataSource></Discovery><Discovery ID="Microsoft.SystemCenter.Advisor.Internal.Sharepoint" Enabled="true" Target="Microsoft.SystemCenter.Advisor.Internal.AdvisorConnector" ConfirmDelivery="false" Remotable="true" Priority="Normal"><Category>Discovery</Category><DiscoveryTypes><DiscoveryClass TypeID="Microsoft.SystemCenter.Advisor.Internal.Advisor_Sharepoint" /></DiscoveryTypes><DataSource ID="DS" TypeID="Windows!Microsoft.Windows.FilteredRegistryDiscoveryProvider"><ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName><RegistryAttributeDefinitions><RegistryAttributeDefinition><AttributeName>Sharepoint</AttributeName><Path>SOFTWARE\Microsoft\System Center
Operations
Manager\12\Advisor\Workloads\Sharepoint</Path><PathType>1</PathType><AttributeType>2</AttributeType></RegistryAttributeDefinition></RegistryAttributeDefinitions><Frequency>600</Frequency><ClassId>$MPElement[Name="Microsoft.SystemCenter.Advisor.Internal.Advisor_Sharepoint"]$</ClassId><InstanceSettings><Settings><Setting><Name>$MPElement[Name="Microsoft.SystemCenter.Advisor.Internal.Advisor_Sharepoint"]/SharepointDiscovered$</Name><Value>1</Value></Setting><Setting><Name>$MPElement[Name="Microsoft.SystemCenter.Advisor.Internal.AdvisorConnector"]/AgentID$</Name><Value>$Target/Property[Type="Microsoft.SystemCenter.Advisor.Internal.AdvisorConnector"]/AgentID$</Value></Setting><Setting><Name>$MPElement[Name="Windows!Microsoft.Windows.Computer"]/PrincipalName$</Name><Value>$Target/Property[Type="Microsoft.SystemCenter.Advisor.Internal.AdvisorConnector"]/PrincipalName$</Value></Setting><Setting><Name>$MPElement[Name="System!System.Entity"]/DisplayName$</Name><Value>$Target/Property[Type="Syste
m!System.Entity"]/DisplayName$</Value></Setting></Settings></InstanceSettings><Expression><SimpleExpression><ValueExpression><XPathQuery Type="String">Values/Sharepoint</XPathQuery></ValueExpression><Operator>Equal</Operator><ValueExpression><Value Type="String">1</Value></ValueExpression></SimpleExpression></Expression></DataSource></Discovery></Discoveries><Rules><Rule ID="Microsoft.SystemCenter.Advisor.Monitoring.AgentCabUploadRule" Enabled="true" Target="Microsoft.SystemCenter.Advisor.Internal.AdvisorConnector" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100"><Category>Custom</Category><DataSources><DataSource ID="ACDS" TypeID="Microsoft.SystemCenter.Advisor.Monitoring.AgentCabDataSource"><Frequency>300</Frequency><AgentId>$Target/Property[Type='Microsoft.SystemCenter.Advisor.Internal.AdvisorConnector']/AgentID$</AgentId></DataSource></DataSources><WriteActions><WriteAction ID="FUWA" RunAs="System!System.PrivilegedMonitoringAccount"
TypeID="System!System.FileUploadWriteAction"><DestinationManagedTypeId>$MPElement[Name='SC!Microsoft.SystemCenter.CollectionManagementServer']$</DestinationManagedTypeId><UploadChannelId>$MPElement$</UploadChannelId><SourceFilePath>$Data/Property[@Name='FilePath']$</SourceFilePath></WriteAction></WriteActions></Rule><Rule ID="Microsoft.SystemCenter.Advisor.Monitoring.ServerOptInOutRule" Enabled="true" Target="SC!Microsoft.SystemCenter.HealthService" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100"><Category>Custom</Category><DataSources><DataSource ID="SOIODS" TypeID="Microsoft.SystemCenter.Advisor.Monitoring.ServerOptInOutDataSource"><EnableConnector>false</EnableConnector><ManagementGroupId>$Target/ManagementGroup/Id$</ManagementGroupId></DataSource></DataSources><WriteActions><WriteAction ID="RHSA" TypeID="Microsoft.SystemCenter.Advisor.Monitoring.RestartHealthServiceAction"><EventId>11000</EventId><EventType>Warning</EventType><RestartReason>Register
System Center Advisor connector to the Health Service</RestartReason><RestartAttempts>3</RestartAttempts><Timeout>60</Timeout></WriteAction></WriteActions></Rule><Rule ID="SharePointRunasAccountDiscovery" Enabled="true" Target="Microsoft.SystemCenter.Advisor.Internal.Advisor_Sharepoint" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100"><Category>Custom</Category><DataSources><DataSource ID="Scheduler" TypeID="System!System.Scheduler"><Scheduler><SimpleReccuringSchedule><Interval Unit="Seconds">7200</Interval></SimpleReccuringSchedule><ExcludeDates /></Scheduler></DataSource></DataSources><WriteActions><WriteAction ID="StoreCredentialWriteAction"
TypeID="Microsoft.SystemCenter.Advisor.WriteAction.StoreCredentialWriteAction"><ActionAccountName>Microsoft.SharePoint.Foundation.2010.AdminAccount</ActionAccountName><UserName>$RunAs[Name="Microsoft.SharePoint.Foundation.2010.AdminAccount"]/UserName$</UserName><Domain>$RunAs[Name="Microsoft.SharePoint.Foundation.2010.AdminAccount"]/Domain$</Domain><Password>$RunAs[Name="Microsoft.SharePoint.Foundation.2010.AdminAccount"]/Password$</Password></WriteAction></WriteActions></Rule><Rule ID="LyncRunasAccountDiscovery" Enabled="true" Target="Microsoft.SystemCenter.Advisor.Internal.Advisor_Lync" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100"><Category>Custom</Category><DataSources><DataSource ID="Scheduler" TypeID="System!System.Scheduler"><Scheduler><SimpleReccuringSchedule><Interval Unit="Seconds">7205</Interval></SimpleReccuringSchedule><ExcludeDates /></Scheduler></DataSource></DataSources><WriteActions><WriteAction ID="StoreCredentialWriteAction"
TypeID="Microsoft.SystemCenter.Advisor.WriteAction.StoreCredentialWriteAction"><ActionAccountName>Microsoft.KnowledgeServices.ElevatedAccount</ActionAccountName><UserName>$RunAs[Name="Microsoft.KnowledgeServices.ElevatedAccount"]/UserName$</UserName><Domain>$RunAs[Name="Microsoft.KnowledgeServices.ElevatedAccount"]/Domain$</Domain><Password>$RunAs[Name="Microsoft.KnowledgeServices.ElevatedAccount"]/Password$</Password></WriteAction></WriteActions></Rule></Rules><Monitors><UnitMonitor ID="Microsoft.SystemCenter.Advisor.AgentHealth.CabUploadMonitor" Accessibility="Public" Enabled="true" Target="Microsoft.SystemCenter.Advisor.Internal.AdvisorConnector" ParentMonitorID="Health!System.Health.AvailabilityState" Remotable="true" Priority="Normal" TypeID="Windows!Microsoft.Windows.2SingleEventLog2StateMonitorType" ConfirmDelivery="true"><Category>AvailabilityHealth</Category><AlertSettings
AlertMessage="Microsoft.SystemCenter.Advisor.AgentHealth.CabUploadMonitor.AlertMessage"><AlertOnState>Error</AlertOnState><AutoResolve>true</AutoResolve><AlertPriority>Normal</AlertPriority><AlertSeverity>Error</AlertSeverity><AlertParameters><AlertParameter1>$Data[Default='']/Context/EventDescription$</AlertParameter1></AlertParameters></AlertSettings><OperationalStates><OperationalState ID="FirstEventRaised" MonitorTypeStateID="FirstEventRaised" HealthState="Error" /><OperationalState ID="SecondEventRaised" MonitorTypeStateID="SecondEventRaised" HealthState="Success" /></OperationalStates><Configuration><FirstComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</FirstComputerName><FirstLogName>Operations Manager</FirstLogName><FirstExpression><And><Expression><SimpleExpression><ValueExpression><XPathQuery Type="UnsignedInteger">EventDisplayNumber</XPathQuery></ValueExpression><Operator>Equal</Operator><ValueExpression><Value
Type="UnsignedInteger">54003</Value></ValueExpression></SimpleExpression></Expression><Expression><SimpleExpression><ValueExpression><XPathQuery Type="String">PublisherName</XPathQuery></ValueExpression><Operator>Equal</Operator><ValueExpression><Value Type="String">Advisor</Value></ValueExpression></SimpleExpression></Expression></And></FirstExpression><SecondComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</SecondComputerName><SecondLogName>Operations Manager</SecondLogName><SecondExpression><And><Expression><SimpleExpression><ValueExpression><XPathQuery Type="UnsignedInteger">EventDisplayNumber</XPathQuery></ValueExpression><Operator>Equal</Operator><ValueExpression><Value Type="UnsignedInteger">54002</Value></ValueExpression></SimpleExpression></Expression><Expression><SimpleExpression><ValueExpression><XPathQuery Type="String">PublisherName</XPathQuery></ValueExpression><Operator>Equal</Operator><ValueExpression><Value
Type="String">Advisor</Value></ValueExpression></SimpleExpression></Expression></And></SecondExpression></Configuration></UnitMonitor><UnitMonitor ID="Microsoft.SystemCenter.Advisor.AgentHealth.MPUpdateMonitor" Accessibility="Public" Enabled="true" Target="Microsoft.SystemCenter.Advisor.Internal.AdvisorConnector" ParentMonitorID="Health!System.Health.AvailabilityState" Remotable="true" Priority="Normal" TypeID="Windows!Microsoft.Windows.2SingleEventLog2StateMonitorType" ConfirmDelivery="true"><Category>Custom</Category><AlertSettings AlertMessage="Microsoft.SystemCenter.Advisor.AgentHealth.MPUpdateMonitor.AlertMessage"><AlertOnState>Error</AlertOnState><AutoResolve>true</AutoResolve><AlertPriority>Normal</AlertPriority><AlertSeverity>Error</AlertSeverity><AlertParameters><AlertParameter1>$Data[Default='']/Context/EventDescription$</AlertParameter1></AlertParameters></AlertSettings><OperationalStates><OperationalState ID="FirstEventRaised" MonitorTypeStateID="FirstEventRaised"
HealthState="Error" /><OperationalState ID="SecondEventRaised" MonitorTypeStateID="SecondEventRaised" HealthState="Success" /></OperationalStates><Configuration><FirstComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</FirstComputerName><FirstLogName>Operations Manager</FirstLogName><FirstExpression><And><Expression><Or><Expression><SimpleExpression><ValueExpression><XPathQuery Type="UnsignedInteger">EventDisplayNumber</XPathQuery></ValueExpression><Operator>Equal</Operator><ValueExpression><Value Type="UnsignedInteger">54011</Value></ValueExpression></SimpleExpression></Expression><Expression><SimpleExpression><ValueExpression><XPathQuery Type="UnsignedInteger">EventDisplayNumber</XPathQuery></ValueExpression><Operator>Equal</Operator><ValueExpression><Value Type="UnsignedInteger">54012</Value></ValueExpression></SimpleExpression></Expression></Or></Expression><Expression><SimpleExpression><ValueExpression><XPathQuery
Type="String">PublisherName</XPathQuery></ValueExpression><Operator>Equal</Operator><ValueExpression><Value Type="String">Advisor</Value></ValueExpression></SimpleExpression></Expression></And></FirstExpression><SecondComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</SecondComputerName><SecondLogName>Operations Manager</SecondLogName><SecondExpression><And><Expression><Or><Expression><SimpleExpression><ValueExpression><XPathQuery Type="UnsignedInteger">EventDisplayNumber</XPathQuery></ValueExpression><Operator>Equal</Operator><ValueExpression><Value Type="UnsignedInteger">54009</Value></ValueExpression></SimpleExpression></Expression><Expression><SimpleExpression><ValueExpression><XPathQuery Type="UnsignedInteger">EventDisplayNumber</XPathQuery></ValueExpression><Operator>Equal</Operator><ValueExpression><Value
Type="UnsignedInteger">54010</Value></ValueExpression></SimpleExpression></Expression></Or></Expression><Expression><SimpleExpression><ValueExpression><XPathQuery Type="String">PublisherName</XPathQuery></ValueExpression><Operator>Equal</Operator><ValueExpression><Value Type="String">Advisor</Value></ValueExpression></SimpleExpression></Expression></And></SecondExpression></Configuration></UnitMonitor><UnitMonitor ID="Microsoft.SystemCenter.Advisor.AgentHealth.ComputerOptInCompatibleMonitor" Accessibility="Public" Enabled="false" Target="SC!Microsoft.SystemCenter.HealthService" ParentMonitorID="Health!System.Health.AvailabilityState" Remotable="true" Priority="Normal" TypeID="Microsoft.SystemCenter.Advisor.ComputerOptInCompatibleMonitorType" ConfirmDelivery="true"><Category>AvailabilityHealth</Category><AlertSettings
AlertMessage="Microsoft.SystemCenter.Advisor.AgentHealth.ComputerOptInCompatibleMonitor.AlertMessage"><AlertOnState>Error</AlertOnState><AutoResolve>true</AutoResolve><AlertPriority>Normal</AlertPriority><AlertSeverity>Error</AlertSeverity><AlertParameters><AlertParameter1>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/PrincipalName$</AlertParameter1></AlertParameters></AlertSettings><OperationalStates><OperationalState ID="Compatible" MonitorTypeStateID="Compatible" HealthState="Success" /><OperationalState ID="Incompatible" MonitorTypeStateID="Incompatible" HealthState="Error" /></OperationalStates><Configuration><EnableConnector>false</EnableConnector><ManagementGroupId>$Target/ManagementGroup/Id$</ManagementGroupId></Configuration></UnitMonitor><UnitMonitor ID="Microsoft.SystemCenter.Advisor.AgentHealth.ComputerOptInMonitor" Accessibility="Public" Enabled="true" Target="SC!Microsoft.SystemCenter.HealthService"
ParentMonitorID="Health!System.Health.AvailabilityState" Remotable="true" Priority="Normal" TypeID="Windows!Microsoft.Windows.2SingleEventLog2StateMonitorType" ConfirmDelivery="true"><Category>AvailabilityHealth</Category><AlertSettings AlertMessage="Microsoft.SystemCenter.Advisor.AgentHealth.ComputerOptInMonitor.AlertMessage"><AlertOnState>Error</AlertOnState><AutoResolve>true</AutoResolve><AlertPriority>Normal</AlertPriority><AlertSeverity>Error</AlertSeverity><AlertParameters><AlertParameter1>$Data[Default='']/Context/EventDescription$</AlertParameter1></AlertParameters></AlertSettings><OperationalStates><OperationalState ID="FirstEventRaised" MonitorTypeStateID="FirstEventRaised" HealthState="Error" /><OperationalState ID="SecondEventRaised" MonitorTypeStateID="SecondEventRaised" HealthState="Success" /></OperationalStates><Configuration><FirstComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</FirstComputerName><FirstLogName>Operations
Manager</FirstLogName><FirstExpression><And><Expression><RegExExpression><ValueExpression><XPathQuery Type="UnsignedInteger">EventDisplayNumber</XPathQuery></ValueExpression><Operator>MatchesRegularExpression</Operator><Pattern>^(54014|54015|54016|54017|54018|54019|54020|54021)$</Pattern></RegExExpression></Expression><Expression><SimpleExpression><ValueExpression><XPathQuery Type="String">PublisherName</XPathQuery></ValueExpression><Operator>Equal</Operator><ValueExpression><Value Type="String">Advisor</Value></ValueExpression></SimpleExpression></Expression></And></FirstExpression><SecondComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</SecondComputerName><SecondLogName>Operations Manager</SecondLogName><SecondExpression><And><Expression><RegExExpression><ValueExpression><XPathQuery
Type="UnsignedInteger">EventDisplayNumber</XPathQuery></ValueExpression><Operator>MatchesRegularExpression</Operator><Pattern>^(50001|54031)$</Pattern></RegExExpression></Expression><Expression><SimpleExpression><ValueExpression><XPathQuery Type="String">PublisherName</XPathQuery></ValueExpression><Operator>Equal</Operator><ValueExpression><Value Type="String">Advisor</Value></ValueExpression></SimpleExpression></Expression></And></SecondExpression></Configuration></UnitMonitor><UnitMonitor ID="Microsoft.SystemCenter.Advisor.AgentHealth.KnowledgeDiscoveryMonitor" Accessibility="Public" Enabled="true" Target="Microsoft.SystemCenter.Advisor.Internal.AdvisorConnector" ParentMonitorID="Health!System.Health.AvailabilityState" Remotable="true" Priority="Normal" RunAs="System!System.PrivilegedMonitoringAccount" TypeID="Windows!Microsoft.Windows.TimedScript.ThreeStateMonitorType" ConfirmDelivery="false"><Category>AvailabilityHealth</Category><AlertSettings
AlertMessage="Microsoft.SystemCenter.Advisor.AgentHealth.KnowledgeDiscoveryMonitor.AlertMessage"><AlertOnState>Error</AlertOnState><AutoResolve>true</AutoResolve><AlertPriority>Normal</AlertPriority><AlertSeverity>Error</AlertSeverity></AlertSettings><OperationalStates><OperationalState ID="Warning" MonitorTypeStateID="Warning" HealthState="Warning" /><OperationalState ID="Success" MonitorTypeStateID="Success" HealthState="Success" /><OperationalState ID="Error" MonitorTypeStateID="Error" HealthState="Error" /></OperationalStates><Configuration><IntervalSeconds>60</IntervalSeconds><SyncTime /><ScriptName>MonitorKnowledgeDiscovery.vbs</ScriptName><Arguments /><ScriptBody>
function readFromRegistry(strRegistryKey, strDefault)
    Dim WSHShell, value
    On Error Resume Next
    Set WSHShell = CreateObject("WScript.Shell")
    value = WSHShell.RegRead(strRegistryKey)
    if err.number &lt;&gt; 0 then
        readFromRegistry=strDefault
    else
        readFromRegistry=value
    end if
    set WSHShell = nothing
end function
Dim oAPI, oBag, strStatePath, strMonitorState
Set oAPI = CreateObject("MOM.ScriptAPI")
Set oBag = oAPI.CreatePropertyBag()
strStatePath = readFromRegistry("HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\System Center Operations Manager\12\Advisor\DataRoot", Empty)
strMonitorState = "Warning"
if strStatePath &lt;&gt; Empty then
    Dim oFSO, strModelPath, strKnowledgePath, oKnowledgeFolder
    Set oFSO = CreateObject("Scripting.FileSystemObject")
    strModelPath = strStatePath &amp; "\AdvisorMonitorV2\Configuration\model.xml"
    strKnowledgePath = strStatePath &amp; "\AdvisorMonitorV2\Management Packs\Knowledge12"
    if oFSO.FileExists(strModelPath) then
        strMonitorState = "Success"
    elseif oFSO.FolderExists(strKnowledgePath) then
        Set oKnowledgeFolder = oFSO.GetFolder(strKnowledgePath)
        if oKnowledgeFolder.Files.Count &lt;&gt; 0 then
            strMonitorState = "Error"
        end if
    end if
else
	strMonitorState = "Success"
end if
Call oBag.AddValue("Status", strMonitorState)
Call oAPI.Return(oBag)
          </ScriptBody><TimeoutSeconds>60</TimeoutSeconds><ErrorExpression><SimpleExpression><ValueExpression><XPathQuery Type="String">Property[@Name='Status']</XPathQuery></ValueExpression><Operator>Equal</Operator><ValueExpression><Value Type="String">Error</Value></ValueExpression></SimpleExpression></ErrorExpression><WarningExpression><SimpleExpression><ValueExpression><XPathQuery Type="String">Property[@Name='Status']</XPathQuery></ValueExpression><Operator>Equal</Operator><ValueExpression><Value Type="String">Warning</Value></ValueExpression></SimpleExpression></WarningExpression><SuccessExpression><SimpleExpression><ValueExpression><XPathQuery Type="String">Property[@Name='Status']</XPathQuery></ValueExpression><Operator>Equal</Operator><ValueExpression><Value Type="String">Success</Value></ValueExpression></SimpleExpression></SuccessExpression></Configuration></UnitMonitor><UnitMonitor ID="Microsoft.SystemCenter.Advisor.AgentHealth.RunAsDistributionMonitor"
Accessibility="Public" Enabled="true" Target="Microsoft.SystemCenter.Advisor.Internal.AdvisorConnector" ParentMonitorID="Health!System.Health.ConfigurationState" Remotable="true" Priority="Normal" TypeID="Windows!Microsoft.Windows.SingleEventLogTimer2StateMonitorType" ConfirmDelivery="true"><Category>ConfigurationHealth</Category><AlertSettings AlertMessage="Microsoft.SystemCenter.Advisor.AgentHealth.RunAsDistributionMonitor.AlertMesage"><AlertOnState>Warning</AlertOnState><AutoResolve>true</AutoResolve><AlertPriority>Normal</AlertPriority><AlertSeverity>Warning</AlertSeverity></AlertSettings><OperationalStates><OperationalState ID="EventRaised" MonitorTypeStateID="EventRaised" HealthState="Warning" /><OperationalState ID="TimeEventRaised" MonitorTypeStateID="TimerEventRaised" HealthState="Success" /></OperationalStates><Configuration><ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName><LogName>Operations
Manager</LogName><Expression><And><Expression><SimpleExpression><ValueExpression><XPathQuery Type="UnsignedInteger">EventDisplayNumber</XPathQuery></ValueExpression><Operator>Equal</Operator><ValueExpression><Value Type="UnsignedInteger">54013</Value></ValueExpression></SimpleExpression></Expression><Expression><SimpleExpression><ValueExpression><XPathQuery Type="String">PublisherName</XPathQuery></ValueExpression><Operator>Equal</Operator><ValueExpression><Value Type="String">Advisor</Value></ValueExpression></SimpleExpression></Expression></And></Expression><TimerWaitInSeconds>7260</TimerWaitInSeconds></Configuration></UnitMonitor><UnitMonitor ID="Microsoft.SystemCenter.Advisor.AgentHealth.RunAsValidationMonitor" Accessibility="Public" Enabled="true" Target="Microsoft.SystemCenter.Advisor.Internal.AdvisorConnector" ParentMonitorID="Health!System.Health.ConfigurationState" Remotable="true" Priority="Normal" TypeID="Windows!Microsoft.Windows.3SingleEventLog3StateUnitMonitorType"
ConfirmDelivery="true"><Category>ConfigurationHealth</Category><AlertSettings AlertMessage="Microsoft.SystemCenter.Advisor.AgentHealth.RunAsValidationMonitor.AlertMessage"><AlertOnState>Error</AlertOnState><AutoResolve>true</AutoResolve><AlertPriority>Normal</AlertPriority><AlertSeverity>Error</AlertSeverity><AlertParameters><AlertParameter1>$Data[Default='']/Context/EventDescription$</AlertParameter1></AlertParameters></AlertSettings><OperationalStates><OperationalState ID="FirstEventRaised" MonitorTypeStateID="FirstEventRaised" HealthState="Error" /><OperationalState ID="SecondEventRaised" MonitorTypeStateID="SecondEventRaised" HealthState="Success" /><OperationalState ID="ThirdEventRaised" MonitorTypeStateID="ThirdEventRaised" HealthState="Warning" /></OperationalStates><Configuration><FirstComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</FirstComputerName><FirstLogName>Operations
Manager</FirstLogName><FirstExpression><And><Expression><RegExExpression><ValueExpression><XPathQuery Type="UnsignedInteger">EventDisplayNumber</XPathQuery></ValueExpression><Operator>MatchesRegularExpression</Operator><Pattern>^(52002|52003|52004|52005|52006|52007|52008|52010)$</Pattern></RegExExpression></Expression><Expression><SimpleExpression><ValueExpression><XPathQuery Type="String">PublisherName</XPathQuery></ValueExpression><Operator>Equal</Operator><ValueExpression><Value Type="String">Advisor</Value></ValueExpression></SimpleExpression></Expression></And></FirstExpression><SecondComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</SecondComputerName><SecondLogName>Operations Manager</SecondLogName><SecondExpression><And><Expression><SimpleExpression><ValueExpression><XPathQuery Type="UnsignedInteger">EventDisplayNumber</XPathQuery></ValueExpression><Operator>Equal</Operator><ValueExpression><Value
Type="UnsignedInteger">52011</Value></ValueExpression></SimpleExpression></Expression><Expression><SimpleExpression><ValueExpression><XPathQuery Type="String">PublisherName</XPathQuery></ValueExpression><Operator>Equal</Operator><ValueExpression><Value Type="String">Advisor</Value></ValueExpression></SimpleExpression></Expression></And></SecondExpression><ThirdComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ThirdComputerName><ThirdLogName>Operations Manager</ThirdLogName><ThirdExpression><And><Expression><RegExExpression><ValueExpression><XPathQuery Type="UnsignedInteger">EventDisplayNumber</XPathQuery></ValueExpression><Operator>MatchesRegularExpression</Operator><Pattern>^(52001|52009)$</Pattern></RegExExpression></Expression><Expression><SimpleExpression><ValueExpression><XPathQuery Type="String">PublisherName</XPathQuery></ValueExpression><Operator>Equal</Operator><ValueExpression><Value
Type="String">Advisor</Value></ValueExpression></SimpleExpression></Expression></And></ThirdExpression></Configuration></UnitMonitor></Monitors><Overrides><RuleConfigurationOverride ID="Microsoft.SystemCenter.Advisor.Monitoring.ServerOptInOutOverride" Context="Microsoft.SystemCenter.Advisor.Library.ServerOptInOutGroup" Enforced="false" Rule="Microsoft.SystemCenter.Advisor.Monitoring.ServerOptInOutRule" Parameter="EnableConnector" Module="SOIODS"><Value>true</Value></RuleConfigurationOverride><RulePropertyOverride ID="OverrideForRuleMicrosoftSystemCenterAdvisorMonitoringServerOptInOutRuleForContextMicrosoftSystemCenterAgentNano" Context="SC!Microsoft.SystemCenter.Agent.Nano" Enforced="false" Rule="Microsoft.SystemCenter.Advisor.Monitoring.ServerOptInOutRule" Property="Enabled"><Value>false</Value></RulePropertyOverride><MonitorConfigurationOverride ID="Microsoft.SystemCenter.Advisor.Monitoring.ComputerOptInCompatibleConfigOverride"
Context="Microsoft.SystemCenter.Advisor.Library.ServerOptInOutGroup" Enforced="false" Monitor="Microsoft.SystemCenter.Advisor.AgentHealth.ComputerOptInCompatibleMonitor" Parameter="EnableConnector"><Value>true</Value></MonitorConfigurationOverride><DiscoveryPropertyOverride ID="OverrideForAdvisorConnectorDiscoveryForMicrosoftWindowsClusterVirtualServer" Context="Cluster!Microsoft.Windows.Cluster.VirtualServer" Enforced="false" Discovery="Microsoft.SystemCenter.Advisor.Internal.AdvisorConnectorDiscovery" Property="Enabled"><Value>false</Value></DiscoveryPropertyOverride></Overrides></Monitoring><Presentation><StringResources><StringResource ID="Microsoft.SystemCenter.Advisor.AgentHealth.CabUploadMonitor.AlertMessage" /><StringResource ID="Microsoft.SystemCenter.Advisor.AgentHealth.MPUpdateMonitor.AlertMessage" /><StringResource ID="Microsoft.SystemCenter.Advisor.AgentHealth.ComputerOptInCompatibleMonitor.AlertMessage" /><StringResource
ID="Microsoft.SystemCenter.Advisor.AgentHealth.ComputerOptInMonitor.AlertMessage" /><StringResource ID="Microsoft.SystemCenter.Advisor.AgentHealth.KnowledgeDiscoveryMonitor.AlertMessage" /><StringResource ID="Microsoft.SystemCenter.Advisor.AgentHealth.RunAsDistributionMonitor.AlertMesage" /><StringResource ID="Microsoft.SystemCenter.Advisor.AgentHealth.RunAsValidationMonitor.AlertMessage" /></StringResources></Presentation><LanguagePacks><LanguagePack ID="ENU" IsDefault="true"><DisplayStrings><DisplayString ElementID="Microsoft.SystemCenter.Advisor.Internal.AdvisorConnector"><Name>AdvisorConnector Class</Name><Description /></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.Advisor.Internal.AdvisorConnector" SubElementID="AgentID"><Name>Agent ID</Name><Description>A unique ID which identifies Advisor Connector</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.Advisor.Internal.AdvisorConnector" SubElementID="PrincipalName"><Name>Principal
Name</Name><Description>The principal name of the targeted machine that has Advisor Connector installed and activated</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.Advisor.Internal.AdvisorConnector" SubElementID="Version"><Name>Version</Name><Description>The version number of the Advisor Connector</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.Advisor.Internal.AdvisorConnectorDiscovery"><Name>Advisor Connector Discovery</Name><Description>This discovery rule detects if Advisor Connector is installed and activated on the target machine</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.Advisor.Internal.Advisor_Lync"><Name>Advisor_Lync</Name><Description>This instance indicates that Lync related components have been installed on the monitored machine.</Description></DisplayString><DisplayString
ElementID="Microsoft.SystemCenter.Advisor.Internal.Advisor_Sharepoint"><Name>Advisor_Sharepoint</Name><Description>This instance indicates that Sharepoint related components have been installed on the monitored machine.</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.Advisor.Internal.Lync"><Name>Microsoft.SystemCenter.Advisor.Internal.Lync</Name><Description>This rule detects if Advisor Connector has discovered Lync components installed on the monitored machine.</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.Advisor.Internal.Sharepoint"><Name>Microsoft.SystemCenter.Advisor.Internal.Sharepoint</Name><Description>This rule detects if Advisor Connector has discovered Sharpoint components installed on the monitored machine.</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.Advisor.Internal.Advisor_Lync" SubElementID="LyncDiscovered"><Name>Lync discovered</Name><Description>Indicates whether Lync
components are discovered on the monitored machine.</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.Advisor.Internal.Advisor_Sharepoint" SubElementID="SharepointDiscovered"><Name>Sharepoint discovered</Name><Description>Indicates whether Sharepoint components are discovered on the monitored machine.</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.Advisor.AgentHealth.CabUploadMonitor"><Name>Agent Cab Upload</Name></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.Advisor.AgentHealth.CabUploadMonitor" SubElementID="FirstEventRaised"><Name>Error Event Raised</Name></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.Advisor.AgentHealth.CabUploadMonitor" SubElementID="SecondEventRaised"><Name>Success Event Raised</Name></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.Advisor.AgentHealth.CabUploadMonitor.AlertMessage"><Name>Advisor connector failed to send analysis data to management
server</Name><Description>Event Description: {0}</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.Advisor.AgentHealth.MPUpdateMonitor"><Name>Agent MP Update</Name></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.Advisor.AgentHealth.MPUpdateMonitor" SubElementID="FirstEventRaised"><Name>Error Event Raised</Name></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.Advisor.AgentHealth.MPUpdateMonitor" SubElementID="SecondEventRaised"><Name>Success Event Raised</Name></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.Advisor.AgentHealth.MPUpdateMonitor.AlertMessage"><Name>Advisor connector failed to update to the latest knowledge management packs</Name><Description>Event Description: {0}</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.Advisor.AgentHealth.ComputerOptInCompatibleMonitor"><Name>Advisor Connector Compatibility Status Monitor</Name></DisplayString><DisplayString
ElementID="Microsoft.SystemCenter.Advisor.AgentHealth.ComputerOptInCompatibleMonitor" SubElementID="Compatible"><Name>Compatible</Name></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.Advisor.AgentHealth.ComputerOptInCompatibleMonitor" SubElementID="Incompatible"><Name>Incompatible</Name></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.Advisor.AgentHealth.ComputerOptInCompatibleMonitor.AlertMessage"><Name>Unable to find the Advisor Connector on the computer</Name><Description>{0} does not include Advisor Connector functionality</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.Advisor.AgentHealth.ComputerOptInMonitor"><Name>Advisor Connector Enable Status Monitor</Name></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.Advisor.AgentHealth.ComputerOptInMonitor" SubElementID="FirstEventRaised"><Name>Error Event Raised</Name></DisplayString><DisplayString
ElementID="Microsoft.SystemCenter.Advisor.AgentHealth.ComputerOptInMonitor" SubElementID="SecondEventRaised"><Name>Success Event Raised</Name></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.Advisor.AgentHealth.ComputerOptInMonitor.AlertMessage"><Name>Failed to enable Advisor Connector on the computer.</Name><Description>Event Description: {0}</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.Advisor.AgentHealth.KnowledgeDiscoveryMonitor"><Name>Advisor Knowledge Discovery</Name></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.Advisor.AgentHealth.KnowledgeDiscoveryMonitor" SubElementID="Warning"><Name>Warning State Detected</Name></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.Advisor.AgentHealth.KnowledgeDiscoveryMonitor" SubElementID="Success"><Name>Success State Detected</Name></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.Advisor.AgentHealth.KnowledgeDiscoveryMonitor"
SubElementID="Error"><Name>Error State Detected</Name></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.Advisor.AgentHealth.KnowledgeDiscoveryMonitor.AlertMessage"><Name>Advisor knowledge discovery failed on the server</Name><Description>Advisor management packs are incorrect.</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.Advisor.AgentHealth.RunAsDistributionMonitor"><Name>Run As Distribution</Name></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.Advisor.AgentHealth.RunAsDistributionMonitor" SubElementID="EventRaised"><Name>Error Event Raised</Name></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.Advisor.AgentHealth.RunAsDistributionMonitor" SubElementID="TimeEventRaised"><Name>State Reset Timer</Name></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.Advisor.AgentHealth.RunAsDistributionMonitor.AlertMesage"><Name>Run As accounts are not correctly distributed</Name><Description>Please see the
alert context for details.</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.Advisor.AgentHealth.RunAsValidationMonitor"><Name>Run As Validation</Name></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.Advisor.AgentHealth.RunAsValidationMonitor" SubElementID="FirstEventRaised"><Name>Error Event Raised</Name></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.Advisor.AgentHealth.RunAsValidationMonitor" SubElementID="SecondEventRaised"><Name>Success Event Raised</Name></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.Advisor.AgentHealth.RunAsValidationMonitor" SubElementID="ThirdEventRaised"><Name>Warning Event Raised</Name></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.Advisor.AgentHealth.RunAsValidationMonitor.AlertMessage"><Name>Advisor Run As accounts have invalid data</Name><Description>Event Description: {0}</Description></DisplayString><DisplayString
ElementID="Microsoft.SystemCenter.Advisor.Library.ServerOptInOutGroup"><Name>Microsoft System Center Advisor Monitoring Server Group</Name><Description /></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.Advisor.Monitoring.ServerOptInOutDataSource"><Name>Microsoft System Center Advisor Monitoring Server Opt-In/Out DataSource</Name><Description /></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.Advisor.Monitoring.ServerOptInOutRule"><Name>Microsoft System Center Advisor Monitoring Server Opt-In/Out Rule</Name><Description /></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.Advisor.Internal"><Name>Microsoft System Center Advisor Internal</Name><Description>Microsoft System Center Advisor: This Management Pack contains the basic content definition for Advisor.</Description></DisplayString><DisplayString ElementID="Microsoft.SharePoint.Foundation.2010.AdminAccount"><Name>System Center Advisor SharePoint Run As Account</Name><Description>This
Runas account is used by System Center Advisor for SharePoint 2010 discovery and monitoring.</Description></DisplayString><DisplayString ElementID="Microsoft.KnowledgeServices.ElevatedAccount"><Name>System Center Advisor Lync Run As Account</Name><Description>This Runas account is used by System Center Advisor for Lync 2010 discovery and monitoring.</Description></DisplayString></DisplayStrings><KnowledgeArticles><KnowledgeArticle ElementID="Microsoft.SystemCenter.Advisor.AgentHealth.CabUploadMonitor" Visible="true"><MamlContent><maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10"><maml:title>Summary</maml:title><maml:para>Latest analysis data has not been sent to the Management Server. When analysis data is not sent to the Management Server, no new alerts will be received.</maml:para></maml:section><maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10"><maml:title>Causes</maml:title><maml:para>CAB upload failed from Agent to Management
Server.</maml:para></maml:section><maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10"><maml:title>Resolutions</maml:title><maml:para>Grant the action account System.PriviledgedMonitoringAccount full permissions to the Outbox folder (by default under &lt;Ops manager installation path&gt;\&lt;component&gt;Health Service State\Advisor\AdvisorMonitorV2\Mailbox\Outbox) and the Sending folder (by default under the Outbox folder)</maml:para></maml:section></MamlContent></KnowledgeArticle><KnowledgeArticle ElementID="Microsoft.SystemCenter.Advisor.AgentHealth.MPUpdateMonitor" Visible="true"><MamlContent><maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10"><maml:title>Summary</maml:title><maml:para>The latest Management Packs for the Advisor connector have not been loaded into the agent.</maml:para></maml:section><maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10"><maml:title>Causes</maml:title><maml:para>An error in the agent has prevented the
automatic management pack update. The Management Packs installed are out of date.</maml:para></maml:section><maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10"><maml:title>Resolutions</maml:title><maml:para>Refer to event log and advisor connector log under %Program Files%\System Center Operations Manager\Agent\Health Service State\Advisor\Logs for detail.</maml:para></maml:section></MamlContent></KnowledgeArticle><KnowledgeArticle ElementID="Microsoft.SystemCenter.Advisor.AgentHealth.ComputerOptInCompatibleMonitor" Visible="true"><MamlContent><maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10"><maml:title>Summary</maml:title><maml:para>Unable to find the Advisor Connector on the computer.</maml:para></maml:section><maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10"><maml:title>Causes</maml:title><maml:para>
                The selected computer does not include Advisor Connector functionality.
              </maml:para></maml:section><maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10"><maml:title>Resolutions</maml:title><maml:para>Please upgrade the computer to the latest version or shipped Update Rollup of Operations Manager</maml:para></maml:section></MamlContent></KnowledgeArticle><KnowledgeArticle ElementID="Microsoft.SystemCenter.Advisor.AgentHealth.ComputerOptInMonitor" Visible="true"><MamlContent><maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10"><maml:title>Summary</maml:title><maml:para>Failed to enable Advisor Connector on the computer.</maml:para></maml:section><maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10"><maml:title>Causes</maml:title><maml:para>
                Common causes for the above error code(s) include:
                1: Advisor Agent is already installed in selected computer.
                2: .NET Framework 3.5 SP1 is not installed on Windows Server 2008 or Windows Server 2008 R2.
                3: .NET Framework 4.0 is not installed on Windows Server 2012 or higher.
                4: Advisor was already enabled for another Management Group using this Microsoft account.
                5: The OS version for the selected computer does not support Advisor Attached Service. Advisor requires Windows Server 2008 or higher.
              </maml:para></maml:section><maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10"><maml:title>Resolutions</maml:title><maml:para>Fix the issue according to the detailed information in the alert, and restart the HealthService</maml:para></maml:section></MamlContent></KnowledgeArticle><KnowledgeArticle ElementID="Microsoft.SystemCenter.Advisor.AgentHealth.KnowledgeDiscoveryMonitor" Visible="true"><MamlContent><maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10"><maml:title>Summary</maml:title><maml:para>Advisor knowledge discovery failed to run on the specific agent.</maml:para></maml:section><maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10"><maml:title>Causes</maml:title><maml:para>The management packs are corrupted or incorrect.</maml:para></maml:section><maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10"><maml:title>Resolutions</maml:title><maml:para>If it is the first time that the agent has been opted
in, this is normal and please wait for a few minutes. Otherwise, delete the Health Service State folder under %Program Files%\System Center Operations Manager\ on the specific agent and restart the health service to force download the latest management packs.</maml:para></maml:section></MamlContent></KnowledgeArticle><KnowledgeArticle ElementID="Microsoft.SystemCenter.Advisor.AgentHealth.RunAsDistributionMonitor" Visible="true"><MamlContent><maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10"><maml:title>Summary</maml:title><maml:para>Run as accounts have not been correctly created or associated to a Run As Profile. When run as accounts are not setup correctly, Advisor may not be able to analyze certain workloads.</maml:para></maml:section><maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10"><maml:title>Causes</maml:title><maml:para>A Run As Account has not been created or associated to a Run As Profile.</maml:para></maml:section><maml:section
xmlns:maml="http://schemas.microsoft.com/maml/2004/10"><maml:title>Resolutions</maml:title><maml:para>Ensure Run As account has been created and associated to a Run As Profile.</maml:para></maml:section></MamlContent></KnowledgeArticle><KnowledgeArticle ElementID="Microsoft.SystemCenter.Advisor.AgentHealth.RunAsValidationMonitor" Visible="true"><MamlContent><maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10"><maml:title>Summary</maml:title><maml:para>Data for Run As account is not valid. When run as accounts data is not valid, Advisor may not be able to analyze certain workloads.</maml:para></maml:section><maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10"><maml:title>Causes</maml:title><maml:para>The password &amp; user combination failed Active Directory validation.</maml:para></maml:section><maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10"><maml:title>Resolutions</maml:title><maml:para>Verify that the information used for the run
as account is valid.</maml:para></maml:section></MamlContent></KnowledgeArticle><KnowledgeArticle ElementID="Microsoft.SystemCenter.Advisor.Internal" Visible="true"><MamlContent><maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10"><maml:title>Summary</maml:title><maml:para>Microsoft System Center Advisor: This Management Pack contains the basic content definition for Advisor.</maml:para></maml:section></MamlContent></KnowledgeArticle></KnowledgeArticles></LanguagePack></LanguagePacks><Resources><DeployableAssembly ID="Res.ClientShared" Accessibility="Public" FileName="ClientShared.dll" HasNullStream="false" QualifiedName="ClientShared, Version=7.0.5000.20, Culture=neutral, PublicKeyToken=31bf3856ad364e35" /><DeployableAssembly ID="Res.Microsoft.SystemCenter.Advisor.Internal" Accessibility="Public" FileName="Microsoft.SystemCenter.Advisor.Internal.dll" HasNullStream="false" QualifiedName="Microsoft.SystemCenter.Advisor.Internal, Version=7.0.5000.20, Culture=neutral,
PublicKeyToken=31bf3856ad364e35"><Dependency ID="Res.ClientShared" /></DeployableAssembly></Resources></ManagementPack>
