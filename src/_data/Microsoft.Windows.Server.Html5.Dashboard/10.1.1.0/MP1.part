<ManagementPack xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" ContentReadable="true" SchemaVersion="2.0" OriginalSchemaVersion="1.0"><Manifest><Identity><ID>Microsoft.Windows.Server.Html5.Dashboard</ID><Version>10.1.1.0</Version></Identity><Name>BaseOSDashboard</Name><References><Reference Alias="SCInternal"><ID>Microsoft.SystemCenter.Internal</ID><Version>7.0.8441.6</Version><PublicKeyToken>31bf3856ad364e35</PublicKeyToken></Reference><Reference Alias="SC"><ID>Microsoft.SystemCenter.Library</ID><Version>6.0.6278.0</Version><PublicKeyToken>31bf3856ad364e35</PublicKeyToken></Reference><Reference Alias="System"><ID>System.Library</ID><Version>6.0.6278.0</Version><PublicKeyToken>31bf3856ad364e35</PublicKeyToken></Reference><Reference Alias="WindowsServer"><ID>Microsoft.Windows.Server.Library</ID><Version>10.1.1.0</Version><PublicKeyToken>31bf3856ad364e35</PublicKeyToken></Reference></References></Manifest><Presentation><Views><View
ID="Microsoft.Windows.Server.Html5.Dashboard.View" Accessibility="Public" Enabled="true" Target="System!System.Entity" TypeID="SCInternal!Microsoft.SystemCenter.HTMLDashboardViewType" Visible="true"><Category>Operations</Category><DashboardConfiguration><Configuration /><Type
/><Widgets><Widget>Microsoft.Windows.Server.Html5.Dashboard.ActiveAlerts.View</Widget><Widget>Microsoft.Windows.Server.Html5.Dashboard.OperatingSystemPerformance.View</Widget><Widget>Microsoft.Windows.Server.Html5.Dashboard.AllWindowsComputerGroup.View</Widget><Widget>Microsoft.Windows.Server.Html5.Dashboard.AgentProcessorUtilization.View</Widget><Widget>Microsoft.Windows.Server.Html5.Dashboard.AgentMemoryUtilization.View</Widget><Widget>Microsoft.Windows.Server.Html5.Dashboard.DiskQueueLength.View</Widget><Widget>Microsoft.Windows.Server.Html5.Dashboard.NetworkPercentBandwidthUsed.View</Widget><Widget>Microsoft.Windows.Server.Html5.Dashboard.NetworkTotalBytesSec.View</Widget><Widget>Microsoft.Windows.Server.Html5.Dashboard.OperatingSystemHealth.View</Widget><Widget>Microsoft.Windows.Server.Html5.Dashboard.DiskAverageSecTransfer.View</Widget><Widget>Microsoft.Windows.Server.Html5.Dashboard.DiskFreeSpace.View</Widget><Widget>Microsoft.Windows.Server.Html5.Dashboard.AvailabeMBinMemory.Vi
ew</Widget><Widget>Microsoft.Windows.Server.Html5.Dashboard.NetworkAdaptorGroup.View</Widget><Widget>Microsoft.Windows.Server.Html5.Dashboard.ClusterSharedVolumePerformance.View</Widget><Widget>Microsoft.Windows.Server.Html5.Dashboard.ProcessorUtilization.View</Widget><Widget>Microsoft.Windows.Server.Html5.Dashboard.Windows.Computer.Heath.State.View</Widget></Widgets></DashboardConfiguration></View><View ID="Microsoft.Windows.Server.Html5.Dashboard.ActiveAlerts.View" Accessibility="Public" Enabled="true" Target="System!System.Entity" TypeID="SCInternal!Microsoft.SystemCenter.HTMLWidgetType"
Visible="true"><Category>Operations</Category><WidgetConfiguration><Configuration>{"widgetDisplay":{"col":7,"row":14,"sizex":6,"sizey":4,"columns":["severity","monitoringobjectdisplayname","name","age","repeatcount","lastmodified"],"groupByColumn":"severity","payload":"d02b4c0f-01e0-d458-b058-805195fcf210","dragHandle":".draggable","resizeHandle":".resizable"},"widgetParameters":{"scope":{"scopeSelection":[{"id":"1d62280e-f437-1369-316b-1e8659500e9a","displayName":"Windows Server Computer Group","className":"Windows Server Computer Group","path":null,"fullName":"Microsoft.Windows.Server.ComputerGroup","objectType":-1}]},"criteria":{"severities":["1","2"],"priorities":["2","1"],"resolutionStates":["0","247","248","249","250"],"age":7,"ageTimeUnit":"days"}},"widgetRefreshInterval":5}</Configuration><Type>HtmlAlertWidget</Type></WidgetConfiguration></View><View ID="Microsoft.Windows.Server.Html5.Dashboard.OperatingSystemPerformance.View" Accessibility="Public" Enabled="true"
Target="System!System.Entity" TypeID="SCInternal!Microsoft.SystemCenter.HTMLWidgetType" Visible="true"><Category>Operations</Category><WidgetConfiguration><Configuration>{"widgetDisplay":{"col":1,"row":1,"payload":"f940ac24-ff3b-98cd-e634-de3ddb408d56","dragHandle":".draggable","resizeHandle":".resizable","sizex":11,"sizey":5},"widgetParameters":{"script":"#////////////////////////////////////////////////////////////////////////////////////////////\n$class = get-scomclass -Name Microsoft.Windows.Server.OperatingSystem \n$serverOSes = Get-SCOMClassInstance -class $class\n$avg_stat = @{} \n$dat1Objects = @()\n$unitReplacements = @{ \n\"Physical Memory (MB)\" = @{ \"name\" = \"Total RAM (GB)\"; \"coeff\" = 1048576 }; \n}\n#///////// Functions Section ///////////////////// START\nfunction RecalculateMinMaxForAvgStatItem \n{ \nparam($name, $value)\n$avg_stat[$name][\"min\"] = ($avg_stat[$name][\"min\"], $value | Measure -Min).Minimum \n$avg_stat[$name][\"max\"] =
($avg_stat[$name][\"max\"], $value | Measure -Max).Maximum \n}\n\n# Function to convert results to “PerformanceDataStatistics” type to return the collection to the VMM column generator component of the State Widget: \nfunction CreateStatistics { \nparam($value)\n$stat = $ScriptContext.CreateInstance(\"xsd://Microsoft.SystemCenter.Visualization.Library!Microsoft.SystemCenter.Visualization.DataProvider/PerformanceDataStatistics\") \nif ($value -ne $null) { \n  $stat[\"AverageValue\"] = [double]$value \n  $stat[\"Value\"] = [double]$value \n} \n      $stat \n}\n\n# Initialize Stat Item: \nfunction InitAvgStatItem { \nparam($name)\nif ($avg_stat[$name] -eq $null) { \n  $avg_stat[$name] = @{} \n  $avg_stat[$name][\"min\"] = 0 \n  $avg_stat[$name][\"max\"] = [Int32]::MinValue \n} \n} \n\nfunction AddColumnValue { \nparam($dat1Object, $name, $value)\n$v = $value\n# Transform units value \nif($unitReplacements[$name] -ne $null) { \n  $r = $unitReplacements[$name] \n  if ($v -ne $null)   { \n 
 $v = $v = $v / $r[\"coeff\"] \n  } \n  $name = $r[\"name\"]  \n  }\nInitAvgStatItem $name \nif ($v -ne $null) {   \n  $dat1Object[$name] = CreateStatistics($v) \n  RecalculateMinMaxForAvgStatItem $name $v \n} \nelse \n{ \n  $dat1Object[$name] = $null \n} \n}\n#///////// Functions Section ///////////////////// END\n#///////// Main Section ///////////////////// START\nforeach ($serverOS in $serverOSes) { \n$dat1Object = $ScriptContext.CreateFromObject($serverOS, \"Id=Id,State=HealthState,Path=Path\", $null)\n$dat1Object[\"Name\"]=$serverOS.Path \nif ($dat1Object -ne $null)  {    \n\n#Last 16 hours \n$aggregationInterval = 16 \n     $dt = New-TimeSpan -hour $aggregationInterval \n  $now = Get-Date  \n  $from = $now.Subtract($dt)\n     $perfRules = $serverOS.GetMonitoringPerformanceData() \n     foreach ($perfRule in $perfRules)     {   \n#Get % Processor Time Stat \n          if($perfRule.CounterName -eq \"% Processor Time\")   { \n      $dat1 = $perfRule.GetValues($from, $now) | % {
$_.SampleValue } | Measure-Object -Average  \n       AddColumnValue $dat1Object $perfRule.CounterName $dat1.Average \n          } \n#Get Processor Queue Length Stat \n          if($perfRule.CounterName -eq \"Processor Queue Length\")  { \n      $dat1 = $perfRule.GetValues($from, $now) | % { $_.SampleValue } | Measure-Object -Average   \nAddColumnValue $dat1Object $perfRule.CounterName $dat1.Average      \n          } \n#Get % Memory Used Stat \n         if($perfRule.CounterName -eq \"PercentMemoryUsed\")  { \n       $dat1 = $perfRule.GetValues($from, $now) | % { $_.SampleValue } | Measure-Object -Average  \nAddColumnValue $dat1Object $perfRule.CounterName $dat1.Average       \n          }   \n        \n     }  \n  $dat1Objects += $dat1Object     \n    } \n} \nforeach ($dat1Object in $dat1Objects) \n{ \nforeach ($metric in $avg_stat.Keys) \n{ \n  $stat = $avg_stat[$metric] \n  $dat1Object[$metric][\"MinimumValue\"] = [double]$stat[\"min\"]\n  if ($stat[\"max\"] -ne [Int32]::MinValue)
\n  { \n   $dat1Object[$metric][\"MaximumValue\"] = [double]$stat[\"max\"] \n  } \n  else \n  { \n   $dat1Object[$metric][\"MaximumValue\"] = [double]0 \n  } \n} \n$ScriptContext.ReturnCollection.Add($dat1Object) \n}\n#///////// Main Section ///////////////////// END \n     \n   \n#//////////////////////////////////////////////////////////////////////////////////////////// \n\n"},"widgetRefreshInterval":5}</Configuration><Type>HtmlPowershellWidget</Type></WidgetConfiguration></View><View ID="Microsoft.Windows.Server.Html5.Dashboard.AllWindowsComputerGroup.View" Accessibility="Public" Enabled="true" Target="System!System.Entity" TypeID="SCInternal!Microsoft.SystemCenter.HTMLWidgetType"
Visible="true"><Category>Operations</Category><WidgetConfiguration><Configuration>{"widgetDisplay":{"col":13,"row":3,"sizex":2,"sizey":2,"resizable":false,"payload":"c59bce42-f194-02f6-56f3-bc2f1dbc3074","dragHandle":".draggable","resizeHandle":".resizable"},"widgetParameters":{"scope":{"scopeSelection":[{"id":"1d62280e-f437-1369-316b-1e8659500e9a","displayName":"Windows Server Computer Group","className":"Windows Server Computer Group","path":null,"fullName":"Microsoft.Windows.Server.ComputerGroup","objectType":-1}]}},"widgetRefreshInterval":5}</Configuration><Type>HtmlTileWidget</Type></WidgetConfiguration></View><View ID="Microsoft.Windows.Server.Html5.Dashboard.AgentProcessorUtilization.View" Accessibility="Public" Enabled="true" Target="System!System.Entity" TypeID="SCInternal!Microsoft.SystemCenter.HTMLWidgetType"
Visible="true"><Category>Operations</Category><WidgetConfiguration><Configuration>{"widgetDisplay":{"col":1,"row":6,"sizex":6,"sizey":4,"selectedLegends":["Target","Path","LastValue"],"visualizeObjectsByPerformance":false,"payload":"8abf6a07-6e7c-c1d9-1ab3-8a8cd221e648","dragHandle":".draggable","resizeHandle":".resizable"},"widgetParameters":{"scope":{"scopeSelection":[{"id":"1d62280e-f437-1369-316b-1e8659500e9a","displayName":"Windows Server Computer Group","className":"Windows Server Computer Group","path":null,"fullName":"Microsoft.Windows.Server.ComputerGroup","objectType":-1}]},"criteria":{"timeRange":{"timeValue":24,"timeUnit":"Hours"},"performanceCounters":[{"objectname":"Health Service","countername":"agent processor utilization","instancename":""}]}},"widgetRefreshInterval":5}</Configuration><Type>HtmlPerformanceWidget</Type></WidgetConfiguration></View><View ID="Microsoft.Windows.Server.Html5.Dashboard.AgentMemoryUtilization.View" Accessibility="Public" Enabled="true"
Target="System!System.Entity" TypeID="SCInternal!Microsoft.SystemCenter.HTMLWidgetType" Visible="true"><Category>Operations</Category><WidgetConfiguration><Configuration>{"widgetDisplay":{"col":7,"row":10,"sizex":6,"sizey":4,"selectedLegends":["Target","Path","LastValue"],"visualizeObjectsByPerformance":false,"payload":"894f8b3d-0322-ae86-de98-6a5fa9fcdd17","dragHandle":".draggable","resizeHandle":".resizable"},"widgetParameters":{"scope":{"scopeSelection":[{"id":"1d62280e-f437-1369-316b-1e8659500e9a","displayName":"Windows Server Computer Group","className":"Windows Server Computer Group","path":null,"fullName":"Microsoft.Windows.Server.ComputerGroup","objectType":-1}]},"criteria":{"timeRange":{"timeValue":24,"timeUnit":"Hours"},"performanceCounters":[{"objectname":"Memory","countername":"PercentMemoryUsed","instancename":""}]}},"widgetRefreshInterval":5}</Configuration><Type>HtmlPerformanceWidget</Type></WidgetConfiguration></View><View
ID="Microsoft.Windows.Server.Html5.Dashboard.DiskQueueLength.View" Accessibility="Public" Enabled="true" Target="System!System.Entity" TypeID="SCInternal!Microsoft.SystemCenter.HTMLWidgetType" Visible="true"><Category>Operations</Category><WidgetConfiguration><Configuration>{"widgetDisplay":{"col":1,"row":10,"sizex":6,"sizey":4,"selectedLegends":["Target","Path","LastValue"],"visualizeObjectsByPerformance":false,"payload":"c8055477-11a4-b097-bf3a-00a1f91167af","dragHandle":".draggable","resizeHandle":".resizable"},"widgetParameters":{"scope":{"scopeSelection":[{"id":"1d62280e-f437-1369-316b-1e8659500e9a","displayName":"Windows Server Computer Group","className":"Windows Server Computer Group","path":null,"fullName":"Microsoft.Windows.Server.ComputerGroup","objectType":0}]},"criteria":{"timeRange":{"timeValue":24,"timeUnit":"Hours"},"performanceCounters":[{"objectname":"LogicalDisk","countername":"Current Disk Queue
Length","instancename":"C:"}]}},"widgetRefreshInterval":5}</Configuration><Type>HtmlPerformanceWidget</Type></WidgetConfiguration></View><View ID="Microsoft.Windows.Server.Html5.Dashboard.NetworkPercentBandwidthUsed.View" Accessibility="Public" Enabled="true" Target="System!System.Entity" TypeID="SCInternal!Microsoft.SystemCenter.HTMLWidgetType" Visible="true"><Category>Operations</Category><WidgetConfiguration><Configuration>{"widgetDisplay":{"col":7,"row":18,"sizex":6,"sizey":4,"selectedLegends":["AverageValue","Path"],"visualizeObjectsByPerformance":true,"payload":"ff4a4a90-4f33-05ea-6466-12aff131fca5","dragHandle":".draggable","resizeHandle":".resizable"},"widgetParameters":{"scope":{"scopeSelection":[{"id":"1d62280e-f437-1369-316b-1e8659500e9a","displayName":"Windows Server Computer Group","className":"Windows Server Computer
Group","path":null,"fullName":"Microsoft.Windows.Server.ComputerGroup","objectType":-1}]},"criteria":{"timeRange":{"timeValue":24,"timeUnit":"Hours"},"performanceCounters":[{"objectname":"Network Adapter","countername":"PercentBandwidthUsedTotal","instancename":"Microsoft Hyper-V Network Adapter"}]}},"widgetRefreshInterval":5}</Configuration><Type>HtmlPerformanceWidget</Type></WidgetConfiguration></View><View ID="Microsoft.Windows.Server.Html5.Dashboard.NetworkTotalBytesSec.View" Accessibility="Public" Enabled="true" Target="System!System.Entity" TypeID="SCInternal!Microsoft.SystemCenter.HTMLWidgetType"
Visible="true"><Category>Operations</Category><WidgetConfiguration><Configuration>{"widgetDisplay":{"col":1,"row":22,"sizex":6,"sizey":4,"selectedLegends":["Path","AverageValue"],"visualizeObjectsByPerformance":true,"payload":"a652e528-163c-8224-c2f0-06ae215dd594","dragHandle":".draggable","resizeHandle":".resizable"},"widgetParameters":{"scope":{"scopeSelection":[{"id":"1d62280e-f437-1369-316b-1e8659500e9a","displayName":"Windows Server Computer Group","className":"Windows Server Computer Group","path":null,"fullName":"Microsoft.Windows.Server.ComputerGroup","objectType":-1}]},"criteria":{"timeRange":{"timeValue":24,"timeUnit":"Hours"},"performanceCounters":[{"objectname":"Network Adapter","countername":"Bytes Total/sec","instancename":"Microsoft Hyper-V Network Adapter"}]}},"widgetRefreshInterval":5}</Configuration><Type>HtmlPerformanceWidget</Type></WidgetConfiguration></View><View ID="Microsoft.Windows.Server.Html5.Dashboard.OperatingSystemHealth.View" Accessibility="Public"
Enabled="true" Target="System!System.Entity" TypeID="SCInternal!Microsoft.SystemCenter.HTMLWidgetType" Visible="true"><Category>Operations</Category><WidgetConfiguration><Configuration>{"widgetDisplay":{"col":1,"row":15,"sizex":6,"sizey":4,"columns":["healthstate","path"],"payload":"806a68c6-4815-a02e-737e-9a55277f9caa","dragHandle":".draggable","resizeHandle":".resizable"},"widgetParameters":{"scope":{"scopeSelection":[],"classSelection":[{"id":"Microsoft.Windows.Library!Microsoft.Windows.OperatingSystem","displayName":"Windows Operating System","className":null,"path":null,"fullName":null,"objectType":-2}]},"criteria":{"healthStates":["2","0","1","3"],"inMaintenanceMode":"All"}},"widgetRefreshInterval":5}</Configuration><Type>HtmlStateWidget</Type></WidgetConfiguration></View><View ID="Microsoft.Windows.Server.Html5.Dashboard.DiskAverageSecTransfer.View" Accessibility="Public" Enabled="true" Target="System!System.Entity" TypeID="SCInternal!Microsoft.SystemCenter.HTMLWidgetType"
Visible="true"><Category>Operations</Category><WidgetConfiguration><Configuration>{"widgetDisplay":{"col":7,"row":22,"sizex":6,"sizey":4,"selectedLegends":["Path","AverageValue"],"visualizeObjectsByPerformance":true,"payload":"0d811af8-98c6-8bf4-35ae-b3028515bb55","dragHandle":".draggable","resizeHandle":".resizable"},"widgetParameters":{"scope":{"scopeSelection":[{"id":"1d62280e-f437-1369-316b-1e8659500e9a","displayName":"Windows Server Computer Group","className":"Windows Server Computer Group","path":null,"fullName":"Microsoft.Windows.Server.ComputerGroup","objectType":-1}]},"criteria":{"timeRange":{"timeValue":24,"timeUnit":"Hours"},"performanceCounters":[{"objectname":"LogicalDisk","countername":"Avg. Disk sec/Transfer","instancename":"C:"}]}},"widgetRefreshInterval":5}</Configuration><Type>HtmlPerformanceWidget</Type></WidgetConfiguration></View><View ID="Microsoft.Windows.Server.Html5.Dashboard.DiskFreeSpace.View" Accessibility="Public" Enabled="true"
Target="System!System.Entity" TypeID="SCInternal!Microsoft.SystemCenter.HTMLWidgetType" Visible="true"><Category>Operations</Category><WidgetConfiguration><Configuration>{"widgetDisplay":{"col":1,"row":18,"sizex":6,"sizey":4,"selectedLegends":["Path","AverageValue"],"visualizeObjectsByPerformance":true,"payload":"89392157-fa83-d900-f611-da27b7b43dfe","dragHandle":".draggable","resizeHandle":".resizable"},"widgetParameters":{"scope":{"scopeSelection":[{"id":"1d62280e-f437-1369-316b-1e8659500e9a","displayName":"Windows Server Computer Group","className":"Windows Server Computer Group","path":null,"fullName":"Microsoft.Windows.Server.ComputerGroup","objectType":-1}]},"criteria":{"timeRange":{"timeValue":24,"timeUnit":"Hours"},"performanceCounters":[{"objectname":"LogicalDisk","countername":"% Free Space","instancename":"C:"}]}},"widgetRefreshInterval":5}</Configuration><Type>HtmlPerformanceWidget</Type></WidgetConfiguration></View><View
ID="Microsoft.Windows.Server.Html5.Dashboard.AvailabeMBinMemory.View" Accessibility="Public" Enabled="true" Target="System!System.Entity" TypeID="SCInternal!Microsoft.SystemCenter.HTMLWidgetType" Visible="true"><Category>Operations</Category><WidgetConfiguration><Configuration>{"widgetDisplay":{"col":7,"row":26,"sizex":6,"sizey":4,"selectedLegends":["Path","AverageValue"],"visualizeObjectsByPerformance":true,"payload":"a706b4ce-8a1b-c358-72ca-5d89b94bd3f2","dragHandle":".draggable","resizeHandle":".resizable"},"widgetParameters":{"scope":{"scopeSelection":[{"id":"1d62280e-f437-1369-316b-1e8659500e9a","displayName":"Windows Server Computer Group","className":"Windows Server Computer Group","path":null,"fullName":"Microsoft.Windows.Server.ComputerGroup","objectType":-1}]},"criteria":{"timeRange":{"timeValue":24,"timeUnit":"Hours"},"performanceCounters":[{"objectname":"Memory","countername":"Available
MBytes","instancename":""}]}},"widgetRefreshInterval":5}</Configuration><Type>HtmlPerformanceWidget</Type></WidgetConfiguration></View><View ID="Microsoft.Windows.Server.Html5.Dashboard.NetworkAdaptorGroup.View" Accessibility="Public" Enabled="true" Target="System!System.Entity" TypeID="SCInternal!Microsoft.SystemCenter.HTMLWidgetType" Visible="true"><Category>Operations</Category><WidgetConfiguration><Configuration>{"widgetDisplay":{"col":13,"row":1,"sizex":2,"sizey":2,"resizable":false,"payload":"fa4ac65d-24fb-64cf-9393-a4ce079ec75f","dragHandle":".draggable","resizeHandle":".resizable"},"widgetParameters":{"scope":{"scopeSelection":[{"id":"d5fbf768-2658-ccaa-ddbf-da8b6debc697","displayName":"Advanced Network Adapters Group","className":"Advanced Network Adapters Group","path":null,"fullName":"System.NetworkManagement.AdvancedNetworkAdapterGroup","objectType":-1}]}},"widgetRefreshInterval":5}</Configuration><Type>HtmlTileWidget</Type></WidgetConfiguration></View><View
ID="Microsoft.Windows.Server.Html5.Dashboard.ClusterSharedVolumePerformance.View" Accessibility="Public" Enabled="true" Target="System!System.Entity" TypeID="SCInternal!Microsoft.SystemCenter.HTMLWidgetType" Visible="true"><Category>Operations</Category><WidgetConfiguration><Configuration>{"widgetDisplay":{"col":7,"row":6,"sizex":6,"sizey":4,"selectedLegends":["Target","Path","LastValue"],"visualizeObjectsByPerformance":false,"payload":"f7b5b412-78df-5e97-e45c-38ee115682a6","dragHandle":".draggable","resizeHandle":".resizable"},"widgetParameters":{"scope":{"scopeSelection":[{"id":"1d62280e-f437-1369-316b-1e8659500e9a","displayName":"Windows Server Computer Group","className":"Windows Server Computer Group","path":null,"fullName":"Microsoft.Windows.Server.ComputerGroup","objectType":-1}]},"criteria":{"timeRange":{"timeValue":24,"timeUnit":"Hours"},"performanceCounters":[{"objectname":"Cluster Disk","countername":"Avg. Disk sec/Transfer","instancename":"Cluster Disk
1_D:"}]}},"widgetRefreshInterval":5}</Configuration><Type>HtmlPerformanceWidget</Type></WidgetConfiguration></View><View ID="Microsoft.Windows.Server.Html5.Dashboard.ProcessorUtilization.View" Accessibility="Public" Enabled="true" Target="System!System.Entity" TypeID="SCInternal!Microsoft.SystemCenter.HTMLWidgetType" Visible="true"><Category>Operations</Category><WidgetConfiguration><Configuration>{"widgetDisplay":{"col":1,"row":26,"sizex":6,"sizey":4,"selectedLegends":["AverageValue","Path"],"visualizeObjectsByPerformance":true,"payload":"d9054fd1-596f-688a-a05e-b84540e2c0f9","dragHandle":".draggable","resizeHandle":".resizable"},"widgetParameters":{"scope":{"scopeSelection":[{"id":"1d62280e-f437-1369-316b-1e8659500e9a","displayName":"Windows Server Computer Group","className":"Windows Server Computer
Group","path":null,"fullName":"Microsoft.Windows.Server.ComputerGroup","objectType":-1}]},"criteria":{"timeRange":{"timeValue":24,"timeUnit":"Hours"},"performanceCounters":[{"objectname":"Health Service","countername":"agent processor utilization","instancename":""}]}},"widgetRefreshInterval":5}</Configuration><Type>HtmlPerformanceWidget</Type></WidgetConfiguration></View><View ID="Microsoft.Windows.Server.Html5.Dashboard.Windows.Computer.Heath.State.View" Accessibility="Public" Enabled="true" Target="System!System.Entity" TypeID="SCInternal!Microsoft.SystemCenter.HTMLWidgetType" Visible="true"><Category>Operations</Category><WidgetConfiguration><Configuration>{"widgetDisplay":{"col":1,"row":4,"sizex":11,"sizey":3,"payload":"8e306eee-ad7b-ece3-b6b5-ba81a1796b67","dragHandle":".draggable","resizeHandle":".resizable"},"widgetParameters":{"script":"$class = get-scomclass -Name Microsoft.Windows.Computer\n$AllServers = Get-SCOMClassInstance -class $class\n\n#Function to Translate
HealthState String to Icon for Dashboard:\nfunction getHealthStateIcon {\nparam($HealthStateString)\n        $NewIcon = $ScriptContext.CreateInstance(\"xsd://Microsoft.SystemCenter.Visualization.Library!Microsoft.SystemCenter.Visualization.OperationalDataTypes/HealthStateType\")\n        If($HealthStateString-eq \"Success\")\n        {\n           #$NewIcon = \"☑\"\n             $NewIcon[\"Value\"] = 1\n        }\n        If($HealthStateStringe -eq \"Error\")\n        {\n           #$NewIcon = \"⛒\"\n             $NewIcon[\"Value\"] = 3\n        }\n        If($HealthStateString -eq \"Warning\")\n        {\n           #$NewIcon = \"⚠\"\n             $NewIcon[\"Value\"] = 2 \n        }\n        If($HealthStateString -eq \"Uninitialized\")\n        {\n           #$NewIcon = \"??\"\n             $NewIcon[\"Value\"] = 0\n        }    \n\n$NewIcon\n\n}\n\n\nForEach($singleServer in $AllServers)\n{\n   $NewdataObject = $ScriptContext.CreateFromObject($singleServer ,
\"Id=Id,ServerState=HealthState,Name=Name\", $null)\n   $NewdataObject[\"ServerName\"]=$singleServer.DisplayName\n\n   $serverMembers = $singleServer.GetRelatedMonitoringObjects()\n   ForEach($serverMember in $serverMembers)\n   {\n        $selectedClassName = $serverMember.GetMostDerivedMonitoringClasses() | select name\n\n        if($selectedClassName -like \"*OperatingSystem*\")\n        {$NewdataObject[\"OS\"]= getHealthStateIcon($serverMember.HealthState.tostring())}\n\n        if($selectedClassName -like \"*LogicalDisk*\" -and $serverMember.Name -eq \"C:\")\n        {$NewdataObject[\"LogicalDisk-C:\"] = getHealthStateIcon($serverMember.HealthState.tostring())}\n\n        if($selectedClassName -like \"*NetworkAdapter*\")\n        {$NewdataObject[\"Network Adapter\"]= getHealthStateIcon($serverMember.HealthState.tostring())}\n\n        if($selectedClassName -like \"*SystemCenter.Agent*\")\n        {$NewdataObject[\"Agent\"]=
getHealthStateIcon($serverMember.HealthState.tostring())}\n   }\n\n$ScriptContext.ReturnCollection.Add($NewdataObject)\n\n} \n"},"widgetRefreshInterval":5}</Configuration><Type>HtmlPowershellWidget</Type></WidgetConfiguration></View></Views><FolderItems><FolderItem ElementID="Microsoft.Windows.Server.Html5.Dashboard.View" ID="Microsoft.Windows.Server.Html5.Dashboard.View" Folder="WindowsServer!Microsoft.Windows.Server.ViewFolder.Root" /></FolderItems></Presentation><LanguagePacks><LanguagePack ID="ENU" IsDefault="true"><DisplayStrings><DisplayString ElementID="Microsoft.Windows.Server.Html5.Dashboard"><Name>Windows Server Html5 Dashboard</Name><Description>Microsoft Windows Server Html5 Dashboard MP</Description></DisplayString><DisplayString ElementID="Microsoft.Windows.Server.Html5.Dashboard.View"><Name>BASE OS DASHBOARD</Name><Description>Custom</Description></DisplayString><DisplayString ElementID="Microsoft.Windows.Server.Html5.Dashboard.ActiveAlerts.View"><Name>Active
Alerts</Name><Description>Base OS Active Alerts</Description></DisplayString><DisplayString ElementID="Microsoft.Windows.Server.Html5.Dashboard.OperatingSystemPerformance.View"><Name>Operating System Performance</Name></DisplayString><DisplayString ElementID="Microsoft.Windows.Server.Html5.Dashboard.AllWindowsComputerGroup.View"><Name>All Windows Computer Group</Name></DisplayString><DisplayString ElementID="Microsoft.Windows.Server.Html5.Dashboard.AgentProcessorUtilization.View"><Name>Agent Processor Utilization</Name></DisplayString><DisplayString ElementID="Microsoft.Windows.Server.Html5.Dashboard.AgentMemoryUtilization.View"><Name>Agent Memory Utilization</Name></DisplayString><DisplayString ElementID="Microsoft.Windows.Server.Html5.Dashboard.DiskQueueLength.View"><Name>Disk Queue Length</Name></DisplayString><DisplayString ElementID="Microsoft.Windows.Server.Html5.Dashboard.NetworkPercentBandwidthUsed.View"><Name>Network-Percent Bandwidth Used</Name></DisplayString><DisplayString
ElementID="Microsoft.Windows.Server.Html5.Dashboard.NetworkTotalBytesSec.View"><Name>Network Total Bytes/Sec</Name></DisplayString><DisplayString ElementID="Microsoft.Windows.Server.Html5.Dashboard.OperatingSystemHealth.View"><Name>Operating System Health</Name></DisplayString><DisplayString ElementID="Microsoft.Windows.Server.Html5.Dashboard.DiskAverageSecTransfer.View"><Name>Disk Average Sec\Transfer</Name></DisplayString><DisplayString ElementID="Microsoft.Windows.Server.Html5.Dashboard.DiskFreeSpace.View"><Name>Disk % Free Space</Name></DisplayString><DisplayString ElementID="Microsoft.Windows.Server.Html5.Dashboard.AvailabeMBinMemory.View"><Name>Availabe MB in memory</Name></DisplayString><DisplayString ElementID="Microsoft.Windows.Server.Html5.Dashboard.NetworkAdaptorGroup.View"><Name>Network Adaptor Group</Name></DisplayString><DisplayString ElementID="Microsoft.Windows.Server.Html5.Dashboard.ClusterSharedVolumePerformance.View"><Name>Cluster Shared Volume Utilization-Average
Disk</Name></DisplayString><DisplayString ElementID="Microsoft.Windows.Server.Html5.Dashboard.ProcessorUtilization.View"><Name>Processor Utilization</Name></DisplayString><DisplayString ElementID="Microsoft.Windows.Server.Html5.Dashboard.Windows.Computer.Heath.State.View"><Name>Windows Computer Heath State</Name></DisplayString></DisplayStrings></LanguagePack></LanguagePacks></ManagementPack>
