<ManagementPack xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" ContentReadable="true" SchemaVersion="2.0" OriginalSchemaVersion="2.0"><Manifest><Identity><ID>Microsoft.SystemCenter.Apm.NTServices</ID><Version>10.22.10118.0</Version></Identity><Name>Apm.NTService</Name><References><Reference Alias="Windows"><ID>Microsoft.Windows.Library</ID><Version>7.5.8500.0</Version><PublicKeyToken>31bf3856ad364e35</PublicKeyToken></Reference><Reference Alias="System"><ID>System.Library</ID><Version>7.5.8500.0</Version><PublicKeyToken>31bf3856ad364e35</PublicKeyToken></Reference><Reference Alias="Health"><ID>System.Health.Library</ID><Version>7.0.8447.6</Version><PublicKeyToken>31bf3856ad364e35</PublicKeyToken></Reference><Reference Alias="NTService"><ID>Microsoft.SystemCenter.NTService.Library</ID><Version>10.22.10118.0</Version><PublicKeyToken>31bf3856ad364e35</PublicKeyToken></Reference><Reference
Alias="AL"><ID>Microsoft.SystemCenter.Apm.Library</ID><Version>10.22.10118.0</Version><PublicKeyToken>31bf3856ad364e35</PublicKeyToken></Reference><Reference Alias="ApplicationMonitoring"><ID>Microsoft.SystemCenter.ApplicationMonitoring.Library</ID><Version>10.22.10118.0</Version><PublicKeyToken>31bf3856ad364e35</PublicKeyToken></Reference><Reference Alias="AI"><ID>Microsoft.SystemCenter.Apm.Infrastructure</ID><Version>10.22.10118.0</Version><PublicKeyToken>31bf3856ad364e35</PublicKeyToken></Reference></References></Manifest><TypeDefinitions><EntityTypes><ClassTypes><ClassType ID="Microsoft.SystemCenter.Apm.NTServiceComponent" Accessibility="Public" Abstract="false" Base="AL!Microsoft.SystemCenter.Apm.ApplicationComponent" Hosted="true" Singleton="false" Extension="false" /><ClassType ID="Microsoft.SystemCenter.Apm.NTServiceInstance" Accessibility="Public" Abstract="false" Base="AL!Microsoft.SystemCenter.Apm.ApplicationInstance" Hosted="true" Singleton="false"
Extension="false"><Property ID="ServiceName" Type="string" AutoIncrement="false" Key="true" CaseSensitive="false" MaxLength="256" MinLength="0" Required="false" Scale="0" /><Property ID="ServiceProcessName" Type="string" AutoIncrement="false" Key="false" CaseSensitive="false" MaxLength="8000" MinLength="0" Required="false" Scale="0" /></ClassType><ClassType ID="Microsoft.SystemCenter.Apm.NTServiceFunctionTransactionRole" Accessibility="Internal" Abstract="false" Base="AL!Microsoft.SystemCenter.Apm.FunctionTransactionRole" Hosted="true" Singleton="false" Extension="false" /><ClassType ID="Microsoft.SystemCenter.Apm.NTServiceFunctionTransaction" Accessibility="Public" Abstract="false" Base="AL!Microsoft.SystemCenter.Apm.FunctionTransaction" Hosted="true" Singleton="false" Extension="false" /><ClassType ID="Microsoft.SystemCenter.Apm.NTServiceEndpoint" Accessibility="Internal" Abstract="false" Base="Windows!Microsoft.Windows.LocalService" Hosted="true" Singleton="false"
Extension="false"><Property ID="DisplayName" Type="string" AutoIncrement="false" Key="false" CaseSensitive="false" MaxLength="256" MinLength="0" Required="false" Scale="0" /><Property ID="ServiceName" Type="string" AutoIncrement="false" Key="true" CaseSensitive="false" MaxLength="256" MinLength="0" Required="false" Scale="0" /><Property ID="ServiceProcessName" Type="string" AutoIncrement="false" Key="false" CaseSensitive="false" MaxLength="8000" MinLength="0" Required="false" Scale="0" /></ClassType><ClassType ID="Microsoft.SystemCenter.Apm.NTServiceWcfTransactionRole" Accessibility="Internal" Abstract="false" Base="AL!Microsoft.SystemCenter.Apm.WcfTransactionRole" Hosted="true" Singleton="false" Extension="false" /><ClassType ID="Microsoft.SystemCenter.Apm.NTServiceWcfTransaction" Accessibility="Public" Abstract="false" Base="AL!Microsoft.SystemCenter.Apm.WcfTransaction" Hosted="true" Singleton="false" Extension="false" /></ClassTypes><RelationshipTypes><RelationshipType
ID="Microsoft.SystemCenter.Apm.NTServiceComponentHostsApmNTServiceComponent" Accessibility="Public" Abstract="false" Base="System!System.Hosting"><Source ID="Source" MinCardinality="0" MaxCardinality="2147483647" Type="ApplicationMonitoring!Microsoft.SystemCenter.ApplicationMonitoring.Net.NTServiceComponent" /><Target ID="Target" MinCardinality="0" MaxCardinality="2147483647" Type="Microsoft.SystemCenter.Apm.NTServiceComponent" /></RelationshipType><RelationshipType ID="Microsoft.SystemCenter.Apm.NTServiceComponentContainsApmNTServiceInstance" Accessibility="Public" Abstract="false" Base="System!System.Containment"><Source ID="Source" MinCardinality="0" MaxCardinality="2147483647" Type="Microsoft.SystemCenter.Apm.NTServiceComponent" /><Target ID="Target" MinCardinality="0" MaxCardinality="2147483647" Type="Microsoft.SystemCenter.Apm.NTServiceInstance" /></RelationshipType><RelationshipType ID="Microsoft.SystemCenter.Apm.NTServiceComponentHostsNTServiceFunctionTransactionRole"
Accessibility="Internal" Abstract="false" Base="AL!Microsoft.SystemCenter.Apm.ApplicationComponentHostsTransactionRole"><Source ID="Source" MinCardinality="0" MaxCardinality="2147483647" Type="Microsoft.SystemCenter.Apm.NTServiceComponent" /><Target ID="Target" MinCardinality="0" MaxCardinality="2147483647" Type="Microsoft.SystemCenter.Apm.NTServiceFunctionTransactionRole" /></RelationshipType><RelationshipType ID="Microsoft.SystemCenter.Apm.NTServiceInstanceHostsNTServiceFunctionTransaction" Accessibility="Public" Abstract="false" Base="AL!Microsoft.SystemCenter.Apm.ApplicationInstanceHostsTransaction"><Source ID="Source" MinCardinality="0" MaxCardinality="2147483647" Type="Microsoft.SystemCenter.Apm.NTServiceInstance" /><Target ID="Target" MinCardinality="0" MaxCardinality="2147483647" Type="Microsoft.SystemCenter.Apm.NTServiceFunctionTransaction" /></RelationshipType><RelationshipType ID="Microsoft.SystemCenter.Apm.NTServiceComponentHostsNTServiceWcfTransactionRole"
Accessibility="Internal" Abstract="false" Base="AL!Microsoft.SystemCenter.Apm.ApplicationComponentHostsTransactionRole"><Source ID="Source" MinCardinality="0" MaxCardinality="2147483647" Type="Microsoft.SystemCenter.Apm.NTServiceComponent" /><Target ID="Target" MinCardinality="0" MaxCardinality="2147483647" Type="Microsoft.SystemCenter.Apm.NTServiceWcfTransactionRole" /></RelationshipType><RelationshipType ID="Microsoft.SystemCenter.Apm.NTServiceInstanceHostsNTServiceWcfTransaction" Accessibility="Public" Abstract="false" Base="AL!Microsoft.SystemCenter.Apm.ApplicationInstanceHostsTransaction"><Source ID="Source" MinCardinality="0" MaxCardinality="2147483647" Type="Microsoft.SystemCenter.Apm.NTServiceInstance" /><Target ID="Target" MinCardinality="0" MaxCardinality="2147483647" Type="Microsoft.SystemCenter.Apm.NTServiceWcfTransaction" /></RelationshipType></RelationshipTypes><TypeProjections><TypeProjection ID="Microsoft.SystemCenter.Apm.NTServices.Structure" Accessibility="Internal"
Type="ApplicationMonitoring!Microsoft.SystemCenter.ApplicationMonitoring.Net.ApplicationComponentGroup"><Component Path="$Target/Path[Relationship='ApplicationMonitoring!Microsoft.SystemCenter.ApplicationMonitoring.Net.ApplicationComponentGroupHostsNTServiceComponent' TypeConstraint='ApplicationMonitoring!Microsoft.SystemCenter.ApplicationMonitoring.Net.NTServiceComponent']$" Alias="NTServiceComponent"><Component Path="$Target/Path[Relationship='Microsoft.SystemCenter.Apm.NTServiceComponentHostsApmNTServiceComponent']$" Alias="Apm.NTServiceComponent"><Component Path="$Target/Path[Relationship='Microsoft.SystemCenter.Apm.NTServiceComponentHostsNTServiceFunctionTransactionRole']$" Alias="Apm.NTServiceFunctionTransactionRole" /><Component Path="$Target/Path[Relationship='Microsoft.SystemCenter.Apm.NTServiceComponentHostsNTServiceWcfTransactionRole']$" Alias="Apm.NTServiceWcfTransactionRole"
/></Component></Component></TypeProjection></TypeProjections></EntityTypes><ModuleTypes><DataSourceModuleType ID="Microsoft.SystemCenter.Apm.NTServiceEndpoint.Discovery.DataSource" Accessibility="Internal" Batching="false"><Configuration><xsd:element xmlns:xsd="http://www.w3.org/2001/XMLSchema" type="xsd:integer" name="IntervalSeconds" /></Configuration><OverrideableParameters><OverrideableParameter ID="IntervalSeconds" Selector="$Config/IntervalSeconds$" ParameterType="int" /></OverrideableParameters><ModuleImplementation Isolation="Any"><Composite><MemberModules><DataSource ID="Scheduler" TypeID="System!System.Discovery.Scheduler"><Scheduler><SimpleReccuringSchedule><Interval>$Config/IntervalSeconds$</Interval><SyncTime /></SimpleReccuringSchedule><ExcludeDates /></Scheduler></DataSource><ConditionDetection ID="Mapper"
TypeID="System!System.Discovery.ClassSnapshotDataMapper"><ClassId>$MPElement[Name="Microsoft.SystemCenter.Apm.NTServiceEndpoint"]$</ClassId><InstanceSettings><Settings><Setting><Name>$MPElement[Name="Microsoft.SystemCenter.Apm.NTServiceEndpoint"]/ServiceName$</Name><Value>$Target/Property[Type="NTService!Microsoft.SystemCenter.NTService"]/ServiceName$</Value></Setting><Setting><Name>$MPElement[Name="Microsoft.SystemCenter.Apm.NTServiceEndpoint"]/ServiceProcessName$</Name><Value>$Target/Property[Type="NTService!Microsoft.SystemCenter.NTService"]/ServiceProcessName$</Value></Setting><Setting><Name>$MPElement[Name="Microsoft.SystemCenter.Apm.NTServiceEndpoint"]/DisplayName$</Name><Value>$Target/Property[Type="NTService!Microsoft.SystemCenter.NTService"]/DisplayName$</Value></Setting><Setting><Name>$MPElement[Name="System!System.Entity"]/DisplayName$</Name><Value>$Target/Property[Type="System!System.Entity"]/DisplayName$</Value></Setting><Setting><Name>$MPElement[Name="Windows!Microsoft.Wi
ndows.Computer"]/PrincipalName$</Name><Value>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/PrincipalName$</Value></Setting></Settings></InstanceSettings></ConditionDetection></MemberModules><Composition><Node ID="Mapper"><Node ID="Scheduler" /></Node></Composition></Composite></ModuleImplementation><OutputType>System!System.Discovery.Data</OutputType></DataSourceModuleType><WriteActionModuleType ID="Microsoft.SystemCenter.Apm.NTServiceInstance.ApplyConfiguration" Accessibility="Internal" RunAs="System!System.PrivilegedMonitoringAccount" Batching="false"><Configuration><xsd:element xmlns:xsd="http://www.w3.org/2001/XMLSchema" name="Id" type="xsd:string" /><xsd:element xmlns:xsd="http://www.w3.org/2001/XMLSchema" name="ApplicationName" type="xsd:string" /><xsd:element xmlns:xsd="http://www.w3.org/2001/XMLSchema" name="ServiceName" type="xsd:string" /><xsd:element xmlns:xsd="http://www.w3.org/2001/XMLSchema" name="ServiceProcessName" type="xsd:string" /><xsd:element
xmlns:xsd="http://www.w3.org/2001/XMLSchema" name="NamespacesData" type="xsd:string" /><xsd:element xmlns:xsd="http://www.w3.org/2001/XMLSchema" name="ResourcesData" type="xsd:string" /><xsd:element xmlns:xsd="http://www.w3.org/2001/XMLSchema" name="ExcTrackingsData" type="xsd:string" /><xsd:element xmlns:xsd="http://www.w3.org/2001/XMLSchema" name="ExcHandlersData" type="xsd:string" /><xsd:element xmlns:xsd="http://www.w3.org/2001/XMLSchema" name="PerformanceThreshold" type="xsd:nonNegativeInteger" /><xsd:element xmlns:xsd="http://www.w3.org/2001/XMLSchema" name="SensitivityThreshold" type="xsd:nonNegativeInteger" /><xsd:element xmlns:xsd="http://www.w3.org/2001/XMLSchema" name="CollectAllExceptions" type="xsd:boolean" /><xsd:element xmlns:xsd="http://www.w3.org/2001/XMLSchema" name="ManagementGroupName" type="xsd:string" /><xsd:element xmlns:xsd="http://www.w3.org/2001/XMLSchema" name="ManagementGroupId" type="xsd:string" /><xsd:element xmlns:xsd="http://www.w3.org/2001/XMLSchema"
name="ApplicationGroupName" type="xsd:string" /></Configuration><ModuleImplementation Isolation="Any"><Managed><Assembly>Res.Microsoft.SystemCenter.Apm.NtServiceLibraryConfigManager</Assembly><Type>
              Microsoft.EnterpriseManagement.Modules.Apm.NtServicesLibraryConfigManager.WriteActions.NtServiceConfigurationWriteAction
            </Type></Managed></ModuleImplementation><InputType>System!System.BaseData</InputType></WriteActionModuleType></ModuleTypes></TypeDefinitions><Categories><Category ID="Microsoft.SystemCenter.Apm.Image.NTServiceComponent_16.Category" Target="Microsoft.SystemCenter.Apm.Image.NTServiceComponent_16" Value="System!System.Internal.ManagementPack.Images.u16x16Icon" /><Category ID="Microsoft.SystemCenter.Apm.Image.NTServiceComponent_80.Category" Target="Microsoft.SystemCenter.Apm.Image.NTServiceComponent_80" Value="System!System.Internal.ManagementPack.Images.DiagramIcon" /><Category ID="Microsoft.SystemCenter.Apm.Image.NTServiceInstance_16.Category" Target="Microsoft.SystemCenter.Apm.Image.NTServiceInstance_16" Value="System!System.Internal.ManagementPack.Images.u16x16Icon" /><Category ID="Microsoft.SystemCenter.Apm.Image.NTServiceInstance_80.Category" Target="Microsoft.SystemCenter.Apm.Image.NTServiceInstance_80" Value="System!System.Internal.ManagementPack.Images.DiagramIcon"
/><Category ID="Microsoft.SystemCenter.Apm.Image.NTServiceFunctionTransaction_16.Category" Target="Microsoft.SystemCenter.Apm.Image.NTServiceFunctionTransaction_16" Value="System!System.Internal.ManagementPack.Images.u16x16Icon" /><Category ID="Microsoft.SystemCenter.Apm.Image.NTServiceFunctionTransaction_80.Category" Target="Microsoft.SystemCenter.Apm.Image.NTServiceFunctionTransaction_80" Value="System!System.Internal.ManagementPack.Images.DiagramIcon" /><Category ID="Microsoft.SystemCenter.Apm.Image.NTServiceWcfTransaction_16.Category" Target="Microsoft.SystemCenter.Apm.Image.NTServiceWcfTransaction_16" Value="System!System.Internal.ManagementPack.Images.u16x16Icon" /><Category ID="Microsoft.SystemCenter.Apm.Image.NTServiceWcfTransaction_80.Category" Target="Microsoft.SystemCenter.Apm.Image.NTServiceWcfTransaction_80" Value="System!System.Internal.ManagementPack.Images.DiagramIcon" /></Categories><Monitoring><Discoveries><Discovery
ID="Microsoft.SystemCenter.Apm.NTServiceEndpoint.Discovery" Enabled="true" Target="NTService!Microsoft.SystemCenter.OwnProcessNTService" ConfirmDelivery="false" Remotable="false" Priority="Normal"><Category>Discovery</Category><DiscoveryTypes><DiscoveryClass TypeID="Microsoft.SystemCenter.Apm.NTServiceEndpoint"><Property TypeID="Microsoft.SystemCenter.Apm.NTServiceEndpoint" PropertyID="ServiceName" /><Property TypeID="Microsoft.SystemCenter.Apm.NTServiceEndpoint" PropertyID="ServiceProcessName" /><Property TypeID="Microsoft.SystemCenter.Apm.NTServiceEndpoint" PropertyID="DisplayName" /></DiscoveryClass></DiscoveryTypes><DataSource ID="DS" TypeID="Microsoft.SystemCenter.Apm.NTServiceEndpoint.Discovery.DataSource"><IntervalSeconds>3600</IntervalSeconds></DataSource></Discovery></Discoveries><Rules><Rule ID="Microsoft.SystemCenter.Apm.NTServiceInstance.ApplyConfigurationRule" Enabled="true" Target="Microsoft.SystemCenter.Apm.NTServiceInstance" ConfirmDelivery="false" Remotable="false"
Priority="Normal" DiscardLevel="100"><Category>Custom</Category><DataSources><DataSource ID="Scheduler" TypeID="System!System.SimpleScheduler"><IntervalSeconds>86400</IntervalSeconds><SyncTime /></DataSource></DataSources><WriteActions><WriteAction ID="WriteAction" RunAs="System!System.PrivilegedMonitoringAccount"
TypeID="Microsoft.SystemCenter.Apm.NTServiceInstance.ApplyConfiguration"><Id>$Target/Id$</Id><ApplicationName>$Target/Property[Type="AL!Microsoft.SystemCenter.Apm.ApplicationInstanceBase"]/ApplicationName$</ApplicationName><ServiceName>$Target/Property[Type="Microsoft.SystemCenter.Apm.NTServiceInstance"]/ServiceName$</ServiceName><ServiceProcessName>$Target/Property[Type="Microsoft.SystemCenter.Apm.NTServiceInstance"]/ServiceProcessName$</ServiceProcessName><NamespacesData>$Target/Property[Type="AL!Microsoft.SystemCenter.Apm.ApplicationInstance"]/Namespaces$</NamespacesData><ResourcesData>$Target/Property[Type="AL!Microsoft.SystemCenter.Apm.ApplicationInstance"]/Resources$</ResourcesData><ExcTrackingsData>$Target/Property[Type="AL!Microsoft.SystemCenter.Apm.ApplicationInstance"]/ExceptionTrackings$</ExcTrackingsData><ExcHandlersData>$Target/Property[Type="AL!Microsoft.SystemCenter.Apm.ApplicationInstance"]/ExceptionHandlers$</ExcHandlersData><PerformanceThreshold>$Target/Property[Type=
"AL!Microsoft.SystemCenter.Apm.ApplicationInstance"]/PerformanceThreshold$</PerformanceThreshold><SensitivityThreshold>$Target/Property[Type="AL!Microsoft.SystemCenter.Apm.ApplicationInstance"]/SensitivityThreshold$</SensitivityThreshold><CollectAllExceptions>$Target/Property[Type="AL!Microsoft.SystemCenter.Apm.ApplicationInstance"]/CollectAllExceptions$</CollectAllExceptions><ManagementGroupName>$Target/ManagementGroup/Name$</ManagementGroupName><ManagementGroupId>$Target/ManagementGroup/Id$</ManagementGroupId><ApplicationGroupName>$Target/Property[Type="AL!Microsoft.SystemCenter.Apm.ApplicationInstanceBase"]/ApplicationGroupName$</ApplicationGroupName></WriteAction></WriteActions></Rule></Rules><Tasks><Task ID="Microsoft.SystemCenter.Apm.NTServiceInstance.Restart.Task" Accessibility="Internal" Enabled="true" Target="Microsoft.SystemCenter.Apm.NTServiceInstance" Timeout="300" Remotable="false"><Category>Maintenance</Category><WriteAction ID="WA"
TypeID="System!System.CommandExecuter"><ApplicationName /><WorkingDirectory /><CommandLine>RestartService.cmd "$Target/Property[Type="Microsoft.SystemCenter.Apm.NTServiceInstance"]/ServiceName$"</CommandLine><TimeoutSeconds>600</TimeoutSeconds><RequireOutput>true</RequireOutput><Files><File><Name>RestartService.cmd</Name><Contents>
                 
                  @echo off
                  net stop %1
		  IF errorlevel 2 goto :Success
		  IF errorlevel 1 goto :Error
		  
		  sc query %1 | find "STATE" | find "STOPPED"
		  IF errorlevel 1 goto :Running
		
                  IF errorlevel 0 net start %1
                  IF errorlevel 0 goto :Success
		  goto :Error
                  :Error		
                  exit /B 1
   		  :Success
                  exit /B 0
		  :Running
		  echo The %1 service has been automatically started.
                  exit /B 0
                 
              </Contents><Unicode>false</Unicode></File></Files></WriteAction></Task></Tasks><Monitors><UnitMonitor ID="Microsoft.SystemCenter.Apm.NTServiceInstance.Restart.Monitor" Accessibility="Public" Enabled="true" Target="Microsoft.SystemCenter.Apm.NTServiceInstance" ParentMonitorID="Health!System.Health.ConfigurationState" Remotable="false" Priority="Normal" TypeID="Windows!Microsoft.Windows.2SingleEventLog2StateMonitorType" ConfirmDelivery="false"><Category>ConfigurationHealth</Category><AlertSettings
AlertMessage="Microsoft.SystemCenter.Apm.NTServiceInstance.Restart.Monitor.AlertMessageResourceID"><AlertOnState>Warning</AlertOnState><AutoResolve>true</AutoResolve><AlertPriority>Normal</AlertPriority><AlertSeverity>Warning</AlertSeverity><AlertParameters><AlertParameter1>$Target/Host/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/PrincipalName$</AlertParameter1><AlertParameter2>$Target/Property[Type="AL!Microsoft.SystemCenter.Apm.ApplicationInstanceBase"]/ApplicationName$</AlertParameter2></AlertParameters></AlertSettings><OperationalStates><OperationalState ID="Success" MonitorTypeStateID="SecondEventRaised" HealthState="Success" /><OperationalState ID="Warning" MonitorTypeStateID="FirstEventRaised" HealthState="Warning" /></OperationalStates><Configuration><FirstComputerName>$Target/Host/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</FirstComputerName><FirstLogName>Operations
Manager</FirstLogName><FirstExpression><And><Expression><Or><Expression><SimpleExpression><ValueExpression><XPathQuery Type="Integer">EventDisplayNumber</XPathQuery></ValueExpression><Operator>Equal</Operator><ValueExpression><Value Type="Integer">35001</Value></ValueExpression></SimpleExpression></Expression><Expression><SimpleExpression><ValueExpression><XPathQuery Type="Integer">EventDisplayNumber</XPathQuery></ValueExpression><Operator>Equal</Operator><ValueExpression><Value Type="Integer">35002</Value></ValueExpression></SimpleExpression></Expression></Or></Expression><Expression><SimpleExpression><ValueExpression><XPathQuery Type="String">PublisherName</XPathQuery></ValueExpression><Operator>Equal</Operator><ValueExpression><Value Type="String">.NET app monitoring</Value></ValueExpression></SimpleExpression></Expression><Expression><SimpleExpression><ValueExpression><XPathQuery
Type="String">Params/Param[1]</XPathQuery></ValueExpression><Operator>Equal</Operator><ValueExpression><Value Type="String">$Target/Property[Type="AL!Microsoft.SystemCenter.Apm.ApplicationInstanceBase"]/ApplicationName$</Value></ValueExpression></SimpleExpression></Expression></And></FirstExpression><SecondComputerName>$Target/Host/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</SecondComputerName><SecondLogName>Operations Manager</SecondLogName><SecondExpression><And><Expression><SimpleExpression><ValueExpression><XPathQuery Type="Integer">EventDisplayNumber</XPathQuery></ValueExpression><Operator>Equal</Operator><ValueExpression><Value Type="Integer">4003</Value></ValueExpression></SimpleExpression></Expression><Expression><SimpleExpression><ValueExpression><XPathQuery Type="String">PublisherName</XPathQuery></ValueExpression><Operator>Equal</Operator><ValueExpression><Value Type="String">Apm
Agent</Value></ValueExpression></SimpleExpression></Expression><Expression><RegExExpression><ValueExpression><XPathQuery Type="String">EventDescription</XPathQuery></ValueExpression><Operator>ContainsSubstring</Operator><Pattern>$Target/Property[Type="AL!Microsoft.SystemCenter.Apm.ApplicationInstanceBase"]/ApplicationName$</Pattern></RegExExpression></Expression></And></SecondExpression></Configuration></UnitMonitor><DependencyMonitor ID="Microsoft.SystemCenter.ApplicationMonitoring.Net.NTServiceComponent.AvailabilityDependencyMonitor" Accessibility="Public" Enabled="true" Target="ApplicationMonitoring!Microsoft.SystemCenter.ApplicationMonitoring.Net.NTServiceComponent" ParentMonitorID="Health!System.Health.AvailabilityState" Remotable="false" Priority="Normal" RelationshipType="Microsoft.SystemCenter.Apm.NTServiceComponentHostsApmNTServiceComponent"
MemberMonitor="Health!System.Health.AvailabilityState"><Category>AvailabilityHealth</Category><Algorithm>WorstOf</Algorithm></DependencyMonitor><DependencyMonitor ID="Microsoft.SystemCenter.ApplicationMonitoring.Net.NTServiceComponent.PerformanceDependencyMonitor" Accessibility="Public" Enabled="true" Target="ApplicationMonitoring!Microsoft.SystemCenter.ApplicationMonitoring.Net.NTServiceComponent" ParentMonitorID="Health!System.Health.PerformanceState" Remotable="false" Priority="Normal" RelationshipType="Microsoft.SystemCenter.Apm.NTServiceComponentHostsApmNTServiceComponent" MemberMonitor="Health!System.Health.PerformanceState"><Category>PerformanceHealth</Category><Algorithm>WorstOf</Algorithm></DependencyMonitor><DependencyMonitor ID="Microsoft.SystemCenter.Apm.NTServiceComponent.AvailabilityDependencyMonitor" Accessibility="Public" Enabled="true" Target="Microsoft.SystemCenter.Apm.NTServiceComponent" ParentMonitorID="Health!System.Health.AvailabilityState" Remotable="false"
Priority="Normal" RelationshipType="Microsoft.SystemCenter.Apm.NTServiceComponentContainsApmNTServiceInstance" MemberMonitor="Health!System.Health.AvailabilityState"><Category>AvailabilityHealth</Category><Algorithm>WorstOf</Algorithm></DependencyMonitor><DependencyMonitor ID="Microsoft.SystemCenter.Apm.NTServiceComponent.PerformanceDependencyMonitor" Accessibility="Public" Enabled="true" Target="Microsoft.SystemCenter.Apm.NTServiceComponent" ParentMonitorID="Health!System.Health.PerformanceState" Remotable="false" Priority="Normal" RelationshipType="Microsoft.SystemCenter.Apm.NTServiceComponentContainsApmNTServiceInstance" MemberMonitor="Health!System.Health.PerformanceState"><Category>PerformanceHealth</Category><Algorithm>WorstOf</Algorithm></DependencyMonitor></Monitors></Monitoring><Presentation><ImageReferences><ImageReference ElementID="Microsoft.SystemCenter.Apm.NTServiceComponent" ImageID="Microsoft.SystemCenter.Apm.Image.NTServiceComponent_16" /><ImageReference
ElementID="Microsoft.SystemCenter.Apm.NTServiceComponent" ImageID="Microsoft.SystemCenter.Apm.Image.NTServiceComponent_80" /><ImageReference ElementID="Microsoft.SystemCenter.Apm.NTServiceInstance" ImageID="Microsoft.SystemCenter.Apm.Image.NTServiceInstance_16" /><ImageReference ElementID="Microsoft.SystemCenter.Apm.NTServiceInstance" ImageID="Microsoft.SystemCenter.Apm.Image.NTServiceInstance_80" /><ImageReference ElementID="Microsoft.SystemCenter.Apm.NTServiceFunctionTransaction" ImageID="Microsoft.SystemCenter.Apm.Image.NTServiceFunctionTransaction_16" /><ImageReference ElementID="Microsoft.SystemCenter.Apm.NTServiceFunctionTransaction" ImageID="Microsoft.SystemCenter.Apm.Image.NTServiceFunctionTransaction_80" /><ImageReference ElementID="Microsoft.SystemCenter.Apm.NTServiceWcfTransaction" ImageID="Microsoft.SystemCenter.Apm.Image.NTServiceWcfTransaction_16" /><ImageReference ElementID="Microsoft.SystemCenter.Apm.NTServiceWcfTransaction"
ImageID="Microsoft.SystemCenter.Apm.Image.NTServiceWcfTransaction_80" /></ImageReferences><StringResources><StringResource ID="Microsoft.SystemCenter.Apm.NTServiceInstance.Restart.Monitor.AlertMessageResourceID" /></StringResources></Presentation><LanguagePacks><LanguagePack ID="ENU" IsDefault="true"><DisplayStrings><DisplayString ElementID="Microsoft.SystemCenter.Apm.NTServiceComponent"><Name>APM Windows Service Component</Name><Description>APM Windows Service Component</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.Apm.NTServiceInstance"><Name>APM Windows Service</Name><Description>APM Windows Service</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.Apm.NTServiceInstance" SubElementID="ServiceName"><Name>Service Name</Name><Description>Service Name</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.Apm.NTServiceInstance" SubElementID="ServiceProcessName"><Name>Binary Path</Name><Description>Binary
Path</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.Apm.NTServiceComponentHostsApmNTServiceComponent"><Name>Hosting relationship for Windows Service monitoring component hosting APM Windows Service component</Name><Description>Hosting relationship for Windows Service monitoring component hosting APM Windows Service component</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.Apm.NTServiceComponentContainsApmNTServiceInstance"><Name>Containment relationship for APM Windows Service component containing APM Windows Service</Name><Description>Containment relationship for APM Windows Service component containing APM Windows Service</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.Apm.NTServiceFunctionTransactionRole"><Name>.NET Function Transaction Role (Windows Service)</Name><Description>.NET Function Transaction Role (Windows Service)</Description></DisplayString><DisplayString
ElementID="Microsoft.SystemCenter.Apm.NTServiceFunctionTransaction"><Name>.NET Function Transaction (Windows Service)</Name><Description>.NET Function Transaction (Windows Service)</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.Apm.NTServiceComponentHostsNTServiceFunctionTransactionRole"><Name>Hosting relationship for Windows Service monitoring component hosting Function Transaction Role</Name><Description>Hosting relationship for Windows Service monitoring component hosting Function Transaction Role</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.Apm.NTServiceInstanceHostsNTServiceFunctionTransaction"><Name>Hosting relationship for APM Windows Service hosting Function Transaction</Name><Description>Hosting relationship for APM Windows Service hosting Function Transaction</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.Apm.NTServiceEndpoint"><Name>Windows Service
Endpoint</Name><Description>Windows Service Endpoint</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.Apm.NTServiceEndpoint" SubElementID="DisplayName"><Name>Service Display Name</Name><Description>Service Display Name</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.Apm.NTServiceEndpoint" SubElementID="ServiceName"><Name>Service Name</Name><Description>Service Name</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.Apm.NTServiceEndpoint" SubElementID="ServiceProcessName"><Name>Service Process Name</Name><Description>Service Process Name</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.Apm.NTServiceEndpoint.Discovery"><Name>Windows Service Endpoints Discovery</Name><Description>Windows Service Endpoints Discovery</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.Apm.NTServiceEndpoint.Discovery.DataSource"><Name>Windows Service Endpoints
discovery data source</Name><Description>Windows Service Endpoints discovery data source</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.Apm.NTServiceEndpoint.Discovery.DataSource" SubElementID="IntervalSeconds"><Name>Interval Seconds</Name><Description>Interval Seconds</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.Apm.NTServiceWcfTransactionRole"><Name>WCF Transaction Role (Windows Service)</Name><Description>WCF Transaction Role (Windows Service)</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.Apm.NTServiceWcfTransaction"><Name>WCF Transaction (Windows Service)</Name><Description>WCF Transaction (Windows Service)</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.Apm.NTServiceComponentHostsNTServiceWcfTransactionRole"><Name>Hosting relationship for Windows Service monitoring component hosting WCF Transaction Role</Name><Description>Hosting relationship for Windows
Service monitoring component hosting WCF Transaction Role</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.Apm.NTServiceInstanceHostsNTServiceWcfTransaction"><Name>Hosting relationship for APM Windows Service hosting WCF Transaction</Name><Description>Hosting relationship for APM Windows Service hosting WCF Transaction</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.ApplicationMonitoring.Net.NTServiceComponent.AvailabilityDependencyMonitor"><Name>.NET Windows Service Component Availability Roll-up Monitor</Name><Description>.NET Windows Service Component Availability Roll-up Monitor</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.ApplicationMonitoring.Net.NTServiceComponent.PerformanceDependencyMonitor"><Name>.NET Windows Service Component Performance Roll-up Monitor</Name><Description>.NET Windows Service Component Performance Roll-up Monitor</Description></DisplayString><DisplayString
ElementID="Microsoft.SystemCenter.Apm.NTServiceComponent.AvailabilityDependencyMonitor"><Name>APM Windows Service Component Availability Roll-up Monitor</Name><Description>APM Windows Service Component Availability Rollup Monitor</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.Apm.NTServiceComponent.PerformanceDependencyMonitor"><Name>APM Windows Service Component Performance Roll-up Monitor</Name><Description>APM Windows Service Component Performance Rollup Monitor</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.Apm.NTServiceInstance.Restart.Monitor"><Name>Windows service restart is required</Name><Description>This monitor tracks the need to restart a Windows service due to a change in monitoring settings for this Windows service running on the server.</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.Apm.NTServiceInstance.Restart.Monitor" SubElementID="Success"><Name>Windows service restart is
not required</Name></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.Apm.NTServiceInstance.Restart.Monitor" SubElementID="Warning"><Name>Windows service restart is required</Name></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.Apm.NTServiceInstance.Restart.Monitor.AlertMessageResourceID"><Name>Windows service restart is required</Name><Description>Application monitoring settings on server {0} were modified. To apply the new settings, you must restart Windows service '{1}' on that server. The new monitoring settings will not be applied until Windows service is restarted. However, the monitored applications will continue to function properly. If the service is using the Microsoft .NET Framework, when the service is restarted, monitoring will start, the state will be reset to healthy, and this alert will close.</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.Apm.NTServices"><Name>Operations Manager APM Windows
Services</Name><Description>Operations Manager APM Windows Services management pack</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.Apm.NTServiceInstance.ApplyConfiguration"><Name>Apply windows service configuration write action</Name><Description>Apply windows service configuration write action.</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.Apm.NTServiceInstance.ApplyConfigurationRule"><Name>Apply windows service configuration</Name><Description>Apply windows service configuration.</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.Apm.NTServiceInstance.Restart.Task"><Name>Restart Windows Service</Name><Description>This task restarts target windows service on target computers.</Description></DisplayString></DisplayStrings><KnowledgeArticles><KnowledgeArticle ElementID="Microsoft.SystemCenter.Apm.NTServiceEndpoint.Discovery" Visible="true"><MamlContent><maml:section
xmlns:maml="http://schemas.microsoft.com/maml/2004/10"><maml:title>Summary</maml:title><maml:para>This discovery provides Windows Service endpoints for the application performance monitoring.</maml:para></maml:section></MamlContent></KnowledgeArticle><KnowledgeArticle ElementID="Microsoft.SystemCenter.ApplicationMonitoring.Net.NTServiceComponent.AvailabilityDependencyMonitor" Visible="true"><MamlContent><maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10"><maml:title>Summary</maml:title><maml:para>This monitor rolls up availability monitoring for this object.  If the state is unknown, either monitoring has not begun for this object or there are no monitors defined that monitor availability.</maml:para></maml:section><maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10"><maml:title>Causes</maml:title><maml:para>An unhealthy state for this monitor indicates a problem with child monitor. View all current alerts from this object using this
link:</maml:para><maml:para><maml:navigationLink><maml:linkText>View Alerts</maml:linkText><maml:uri condition="View" href="Microsoft.SystemCenter.AlertView&amp;viewtarget={$TARGET$}" uri="MOM.Console.Exe" /></maml:navigationLink></maml:para></maml:section><maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10"><maml:title>Resolutions</maml:title><maml:para>Use the health explorer to drill down and find the cause of the unhealthy state.  Use the knowledge on the specific monitor causing the issue to troubleshoot and fix the problem.</maml:para></maml:section></MamlContent></KnowledgeArticle><KnowledgeArticle ElementID="Microsoft.SystemCenter.ApplicationMonitoring.Net.NTServiceComponent.PerformanceDependencyMonitor" Visible="true"><MamlContent><maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10"><maml:title>Summary</maml:title><maml:para>This monitor rolls up performance monitoring for this object.  If the state is unknown, either monitoring has not begun
for this object or there are no monitors defined that monitor performance.</maml:para></maml:section><maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10"><maml:title>Causes</maml:title><maml:para>An unhealthy state for this monitor indicates a problem with child monitor. View all current alerts from this object using this link:</maml:para><maml:para><maml:navigationLink><maml:linkText>View Alerts</maml:linkText><maml:uri condition="View" href="Microsoft.SystemCenter.AlertView&amp;viewtarget={$TARGET$}" uri="MOM.Console.Exe" /></maml:navigationLink></maml:para></maml:section><maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10"><maml:title>Resolutions</maml:title><maml:para>Use the health explorer to drill down and find the cause of the unhealthy state.  Use the knowledge on the specific monitor causing the issue to troubleshoot and fix the problem.</maml:para></maml:section></MamlContent></KnowledgeArticle><KnowledgeArticle
ElementID="Microsoft.SystemCenter.Apm.NTServiceComponent.AvailabilityDependencyMonitor" Visible="true"><MamlContent><maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10"><maml:title>Summary</maml:title><maml:para>This monitor rolls up availability monitoring for this object.  If the state is unknown, either monitoring has not begun for this object or there are no monitors defined that monitor availability.</maml:para></maml:section><maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10"><maml:title>Causes</maml:title><maml:para>An unhealthy state for this monitor indicates a problem with child monitor. View all current alerts from this object using this link:</maml:para><maml:para><maml:navigationLink><maml:linkText>View Alerts</maml:linkText><maml:uri condition="View" href="Microsoft.SystemCenter.AlertView&amp;viewtarget={$TARGET$}" uri="MOM.Console.Exe" /></maml:navigationLink></maml:para></maml:section><maml:section
xmlns:maml="http://schemas.microsoft.com/maml/2004/10"><maml:title>Resolutions</maml:title><maml:para>Use the health explorer to drill down and find the cause of the unhealthy state.  Use the knowledge on the specific monitor causing the issue to troubleshoot and fix the problem.</maml:para></maml:section></MamlContent></KnowledgeArticle><KnowledgeArticle ElementID="Microsoft.SystemCenter.Apm.NTServiceComponent.PerformanceDependencyMonitor" Visible="true"><MamlContent><maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10"><maml:title>Summary</maml:title><maml:para>This monitor rolls up performance monitoring for this object.  If the state is unknown, either monitoring has not begun for this object or there are no monitors defined that monitor performance.</maml:para></maml:section><maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10"><maml:title>Causes</maml:title><maml:para>An unhealthy state for this monitor indicates a problem with child monitor. View
all current alerts from this object using this link:</maml:para><maml:para><maml:navigationLink><maml:linkText>View Alerts</maml:linkText><maml:uri condition="View" href="Microsoft.SystemCenter.AlertView&amp;viewtarget={$TARGET$}" uri="MOM.Console.Exe" /></maml:navigationLink></maml:para></maml:section><maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10"><maml:title>Resolutions</maml:title><maml:para>Use the health explorer to drill down and find the cause of the unhealthy state.  Use the knowledge on the specific monitor causing the issue to troubleshoot and fix the problem.</maml:para></maml:section></MamlContent></KnowledgeArticle><KnowledgeArticle ElementID="Microsoft.SystemCenter.Apm.NTServiceInstance.Restart.Monitor" Visible="true"><MamlContent><maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10"><maml:title>Summary</maml:title><maml:para>This monitor tracks the need to restart a Windows service due to a change in Application Performance
Monitoring (APM) settings. This monitor will transition to an unhealthy state when the given service must be restarted. If the service is using the Microsoft .NET Framework, when the service is restarted, monitoring will start and the state will be reset to healthy.</maml:para></maml:section><maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10"><maml:title>Causes</maml:title><maml:para>When application monitoring settings are modified for a Windows service using the .NET Application Performance Monitoring template, the service targeted for monitoring might need to be restarted for the new settings to take effect. If the service is using the Microsoft .NET Framework, when the service is restarted, monitoring will start and the state will be reset to healthy. If the selected service is not using the Microsoft .NET Framework, monitoring will not start, and this monitor will remain in an unhealthy state. Only services that are written in the .NET Framework can be monitored
by Application Performance Monitoring (APM). Make sure that the service that you want to monitor was written using the .NET Framework.</maml:para></maml:section><maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10"><maml:title>Resolutions</maml:title><maml:list><maml:listItem><maml:para>
                    If the service is using the Microsoft .NET Framework, you can restart the service by clicking the following link: <maml:navigationLink><maml:linkText>Restart Service</maml:linkText><maml:uri condition="Task" href="Microsoft.SystemCenter.Apm.NTServiceInstance.Restart.Task&amp;tasktarget={$TARGET$}" uri="MOM.Console.Exe" /></maml:navigationLink></maml:para></maml:listItem><maml:listItem><maml:para>You can also stop and start the Windows service directly on the agent.</maml:para></maml:listItem><maml:listItem><maml:para>If the service is not using the Microsoft .NET Framework, you must disable it from monitoring because the .NET Application Performance Monitoring template only supports monitoring Windows services written using the Microsoft .NET Framework.</maml:para></maml:listItem></maml:list></maml:section></MamlContent></KnowledgeArticle><KnowledgeArticle ElementID="Microsoft.SystemCenter.Apm.NTServices" Visible="true"><MamlContent><maml:section
xmlns:maml="http://schemas.microsoft.com/maml/2004/10"><maml:title>Summary</maml:title><maml:para>This management pack provides classes and workflows for .NET Windows Services performance monitoring.</maml:para></maml:section></MamlContent></KnowledgeArticle><KnowledgeArticle ElementID="Microsoft.SystemCenter.Apm.NTServiceInstance.ApplyConfigurationRule" Visible="true"><MamlContent><maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10"><maml:title>Summary</maml:title><maml:para>This rule applies the monitoring configuration for the application.</maml:para></maml:section></MamlContent></KnowledgeArticle></KnowledgeArticles></LanguagePack></LanguagePacks><Resources><Image ID="Microsoft.SystemCenter.Apm.Image.NTServiceComponent_16" Accessibility="Internal" FileName="NTServiceComponent_16.png" HasNullStream="false" /><Image ID="Microsoft.SystemCenter.Apm.Image.NTServiceComponent_80" Accessibility="Internal" FileName="NTServiceComponent_80.png" HasNullStream="false" /><Image
ID="Microsoft.SystemCenter.Apm.Image.NTServiceInstance_16" Accessibility="Internal" FileName="NTServiceInstance_16.png" HasNullStream="false" /><Image ID="Microsoft.SystemCenter.Apm.Image.NTServiceInstance_80" Accessibility="Internal" FileName="NTServiceInstance_80.png" HasNullStream="false" /><Image ID="Microsoft.SystemCenter.Apm.Image.NTServiceFunctionTransaction_16" Accessibility="Internal" FileName="FunctionTransaction_16.png" HasNullStream="false" /><Image ID="Microsoft.SystemCenter.Apm.Image.NTServiceFunctionTransaction_80" Accessibility="Internal" FileName="FunctionTransaction_80.png" HasNullStream="false" /><Image ID="Microsoft.SystemCenter.Apm.Image.NTServiceWcfTransaction_16" Accessibility="Internal" FileName="WFCMethodTransaction_16.png" HasNullStream="false" /><Image ID="Microsoft.SystemCenter.Apm.Image.NTServiceWcfTransaction_80" Accessibility="Internal" FileName="WFCMethodTransaction_80.png" HasNullStream="false" /><DeployableAssembly
ID="Res.Microsoft.SystemCenter.Apm.NtServiceLibraryConfigManager" Accessibility="Internal" FileName="Microsoft.EnterpriseManagement.Modules.Apm.NtServicesLibraryConfigManager.dll" HasNullStream="false" QualifiedName="Microsoft.EnterpriseManagement.Modules.Apm.NtServicesLibraryConfigManager, Version=7.0.5000.20, Culture=neutral, PublicKeyToken=31bf3856ad364e35"><Dependency ID="AI!Res.Microsoft.SystemCenter.Apm.LibraryConfigManager" /><Dependency ID="AI!Res.Microsoft.EnterpriseManagement.OperationsManager.Apm.DataClasses" /></DeployableAssembly></Resources></ManagementPack>
