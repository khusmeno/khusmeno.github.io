<ManagementPack xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" ContentReadable="true" SchemaVersion="2.0" OriginalSchemaVersion="1.0"><Manifest><Identity><ID>Microsoft.SystemCenter.ACS.Internal</ID><Version>10.22.10118.0</Version></Identity><Name>Microsoft System Center ACS Internal Management Pack</Name><References><Reference Alias="SCDW"><ID>Microsoft.SystemCenter.DataWarehouse.Library</ID><Version>7.0.8447.6</Version><PublicKeyToken>31bf3856ad364e35</PublicKeyToken></Reference><Reference Alias="SCLibrary"><ID>Microsoft.SystemCenter.Library</ID><Version>7.0.8447.6</Version><PublicKeyToken>31bf3856ad364e35</PublicKeyToken></Reference><Reference Alias="Windows"><ID>Microsoft.Windows.Library</ID><Version>7.5.8500.0</Version><PublicKeyToken>31bf3856ad364e35</PublicKeyToken></Reference><Reference Alias="Health"><ID>System.Health.Library</ID><Version>7.0.8447.6</Version><PublicKeyToken>31bf3856ad364e35</PublicKeyToken></Reference><Reference
Alias="System"><ID>System.Library</ID><Version>7.5.8500.0</Version><PublicKeyToken>31bf3856ad364e35</PublicKeyToken></Reference><Reference Alias="Performance"><ID>System.Performance.Library</ID><Version>7.0.8447.6</Version><PublicKeyToken>31bf3856ad364e35</PublicKeyToken></Reference></References></Manifest><TypeDefinitions><EntityTypes><ClassTypes><ClassType ID="Microsoft.SystemCenter.ACS.Collector" Accessibility="Public" Abstract="false" Base="Windows!Microsoft.Windows.ApplicationComponent" Hosted="true" Singleton="false" Extension="false" /><ClassType ID="Microsoft.SystemCenter.ACS.Forwarder" Accessibility="Public" Abstract="false" Base="Windows!Microsoft.Windows.ApplicationComponent" Hosted="true" Singleton="false" Extension="false" /><ClassType ID="Microsoft.SystemCenter.AuditCollectionService.Group" Accessibility="Public" Abstract="false" Base="SCLibrary!Microsoft.SystemCenter.FunctionalInstanceContainer" Hosted="false" Singleton="true" Extension="false"
/></ClassTypes><RelationshipTypes><RelationshipType ID="Microsoft.Windows.Computer.Hosts.Microsoft.SystemCenter.ACS.Collector" Accessibility="Public" Abstract="false" Base="System!System.Hosting"><Source ID="Source" MinCardinality="0" MaxCardinality="2147483647" Type="Windows!Microsoft.Windows.Computer" /><Target ID="Target" MinCardinality="0" MaxCardinality="2147483647" Type="Microsoft.SystemCenter.ACS.Collector" /></RelationshipType><RelationshipType ID="Microsoft.Windows.Computer.Hosts.Microsoft.SystemCenter.ACS.Forwarder" Accessibility="Public" Abstract="false" Base="System!System.Hosting"><Source ID="Source" MinCardinality="0" MaxCardinality="2147483647" Type="Windows!Microsoft.Windows.Computer" /><Target ID="Target" MinCardinality="0" MaxCardinality="2147483647" Type="Microsoft.SystemCenter.ACS.Forwarder" /></RelationshipType><RelationshipType ID="Microsoft.SystemCenter.AuditCollectionServiceGroup.ContainsACS.Collector" Accessibility="Public" Abstract="false"
Base="System!System.Containment"><Source ID="Source" MinCardinality="0" MaxCardinality="2147483647" Type="Microsoft.SystemCenter.AuditCollectionService.Group" /><Target ID="Target" MinCardinality="0" MaxCardinality="2147483647" Type="Microsoft.SystemCenter.ACS.Collector" /></RelationshipType><RelationshipType ID="Microsoft.SystemCenter.ManagementGroup.ContainsAuditCollectionServiceGroup" Accessibility="Public" Abstract="false" Base="System!System.Containment"><Source ID="Source" MinCardinality="0" MaxCardinality="2147483647" Type="SCLibrary!Microsoft.SystemCenter.ManagementGroup" /><Target ID="Target" MinCardinality="0" MaxCardinality="2147483647" Type="Microsoft.SystemCenter.AuditCollectionService.Group" /></RelationshipType></RelationshipTypes></EntityTypes><ModuleTypes><DataSourceModuleType ID="Microsoft.SystemCenter.ACS.Forwarder.DiscoveryDataSource" Accessibility="Public"
Batching="false"><Configuration><IncludeSchemaTypes><SchemaType>System!System.Discovery.MapperSchema</SchemaType></IncludeSchemaTypes><xsd:element xmlns:xsd="http://www.w3.org/2001/XMLSchema" name="Frequency" type="xsd:unsignedInt" /></Configuration><ModuleImplementation Isolation="Any"><Composite><MemberModules><DataSource ID="DS" TypeID="Windows!Microsoft.Windows.ExistingWin32ServiceDiscoveryProvider"><ComputerName /><ServiceName>adtagent</ServiceName><Frequency>$Config/Frequency$</Frequency></DataSource><ConditionDetection ID="ServiceAutomatic" TypeID="System!System.ExpressionFilter"><Expression><SimpleExpression><ValueExpression><XPathQuery Type="Integer">
                            Property[@Name='StartMode']
                          </XPathQuery></ValueExpression><Operator>Equal</Operator><ValueExpression><Value Type="Integer">2</Value></ValueExpression></SimpleExpression></Expression></ConditionDetection><ConditionDetection ID="Mapper" TypeID="System!System.Discovery.ClassSnapshotDataMapper"><ClassId>$MPElement[Name="Microsoft.SystemCenter.ACS.Forwarder"]$</ClassId><InstanceSettings><Settings><Setting><Name>$MPElement[Name="Windows!Microsoft.Windows.Computer"]/PrincipalName$</Name><Value>$Target/Property[Type="Windows!Microsoft.Windows.Computer"]/PrincipalName$</Value></Setting></Settings></InstanceSettings></ConditionDetection></MemberModules><Composition><Node ID="Mapper"><Node ID="ServiceAutomatic"><Node ID="DS" /></Node></Node></Composition></Composite></ModuleImplementation><OutputType>System!System.Discovery.Data</OutputType></DataSourceModuleType><WriteActionModuleType ID="Microsoft.SystemCenter.ACS.RestartACSForwarderAction" Accessibility="Internal"
RunAs="System!System.PrivilegedMonitoringAccount" Batching="false"><Configuration><IncludeSchemaTypes><SchemaType>Windows!Microsoft.Windows.WindowsEventLogEventTypeSchema</SchemaType></IncludeSchemaTypes><xsd:element xmlns:xsd="http://www.w3.org/2001/XMLSchema" name="EventId" type="xsd:integer" /><xsd:element xmlns:xsd="http://www.w3.org/2001/XMLSchema" name="EventType" type="WindowsEventLogEventType" /><xsd:element xmlns:xsd="http://www.w3.org/2001/XMLSchema" name="RestartReason" type="xsd:string" /></Configuration><ModuleImplementation Isolation="Any"><Composite><MemberModules><WriteAction ID="RestartACSForwarder" TypeID="Windows!Microsoft.Windows.PowerShellPropertyBagWriteAction"><ScriptName>RestartACSForwarder.ps1</ScriptName><ScriptBody>
param($EventId, $EVentType, $RestartReason)
$oAPI = new-object -comObject "MOM.ScriptAPI"
$oBag = $oAPI.CreatePropertyBag()
$SCRIPT_NAME = "RestartACSForwarder.ps1";
$ENU_MESSAGE_BASE = "Restarting Audit Collection Services Forwarder. ";
$SW_HIDE = 0;
$CREATE_BREAKAWAY_FROM_JOB = 0x1000000;
# Process Arguments:
#      0 - EventId
#      1 - EventType
#      2 - RestartReason
$EVENTLOG_SUCCESS =              0x0000;     #  Information event    
$EVENTLOG_AUDIT_FAILURE =        0x0010;     #  Failure Audit event  
$EVENTLOG_AUDIT_SUCCESS =        0x0008;     #  Success Audit event  
$EVENTLOG_ERROR_TYPE =           0x0001;     #  Error event          
$EVENTLOG_INFORMATION_TYPE =     0x0004;     #  Information event    
$EVENTLOG_WARNING_TYPE =         0x0002;     #  Warning event        
switch($EventType) 
{
    "Success"  { $EventType = $EVENTLOG_SUCCESS }
    "AuditFailure" { $EventType = $EVENTLOG_AUDIT_FAILURE }
    "AuditSuccess" { $EventType = $EVENTLOG_AUDIT_SUCCESS }
    "Error" { $EventType = $EVENTLOG_ERROR_TYPE }
    "Information" {$EventType = $EVENTLOG_INFORMATION_TYPE }
    "Warning" { $EventType = $EVENTLOG_WARNING_TYPE }
}
$RestartReason = $ENU_MESSAGE_BASE + $RestartReason;
$oAPI.LogScriptEvent($SCRIPT_NAME, $EventId, $EventType, $RestartReason)
$oBag.AddValue($SCRIPT_NAME, $RestartReason)
$oBag
$strCommand = [System.Environment]::ExpandEnvironmentVariables("%ComSpec% /c net stop adtagent &amp; net start adtagent &amp; net start adtagent &amp; net start adtagent &amp; net start adtagent");
// Configure the process to break away from the job
$objConfig=[wmiclass]"Win32_ProcessStartup"
$objConfig.Properties['ShowWindow'].value=$False
([wmiclass]"win32_Process").create($strCommand, $null ,$objConfig, $intProcessID)
                                </ScriptBody><Parameters><Parameter><Name>EventId</Name><Value>$Config/EventId$</Value></Parameter><Parameter><Name>EVentType</Name><Value>$Config/EventType$</Value></Parameter><Parameter><Name>RestartReason</Name><Value>$Config/RestartReason$</Value></Parameter></Parameters><TimeoutSeconds>300</TimeoutSeconds></WriteAction></MemberModules><Composition><Node ID="RestartACSForwarder" /></Composition></Composite></ModuleImplementation><OutputType>System!System.PropertyBagData</OutputType><InputType>System!System.BaseData</InputType></WriteActionModuleType><WriteActionModuleType ID="Microsoft.SystemCenter.DisableACSAction" Accessibility="Internal" Batching="false"><Configuration /><ModuleImplementation Isolation="Any"><Composite><MemberModules><WriteAction ID="DisableACS" TypeID="System!System.CommandExecuter"><ApplicationName>%windir%\system32\windowspowershell\v1.0\powershell.exe</ApplicationName><WorkingDirectory /><CommandLine>-ExecutionPolicy
Unrestricted -Command "&amp; '$File/DisableACSAction.ps1$'"</CommandLine><TimeoutSeconds>90</TimeoutSeconds><RequireOutput>true</RequireOutput><Files><File><Name>DisableACSAction.ps1</Name><Contents>
$ServiceName = "AdtAgent"
Set-Service $ServiceName -StartupType "Disabled"
Stop-Service $ServiceName
                                        </Contents></File></Files></WriteAction></MemberModules><Composition><Node ID="DisableACS" /></Composition></Composite></ModuleImplementation><InputType>System!System.BaseData</InputType></WriteActionModuleType><WriteActionModuleType ID="Microsoft.SystemCenter.EnableACSAction" Accessibility="Internal" Batching="false"><Configuration><xsd:element xmlns:xsd="http://www.w3.org/2001/XMLSchema" name="CollectorServer" type="xsd:string" /><xsd:element xmlns:xsd="http://www.w3.org/2001/XMLSchema" name="TargetComputerName" type="xsd:string" /></Configuration><OverrideableParameters><OverrideableParameter ID="CollectorServer" Selector="$Config/CollectorServer$" ParameterType="string" /></OverrideableParameters><ModuleImplementation Isolation="Any"><Composite><MemberModules><WriteAction ID="EnableACS" TypeID="Windows!Microsoft.Windows.PowerShellWriteAction"><ScriptName>EnableACSAction.ps1</ScriptName><ScriptBody>
                param($strCollectorServer, $strClientAgentGroup, $strTargetComputerName)
$message = "Agent Management Group: " + $strClientAgentGroup
Write-Host $message
$strACSKeyPath = "HKLM:SOFTWARE\Policies\Microsoft\AdtAgent\Parameters"
$strMOMKeyPath = "HKLM:SOFTWARE\Microsoft\Microsoft Operations Manager\3.0\Agent Management Groups\"+$strClientAgentGroup+"\Parent Health Services\0"
$strValueName = "LocalConfig"
set-itemproperty -path $strACSKeyPath -name $strValueName -value 1
$strValueName = "NoCache"
set-itemproperty -path $strACSKeyPath -name $strValueName -value 1
if (($strCollectorServer -eq "[Collector Server]") -or ($strCollectorServer -eq "") -or ($strCollectorServer -eq $null))
{   
	  $Values = Get-ItemProperty -Path $strMOMKeyPath
    
    if (($Values -eq $null) -or ($Values.NetworkName -eq $null))
    {
      $Value = $strTargetComputerName
    }else{
      $Value = $Values.NetworkName 
    }
    
    $strValueName = "AdtServers"
	  Set-ItemProperty -path $strACSKeyPath -name $strValueName -value $Value
    } else 
{
    $strValueName = "AdtServers"
    $arrayCollectorServers = $strCollectorServer.Split(",")
    for($item = 0; $item -lt $arrayCollectorServers.Length; $item++)
    {
        $arrayCollectorServers[$item] = $arrayCollectorServers[$item].trim()
    }
     Set-ItemProperty -path $strACSKeyPath -name $strValueName -value $arrayCollectorServers
}
$ServiceName = "AdtAgent"
Set-Service $ServiceName -StartupType "Automatic"
Write-Host "Service changed"
$stoppedCorrectly = $true
$adtService = Get-Service -Name $ServiceName
if($adtService.Status -eq "Running") 
{
    # we need to stop the service so it can pick up the registry changes
    
    Write-Host "Stopping service so it can pick up changes"
    Stop-Service $ServiceName
	$adtService = Get-Service -Name $ServiceName
    if ($adtService.Status -ne "Stopped") 
	{
        Write-Host "Service not stopped"
        $stoppedCorrectly = $false
    }else 
	{
        $Counter = 6
    
        while ($Counter &gt; 0) 
		{ 
            $Counter = $Counter - 1
            $adtService = Get-Service -Name $ServiceName
            if ($adtService.Status -eq "Stopped") 
            {
                #
                # 6 means Service Not Active
                #
                
                $stoppedCorrectly = $true
                break
            } else
			{
                $message = "InterrogateService return code:" + $adtService
                Write-Host $message
            }
			$TimeOut = 10000
			Start-Sleep -m $TimeOut
        }
        
        if ($stoppedCorrectly) 
		{
            Write-Host "Service stopped correctly"
        }else {
            Write-Host "Unable to stop Service in 60 seconds"
            Write-Host "You should manually stop and start the AdtAgent service on the target machine"
        }
    }
}
if($stoppedCorrectly) 
{
    Write-Host "Starting service"
    $ServiceName = "AdtAgent"
	Start-Service $ServiceName
	$TimeOut = 10000
    Start-Sleep -m $TimeOut
    $adtService = Get-Service -Name $ServiceName
    if ($adtService.Status -ne "Running") 
	{
        Write-Host "Service was not started correctly"
        Write-Host "start Service Manually"
    } else {
        Write-Host "Service started correctly"
    }
}
                </ScriptBody><Parameters><Parameter><Name>strCollectorServer</Name><Value>$Config/CollectorServer$</Value></Parameter><Parameter><Name>strClientAgentGroup</Name><Value>$Target/ManagementGroup/Name$</Value></Parameter><Parameter><Name>strTargetComputerName</Name><Value>$Config/TargetComputerName$</Value></Parameter></Parameters><TimeoutSeconds>90</TimeoutSeconds><StrictErrorHandling>true</StrictErrorHandling></WriteAction></MemberModules><Composition><Node ID="EnableACS" /></Composition></Composite></ModuleImplementation><InputType>System!System.BaseData</InputType></WriteActionModuleType></ModuleTypes></TypeDefinitions><Categories><Category ID="Cat.Microsoft.SystemCenter.ACS.Collector.16x16Image" Target="Microsoft.SystemCenter.ACS.Collector.16x16Image" Value="System!System.Internal.ManagementPack.Images.u16x16Icon" /><Category ID="Cat.Microsoft.SystemCenter.ACS.Collector.80x80Image" Target="Microsoft.SystemCenter.ACS.Collector.80x80Image"
Value="System!System.Internal.ManagementPack.Images.DiagramIcon" /></Categories><Monitoring><Discoveries><Discovery ID="Microsoft.SystemCenter.ACS.Collector.Discovery" Enabled="true" Target="Windows!Microsoft.Windows.Computer" ConfirmDelivery="true" Remotable="true" Priority="Normal"><Category>Discovery</Category><DiscoveryTypes><DiscoveryClass TypeID="Microsoft.SystemCenter.ACS.Collector" /></DiscoveryTypes><DataSource ID="DS" TypeID="Windows!Microsoft.Windows.Win32ServiceInformationProviderWithClassSnapshotDataMapper"><ComputerName
/><ServiceName>adtserver</ServiceName><Frequency>60</Frequency><ClassId>$MPElement[Name="Microsoft.SystemCenter.ACS.Collector"]$</ClassId><InstanceSettings><Settings><Setting><Name>$MPElement[Name="System!System.Entity"]/DisplayName$</Name><Value>$Target/Property[Type="Windows!Microsoft.Windows.Computer"]/PrincipalName$</Value></Setting><Setting><Name>$MPElement[Name="Windows!Microsoft.Windows.Computer"]/PrincipalName$</Name><Value>$Target/Property[Type="Windows!Microsoft.Windows.Computer"]/PrincipalName$</Value></Setting></Settings></InstanceSettings></DataSource></Discovery><Discovery ID="Microsoft.SystemCenter.ACS.Forwarder.Discovery" Enabled="true" Target="Windows!Microsoft.Windows.Computer" ConfirmDelivery="false" Remotable="true" Priority="Normal"><Category>Discovery</Category><DiscoveryTypes><DiscoveryClass TypeID="Microsoft.SystemCenter.ACS.Forwarder" /></DiscoveryTypes><DataSource ID="DS"
TypeID="Microsoft.SystemCenter.ACS.Forwarder.DiscoveryDataSource"><Frequency>60</Frequency></DataSource></Discovery><Discovery ID="Microsoft.SystemCenter.ACSGroupPopulator" Enabled="true" Target="Microsoft.SystemCenter.AuditCollectionService.Group" ConfirmDelivery="false" Remotable="true" Priority="Normal"><Category>Discovery</Category><DiscoveryTypes><DiscoveryRelationship TypeID="Microsoft.SystemCenter.AuditCollectionServiceGroup.ContainsACS.Collector" /></DiscoveryTypes><DataSource ID="GroupPopulator" TypeID="SCLibrary!Microsoft.SystemCenter.GroupPopulator"><RuleId>$MPElement$</RuleId><GroupInstanceId>$Target/Id$</GroupInstanceId><MembershipRules><MembershipRule><MonitoringClass>$MPElement[Name="Microsoft.SystemCenter.ACS.Collector"]$</MonitoringClass><RelationshipClass>$MPElement[Name="Microsoft.SystemCenter.AuditCollectionServiceGroup.ContainsACS.Collector"]$</RelationshipClass></MembershipRule></MembershipRules></DataSource></Discovery><Discovery
ID="Microsoft.SystemCenter.ManagementGroup.ContainsAuditCollectionServiceGroupRelationship" Enabled="true" Target="SCLibrary!Microsoft.SystemCenter.ManagementGroup" ConfirmDelivery="false" Remotable="true" Priority="Normal"><Category>Discovery</Category><DiscoveryTypes><DiscoveryRelationship TypeID="Microsoft.SystemCenter.ManagementGroup.ContainsAuditCollectionServiceGroup" /></DiscoveryTypes><DataSource ID="GroupPopulator" TypeID="SCLibrary!Microsoft.SystemCenter.GroupPopulator"><RuleId>$MPElement$</RuleId><GroupInstanceId>$Target/Id$</GroupInstanceId><MembershipRules><MembershipRule><MonitoringClass>$MPElement[Name="Microsoft.SystemCenter.AuditCollectionService.Group"]$</MonitoringClass><RelationshipClass>$MPElement[Name="Microsoft.SystemCenter.ManagementGroup.ContainsAuditCollectionServiceGroup"]$</RelationshipClass></MembershipRule></MembershipRules></DataSource></Discovery></Discoveries><Rules><Rule
ID="Microsoft.SystemCenter.ACS.Collector.CollectionRule.Performance.ConnectedClients" Enabled="true" Target="Microsoft.SystemCenter.ACS.Collector" ConfirmDelivery="false" Remotable="true" Priority="Normal" DiscardLevel="100"><Category>PerformanceCollection</Category><DataSources><DataSource ID="DS" TypeID="Performance!System.Performance.OptimizedDataProvider"><ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName><CounterName>Connected Clients</CounterName><ObjectName>ACS Collector</ObjectName><InstanceName /><AllInstances>false</AllInstances><Frequency>900</Frequency><Tolerance>5</Tolerance><ToleranceType>Percentage</ToleranceType><MaximumSampleSeparation>10</MaximumSampleSeparation></DataSource></DataSources><WriteActions><WriteAction ID="WriteToDB" TypeID="SCLibrary!Microsoft.SystemCenter.CollectPerformanceData" /><WriteAction ID="WriteToDW" TypeID="SCDW!Microsoft.SystemCenter.DataWarehouse.PublishPerformanceData"
/></WriteActions></Rule><Rule ID="Microsoft.SystemCenter.ACS.Collector.CollectionRule.Performance.DatabaseQueueBackoffThresholdInPercent" Enabled="true" Target="Microsoft.SystemCenter.ACS.Collector" ConfirmDelivery="false" Remotable="true" Priority="Normal" DiscardLevel="100"><Category>PerformanceCollection</Category><DataSources><DataSource ID="DS" TypeID="Performance!System.Performance.OptimizedDataProvider"><ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName><CounterName>Database Queue Backoff Threshold in %</CounterName><ObjectName>ACS Collector</ObjectName><InstanceName /><AllInstances>false</AllInstances><Frequency>900</Frequency><Tolerance>5</Tolerance><ToleranceType>Percentage</ToleranceType><MaximumSampleSeparation>10</MaximumSampleSeparation></DataSource></DataSources><WriteActions><WriteAction ID="WriteToDB" TypeID="SCLibrary!Microsoft.SystemCenter.CollectPerformanceData" /><WriteAction ID="WriteToDW"
TypeID="SCDW!Microsoft.SystemCenter.DataWarehouse.PublishPerformanceData" /></WriteActions></Rule><Rule ID="Microsoft.SystemCenter.ACS.Collector.CollectionRule.Performance.DatabaseQueueDisconnectThresholdInPercent" Enabled="true" Target="Microsoft.SystemCenter.ACS.Collector" ConfirmDelivery="false" Remotable="true" Priority="Normal" DiscardLevel="100"><Category>PerformanceCollection</Category><DataSources><DataSource ID="DS" TypeID="Performance!System.Performance.OptimizedDataProvider"><ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName><CounterName>Database Queue Disconnect Threshold in %</CounterName><ObjectName>ACS Collector</ObjectName><InstanceName /><AllInstances>false</AllInstances><Frequency>900</Frequency><Tolerance>5</Tolerance><ToleranceType>Percentage</ToleranceType><MaximumSampleSeparation>10</MaximumSampleSeparation></DataSource></DataSources><WriteActions><WriteAction ID="WriteToDB"
TypeID="SCLibrary!Microsoft.SystemCenter.CollectPerformanceData" /><WriteAction ID="WriteToDW" TypeID="SCDW!Microsoft.SystemCenter.DataWarehouse.PublishPerformanceData" /></WriteActions></Rule><Rule ID="Microsoft.SystemCenter.ACS.Collector.CollectionRule.Performance.DatabaseQueuePercentFull" Enabled="true" Target="Microsoft.SystemCenter.ACS.Collector" ConfirmDelivery="false" Remotable="true" Priority="Normal" DiscardLevel="100"><Category>PerformanceCollection</Category><DataSources><DataSource ID="DS" TypeID="Performance!System.Performance.OptimizedDataProvider"><ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName><CounterName>Database Queue % Full</CounterName><ObjectName>ACS Collector</ObjectName><InstanceName
/><AllInstances>false</AllInstances><Frequency>900</Frequency><Tolerance>5</Tolerance><ToleranceType>Percentage</ToleranceType><MaximumSampleSeparation>10</MaximumSampleSeparation></DataSource></DataSources><WriteActions><WriteAction ID="WriteToDB" TypeID="SCLibrary!Microsoft.SystemCenter.CollectPerformanceData" /><WriteAction ID="WriteToDW" TypeID="SCDW!Microsoft.SystemCenter.DataWarehouse.PublishPerformanceData" /></WriteActions></Rule><Rule ID="Microsoft.SystemCenter.ACS.Collector.CollectionRule.Performance.DBLoaderEventInsertsPerSec" Enabled="true" Target="Microsoft.SystemCenter.ACS.Collector" ConfirmDelivery="false" Remotable="true" Priority="Normal" DiscardLevel="100"><Category>PerformanceCollection</Category><DataSources><DataSource ID="DS" TypeID="Performance!System.Performance.OptimizedDataProvider"><ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName><CounterName>DB Loader Event Inserts/sec</CounterName><ObjectName>ACS
Collector</ObjectName><InstanceName /><AllInstances>false</AllInstances><Frequency>900</Frequency><Tolerance>5</Tolerance><ToleranceType>Percentage</ToleranceType><MaximumSampleSeparation>10</MaximumSampleSeparation></DataSource></DataSources><WriteActions><WriteAction ID="WriteToDB" TypeID="SCLibrary!Microsoft.SystemCenter.CollectPerformanceData" /><WriteAction ID="WriteToDW" TypeID="SCDW!Microsoft.SystemCenter.DataWarehouse.PublishPerformanceData" /></WriteActions></Rule><Rule ID="Microsoft.SystemCenter.ACS.Collector.CollectionRule.Performance.DBStringCacheHitPercent" Enabled="true" Target="Microsoft.SystemCenter.ACS.Collector" ConfirmDelivery="false" Remotable="true" Priority="Normal" DiscardLevel="100"><Category>PerformanceCollection</Category><DataSources><DataSource ID="DS" TypeID="Performance!System.Performance.OptimizedDataProvider"><ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName><CounterName>DB String Cache Hit
%</CounterName><ObjectName>ACS Collector</ObjectName><InstanceName /><AllInstances>false</AllInstances><Frequency>900</Frequency><Tolerance>5</Tolerance><ToleranceType>Percentage</ToleranceType><MaximumSampleSeparation>10</MaximumSampleSeparation></DataSource></DataSources><WriteActions><WriteAction ID="WriteToDB" TypeID="SCLibrary!Microsoft.SystemCenter.CollectPerformanceData" /><WriteAction ID="WriteToDW" TypeID="SCDW!Microsoft.SystemCenter.DataWarehouse.PublishPerformanceData" /></WriteActions></Rule><Rule ID="Microsoft.SystemCenter.ACS.Collector.CollectionRule.Performance.IncomingEventsPerSec" Enabled="true" Target="Microsoft.SystemCenter.ACS.Collector" ConfirmDelivery="false" Remotable="true" Priority="Normal" DiscardLevel="100"><Category>PerformanceCollection</Category><DataSources><DataSource ID="DS"
TypeID="Performance!System.Performance.OptimizedDataProvider"><ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName><CounterName>Incoming Events/sec</CounterName><ObjectName>ACS Collector</ObjectName><InstanceName /><AllInstances>false</AllInstances><Frequency>900</Frequency><Tolerance>5</Tolerance><ToleranceType>Percentage</ToleranceType><MaximumSampleSeparation>10</MaximumSampleSeparation></DataSource></DataSources><WriteActions><WriteAction ID="WriteToDB" TypeID="SCLibrary!Microsoft.SystemCenter.CollectPerformanceData" /><WriteAction ID="WriteToDW" TypeID="SCDW!Microsoft.SystemCenter.DataWarehouse.PublishPerformanceData" /></WriteActions></Rule><Rule ID="Microsoft.SystemCenter.ACS.Collector.DatabaseOperation.Failure" Enabled="true" Target="Microsoft.SystemCenter.ACS.Collector" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100"><Category>Alert</Category><DataSources><DataSource ID="DS"
TypeID="Windows!Microsoft.Windows.EventProvider"><ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName><LogName>Operations Manager</LogName><Expression><And><Expression><SimpleExpression><ValueExpression><XPathQuery Type="String">PublisherName</XPathQuery></ValueExpression><Operator>Equal</Operator><ValueExpression><Value Type="String">AdtServer</Value></ValueExpression></SimpleExpression></Expression><Expression><SimpleExpression><ValueExpression><XPathQuery Type="String">Params/Param[2]</XPathQuery></ValueExpression><Operator>NotEqual</Operator><ValueExpression><Value Type="String">0x00000000</Value></ValueExpression></SimpleExpression></Expression><Expression><And><Expression><SimpleExpression><ValueExpression><XPathQuery Type="UnsignedInteger">EventDisplayNumber</XPathQuery></ValueExpression><Operator>GreaterEqual</Operator><ValueExpression><Value
Type="UnsignedInteger">4619</Value></ValueExpression></SimpleExpression></Expression><Expression><SimpleExpression><ValueExpression><XPathQuery Type="UnsignedInteger">EventDisplayNumber</XPathQuery></ValueExpression><Operator>LessEqual</Operator><ValueExpression><Value Type="UnsignedInteger">4621</Value></ValueExpression></SimpleExpression></Expression></And></Expression></And></Expression></DataSource></DataSources><WriteActions><WriteAction ID="Alert" TypeID="Health!System.Health.GenerateAlert"><Priority>1</Priority><Severity>1</Severity><AlertName /><AlertDescription /><AlertOwner
/><AlertMessageId>$MPElement[Name="Microsoft.SystemCenter.ACS.Collector.DatabaseOperation.Failure.AlertMessage"]$</AlertMessageId><AlertParameters><AlertParameter1>$Data/Params/Param[2]$</AlertParameter1></AlertParameters><Suppression><SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue><SuppressionValue>$Data/PublisherName$</SuppressionValue><SuppressionValue>$Data/LoggingComputer$</SuppressionValue><SuppressionValue>$Data/Params/Param[2]$</SuppressionValue></Suppression><Custom1>$Data/Params/Param[2]$</Custom1><Custom2 /><Custom3 /><Custom4 /><Custom5 /><Custom6 /><Custom7 /><Custom8 /><Custom9 /><Custom10 /></WriteAction></WriteActions></Rule><Rule ID="Microsoft.SystemCenter.ACS.Collector.EventCollection" Enabled="true" Target="Microsoft.SystemCenter.ACS.Collector" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100"><Category>EventCollection</Category><DataSources><DataSource ID="DS"
TypeID="Windows!Microsoft.Windows.EventProvider"><ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName><LogName>Operations Manager</LogName><Expression><SimpleExpression><ValueExpression><XPathQuery Type="String">PublisherName</XPathQuery></ValueExpression><Operator>Equal</Operator><ValueExpression><Value Type="String">AdtServer</Value></ValueExpression></SimpleExpression></Expression></DataSource></DataSources><WriteActions><WriteAction ID="WriteToDB" TypeID="SCLibrary!Microsoft.SystemCenter.CollectEvent" /><WriteAction ID="WriteToDW" TypeID="SCDW!Microsoft.SystemCenter.DataWarehouse.PublishEventData" /></WriteActions></Rule><Rule ID="Microsoft.SystemCenter.ACS.Collector.EventStreamGap" Enabled="true" Target="Microsoft.SystemCenter.ACS.Collector" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100"><Category>Alert</Category><DataSources><DataSource ID="DS"
TypeID="Windows!Microsoft.Windows.EventProvider"><ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName><LogName>Operations Manager</LogName><Expression><And><Expression><SimpleExpression><ValueExpression><XPathQuery Type="UnsignedInteger">EventDisplayNumber</XPathQuery></ValueExpression><Operator>Equal</Operator><ValueExpression><Value Type="UnsignedInteger">4635</Value></ValueExpression></SimpleExpression></Expression><Expression><SimpleExpression><ValueExpression><XPathQuery Type="String">PublisherName</XPathQuery></ValueExpression><Operator>Equal</Operator><ValueExpression><Value Type="String">AdtServer</Value></ValueExpression></SimpleExpression></Expression></And></Expression></DataSource></DataSources><WriteActions><WriteAction ID="Alert" TypeID="Health!System.Health.GenerateAlert"><Priority>1</Priority><Severity>1</Severity><AlertName /><AlertDescription /><AlertOwner
/><AlertMessageId>$MPElement[Name="Microsoft.SystemCenter.ACS.Collector.EventStreamGap.AlertMessage"]$</AlertMessageId><AlertParameters><AlertParameter1>$Data/Params/Param[1]$</AlertParameter1></AlertParameters><Suppression><SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue><SuppressionValue>$Data/PublisherName$</SuppressionValue><SuppressionValue>$Data/LoggingComputer$</SuppressionValue><SuppressionValue>$Data/Params/Param[1]$</SuppressionValue></Suppression><Custom1>$Data/Params/Param[1]$</Custom1><Custom2 /><Custom3 /><Custom4 /><Custom5 /><Custom6 /><Custom7 /><Custom8 /><Custom9 /><Custom10 /></WriteAction></WriteActions></Rule><Rule ID="Microsoft.SystemCenter.ACS.Collector.ForwarderDisconnected" Enabled="true" Target="Microsoft.SystemCenter.ACS.Collector" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100"><Category>Alert</Category><DataSources><DataSource ID="DS"
TypeID="Windows!Microsoft.Windows.EventProvider"><ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName><LogName>Operations Manager</LogName><Expression><And><Expression><SimpleExpression><ValueExpression><XPathQuery Type="UnsignedInteger">EventDisplayNumber</XPathQuery></ValueExpression><Operator>Equal</Operator><ValueExpression><Value Type="UnsignedInteger">4631</Value></ValueExpression></SimpleExpression></Expression><Expression><SimpleExpression><ValueExpression><XPathQuery Type="String">PublisherName</XPathQuery></ValueExpression><Operator>Equal</Operator><ValueExpression><Value Type="String">AdtServer</Value></ValueExpression></SimpleExpression></Expression></And></Expression></DataSource></DataSources><WriteActions><WriteAction ID="Alert" TypeID="Health!System.Health.GenerateAlert"><Priority>1</Priority><Severity>1</Severity><AlertName /><AlertDescription /><AlertOwner
/><AlertMessageId>$MPElement[Name="Microsoft.SystemCenter.ACS.Collector.ForwarderDisconnected.AlertMessage"]$</AlertMessageId><AlertParameters><AlertParameter1>$Data/Params/Param[1]$</AlertParameter1></AlertParameters><Suppression><SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue><SuppressionValue>$Data/PublisherName$</SuppressionValue><SuppressionValue>$Data/LoggingComputer$</SuppressionValue><SuppressionValue>$Data/Params/Param[1]$</SuppressionValue></Suppression><Custom1>$Data/Params/Param[1]$</Custom1><Custom2 /><Custom3 /><Custom4 /><Custom5 /><Custom6 /><Custom7 /><Custom8 /><Custom9 /><Custom10 /></WriteAction></WriteActions></Rule><Rule ID="Microsoft.SystemCenter.ACS.Collector.ForwarderRejected" Enabled="true" Target="Microsoft.SystemCenter.ACS.Collector" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100"><Category>Alert</Category><DataSources><DataSource ID="DS"
TypeID="Windows!Microsoft.Windows.EventProvider"><ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName><LogName>Operations Manager</LogName><Expression><And><Expression><SimpleExpression><ValueExpression><XPathQuery Type="UnsignedInteger">EventDisplayNumber</XPathQuery></ValueExpression><Operator>Equal</Operator><ValueExpression><Value Type="UnsignedInteger">4636</Value></ValueExpression></SimpleExpression></Expression><Expression><SimpleExpression><ValueExpression><XPathQuery Type="String">PublisherName</XPathQuery></ValueExpression><Operator>Equal</Operator><ValueExpression><Value Type="String">AdtServer</Value></ValueExpression></SimpleExpression></Expression></And></Expression></DataSource></DataSources><WriteActions><WriteAction ID="Alert" TypeID="Health!System.Health.GenerateAlert"><Priority>1</Priority><Severity>1</Severity><AlertOwner
/><AlertMessageId>$MPElement[Name="Microsoft.SystemCenter.ACS.Collector.ForwarderRejected.AlertMessage"]$</AlertMessageId><AlertParameters><AlertParameter1>$Data/Params/Param[1]$</AlertParameter1><AlertParameter2>$Data/Params/Param[4]$</AlertParameter2></AlertParameters><Suppression><SuppressionValue>$Data/EventDisplayNumber$</SuppressionValue><SuppressionValue>$Data/LoggingComputer$</SuppressionValue><SuppressionValue>$Data/Params/Param[1]$</SuppressionValue><SuppressionValue>$Data/Params/Param[4]$</SuppressionValue></Suppression><Custom1>$Data/Params/Param[1]$</Custom1><Custom2>$Data/Params/Param[4]$</Custom2><Custom3 /><Custom4 /><Custom5 /><Custom6 /><Custom7 /><Custom8 /><Custom9 /><Custom10 /></WriteAction></WriteActions></Rule><Rule ID="Microsoft.SystemCenter.ACS.Forwarder.EventCollection" Enabled="true" Target="Microsoft.SystemCenter.ACS.Forwarder" ConfirmDelivery="true" Remotable="true" Priority="Normal"
DiscardLevel="100"><Category>EventCollection</Category><DataSources><DataSource ID="DS" TypeID="Windows!Microsoft.Windows.EventProvider"><ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName><LogName>Operations Manager</LogName><Expression><SimpleExpression><ValueExpression><XPathQuery Type="String">PublisherName</XPathQuery></ValueExpression><Operator>Equal</Operator><ValueExpression><Value Type="String">AdtAgent</Value></ValueExpression></SimpleExpression></Expression></DataSource></DataSources><WriteActions><WriteAction ID="WriteToDB" TypeID="SCLibrary!Microsoft.SystemCenter.CollectEvent" /><WriteAction ID="WriteToDW" TypeID="SCDW!Microsoft.SystemCenter.DataWarehouse.PublishEventData" /></WriteActions></Rule><Rule ID="Microsoft.SystemCenter.ACS.Forwarder.HandleCountThreshold" Enabled="true" Target="Microsoft.SystemCenter.ACS.Forwarder" ConfirmDelivery="false" Remotable="false" Priority="High"
DiscardLevel="100"><Category>Maintenance</Category><DataSources><DataSource ID="DataSource" TypeID="Performance!System.Performance.DataProvider"><CounterName>Handle Count</CounterName><ObjectName>Process</ObjectName><InstanceName>adtagent*</InstanceName><Frequency>120</Frequency></DataSource></DataSources><ConditionDetection ID="CDAveragerThreshold" TypeID="Performance!System.Performance.AverageThresholdCondition"><NumSamples>5</NumSamples><Threshold>2000</Threshold><Operator>Greater</Operator></ConditionDetection><WriteActions><WriteAction ID="RestartService" TypeID="Microsoft.SystemCenter.ACS.RestartACSForwarderAction"><EventId>6025</EventId><EventType>Warning</EventType><RestartReason>ACS Forwarder exceeded Process\Handle Count threshhold.</RestartReason></WriteAction></WriteActions></Rule><Rule ID="Microsoft.SystemCenter.ACS.Forwarder.PrivateBytesThreshold" Enabled="true" Target="Microsoft.SystemCenter.ACS.Forwarder" ConfirmDelivery="false" Remotable="false" Priority="High"
DiscardLevel="100"><Category>Maintenance</Category><DataSources><DataSource ID="DataSource" TypeID="Performance!System.Performance.DataProvider"><CounterName>Private Bytes</CounterName><ObjectName>Process</ObjectName><InstanceName>adtagent*</InstanceName><Frequency>120</Frequency></DataSource></DataSources><ConditionDetection ID="CDAveragerThreshold" TypeID="Performance!System.Performance.AverageThresholdCondition"><NumSamples>5</NumSamples><Threshold>104857600</Threshold><Operator>Greater</Operator></ConditionDetection><WriteActions><WriteAction ID="RestartService" TypeID="Microsoft.SystemCenter.ACS.RestartACSForwarderAction"><EventId>6026</EventId><EventType>Warning</EventType><RestartReason>ACS Forwarder exceeded Process\Private Bytes threshhold.</RestartReason></WriteAction></WriteActions></Rule></Rules><Tasks><Task ID="Microsoft.SystemCenter.DisableAuditCollectionService" Accessibility="Internal" Enabled="true" Target="SCLibrary!Microsoft.SystemCenter.HealthService" Timeout="300"
Remotable="true"><Category>Maintenance</Category><WriteAction ID="SCAction" RunAs="System!System.PrivilegedMonitoringAccount" TypeID="Microsoft.SystemCenter.DisableACSAction" /></Task><Task ID="Microsoft.SystemCenter.EnableAuditCollectionService" Accessibility="Internal" Enabled="true" Target="SCLibrary!Microsoft.SystemCenter.HealthService" Timeout="300" Remotable="true"><Category>Maintenance</Category><WriteAction ID="SCAction" RunAs="System!System.PrivilegedMonitoringAccount" TypeID="Microsoft.SystemCenter.EnableACSAction"><CollectorServer>[Collector Server]</CollectorServer><TargetComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</TargetComputerName></WriteAction></Task><Task ID="Microsoft.SystemCenter.StartACSService" Accessibility="Internal" Enabled="true" Target="SCLibrary!Microsoft.SystemCenter.HealthService" Timeout="300" Remotable="false"><Category>Maintenance</Category><WriteAction ID="WA"
TypeID="System!System.CommandExecuter"><ApplicationName /><WorkingDirectory /><CommandLine>net start AdtAgent</CommandLine><TimeoutSeconds>60</TimeoutSeconds><RequireOutput>true</RequireOutput><Files /></WriteAction></Task></Tasks><Monitors><AggregateMonitor ID="Microsoft.SystemCenter.ACS.Collector.AvailabilityHealthRollup" Accessibility="Internal" Enabled="true" Target="Microsoft.SystemCenter.ACS.Collector" ParentMonitorID="Health!System.Health.AvailabilityState" Remotable="true" Priority="Normal"><Category>StateCollection</Category><Algorithm>WorstOf</Algorithm></AggregateMonitor><AggregateMonitor ID="Microsoft.SystemCenter.ACS.Forwarder.AvailabilityHealthRollup" Accessibility="Internal" Enabled="true" Target="Microsoft.SystemCenter.ACS.Forwarder" ParentMonitorID="Health!System.Health.AvailabilityState" Remotable="true" Priority="Normal"><Category>StateCollection</Category><Algorithm>WorstOf</Algorithm></AggregateMonitor><AggregateMonitor
ID="Microsoft.SystemCenter.AgentManager.ConfigHealthRollup" Comment="Roll-up monitor for Agent Manager" Accessibility="Internal" Enabled="true" Target="SCLibrary!Microsoft.SystemCenter.AgentManager" ParentMonitorID="Health!System.Health.ConfigurationState" Remotable="true" Priority="Normal"><Category>ConfigurationHealth</Category><Algorithm>WorstOf</Algorithm></AggregateMonitor><AggregateMonitor ID="Microsoft.SystemCenter.AuditCollectionService.AvailabilityHealthRollup" Comment="Roll-up monitor for AuditCollectionService" Accessibility="Internal" Enabled="true" Target="SCLibrary!Microsoft.SystemCenter.HealthService" ParentMonitorID="Health!System.Health.AvailabilityState" Remotable="true" Priority="Normal"><Category>StateCollection</Category><Algorithm>WorstOf</Algorithm></AggregateMonitor><UnitMonitor ID="Microsoft.SystemCenter.ACS.Collector.AcceptingNewClientConnections" Accessibility="Internal" Enabled="true" Target="Microsoft.SystemCenter.ACS.Collector"
ParentMonitorID="Microsoft.SystemCenter.ACS.Collector.AvailabilityHealthRollup" Remotable="true" Priority="Normal" TypeID="Windows!Microsoft.Windows.2SingleEventLog2StateMonitorType" ConfirmDelivery="true"><Category>AvailabilityHealth</Category><OperationalStates><OperationalState ID="AcceptingNewClientConnections" MonitorTypeStateID="SecondEventRaised" HealthState="Success" /><OperationalState ID="RejectingNewClientConnections" MonitorTypeStateID="FirstEventRaised" HealthState="Warning" /></OperationalStates><Configuration><FirstComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</FirstComputerName><FirstLogName>Operations Manager</FirstLogName><FirstExpression><And><Expression><SimpleExpression><ValueExpression><XPathQuery Type="UnsignedInteger">EventDisplayNumber</XPathQuery></ValueExpression><Operator>Equal</Operator><ValueExpression><Value
Type="UnsignedInteger">4614</Value></ValueExpression></SimpleExpression></Expression><Expression><SimpleExpression><ValueExpression><XPathQuery Type="String">PublisherName</XPathQuery></ValueExpression><Operator>Equal</Operator><ValueExpression><Value Type="String">AdtServer</Value></ValueExpression></SimpleExpression></Expression></And></FirstExpression><SecondComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</SecondComputerName><SecondLogName>Operations Manager</SecondLogName><SecondExpression><And><Expression><SimpleExpression><ValueExpression><XPathQuery Type="UnsignedInteger">EventDisplayNumber</XPathQuery></ValueExpression><Operator>Equal</Operator><ValueExpression><Value Type="UnsignedInteger">4613</Value></ValueExpression></SimpleExpression></Expression><Expression><SimpleExpression><ValueExpression><XPathQuery Type="String">PublisherName</XPathQuery></ValueExpression><Operator>Equal</Operator><ValueExpression><Value
Type="String">AdtServer</Value></ValueExpression></SimpleExpression></Expression></And></SecondExpression></Configuration></UnitMonitor><UnitMonitor ID="Microsoft.SystemCenter.ACS.Collector.DBConnectionState" Accessibility="Internal" Enabled="true" Target="Microsoft.SystemCenter.ACS.Collector" ParentMonitorID="Microsoft.SystemCenter.ACS.Collector.AvailabilityHealthRollup" Remotable="true" Priority="Normal" TypeID="Windows!Microsoft.Windows.2SingleEventLog2StateMonitorType" ConfirmDelivery="true"><Category>AvailabilityHealth</Category><OperationalStates><OperationalState ID="DBConnectionEstablished" MonitorTypeStateID="SecondEventRaised" HealthState="Success" /><OperationalState ID="DBConnectionError" MonitorTypeStateID="FirstEventRaised" HealthState="Error" /></OperationalStates><Configuration><FirstComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</FirstComputerName><FirstLogName>Operations
Manager</FirstLogName><FirstExpression><And><Expression><SimpleExpression><ValueExpression><XPathQuery Type="UnsignedInteger">EventDisplayNumber</XPathQuery></ValueExpression><Operator>Equal</Operator><ValueExpression><Value Type="UnsignedInteger">4618</Value></ValueExpression></SimpleExpression></Expression><Expression><SimpleExpression><ValueExpression><XPathQuery Type="Integer">EventLevel</XPathQuery></ValueExpression><Operator>Equal</Operator><ValueExpression><Value Type="UnsignedInteger">1</Value></ValueExpression></SimpleExpression></Expression><Expression><SimpleExpression><ValueExpression><XPathQuery Type="String">PublisherName</XPathQuery></ValueExpression><Operator>Equal</Operator><ValueExpression><Value Type="String">AdtServer</Value></ValueExpression></SimpleExpression></Expression></And></FirstExpression><SecondComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</SecondComputerName><SecondLogName>Operations
Manager</SecondLogName><SecondExpression><And><Expression><SimpleExpression><ValueExpression><XPathQuery Type="UnsignedInteger">EventDisplayNumber</XPathQuery></ValueExpression><Operator>Equal</Operator><ValueExpression><Value Type="UnsignedInteger">4616</Value></ValueExpression></SimpleExpression></Expression><Expression><SimpleExpression><ValueExpression><XPathQuery Type="String">PublisherName</XPathQuery></ValueExpression><Operator>Equal</Operator><ValueExpression><Value Type="String">AdtServer</Value></ValueExpression></SimpleExpression></Expression></And></SecondExpression></Configuration></UnitMonitor><UnitMonitor ID="Microsoft.SystemCenter.ACS.Collector.MaintainingClientConnections" Accessibility="Internal" Enabled="true" Target="Microsoft.SystemCenter.ACS.Collector" ParentMonitorID="Microsoft.SystemCenter.ACS.Collector.AvailabilityHealthRollup" Remotable="true" Priority="Normal" TypeID="Windows!Microsoft.Windows.2SingleEventLog2StateMonitorType"
ConfirmDelivery="true"><Category>AvailabilityHealth</Category><OperationalStates><OperationalState ID="AcceptingNewClientConnections" MonitorTypeStateID="SecondEventRaised" HealthState="Success" /><OperationalState ID="DisconnectingClientConnections" MonitorTypeStateID="FirstEventRaised" HealthState="Error" /></OperationalStates><Configuration><FirstComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</FirstComputerName><FirstLogName>Operations Manager</FirstLogName><FirstExpression><And><Expression><SimpleExpression><ValueExpression><XPathQuery Type="UnsignedInteger">EventDisplayNumber</XPathQuery></ValueExpression><Operator>Equal</Operator><ValueExpression><Value Type="UnsignedInteger">4615</Value></ValueExpression></SimpleExpression></Expression><Expression><SimpleExpression><ValueExpression><XPathQuery Type="String">PublisherName</XPathQuery></ValueExpression><Operator>Equal</Operator><ValueExpression><Value
Type="String">AdtServer</Value></ValueExpression></SimpleExpression></Expression></And></FirstExpression><SecondComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</SecondComputerName><SecondLogName>Operations Manager</SecondLogName><SecondExpression><And><Expression><SimpleExpression><ValueExpression><XPathQuery Type="UnsignedInteger">EventDisplayNumber</XPathQuery></ValueExpression><Operator>Equal</Operator><ValueExpression><Value Type="UnsignedInteger">4613</Value></ValueExpression></SimpleExpression></Expression><Expression><SimpleExpression><ValueExpression><XPathQuery Type="String">PublisherName</XPathQuery></ValueExpression><Operator>Equal</Operator><ValueExpression><Value Type="String">AdtServer</Value></ValueExpression></SimpleExpression></Expression></And></SecondExpression></Configuration></UnitMonitor><UnitMonitor ID="Microsoft.SystemCenter.ACS.Collector.ServiceStateMonitor" Accessibility="Public" Enabled="true"
Target="Microsoft.SystemCenter.ACS.Collector" ParentMonitorID="Microsoft.SystemCenter.ACS.Collector.AvailabilityHealthRollup" Remotable="true" Priority="Normal" TypeID="Windows!Microsoft.Windows.CheckNTServiceStateMonitorType" ConfirmDelivery="false"><Category>AvailabilityHealth</Category><AlertSettings AlertMessage="Microsoft.SystemCenter.ACS.Collector.ServiceStateMonitor.AlertMessage"><AlertOnState>Error</AlertOnState><AutoResolve>true</AutoResolve><AlertPriority>Low</AlertPriority><AlertSeverity>Error</AlertSeverity><AlertParameters><AlertParameter1>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</AlertParameter1></AlertParameters></AlertSettings><OperationalStates><OperationalState ID="Success" MonitorTypeStateID="Running" HealthState="Success" /><OperationalState ID="Error" MonitorTypeStateID="NotRunning" HealthState="Error" /></OperationalStates><Configuration><ComputerName
/><ServiceName>adtserver</ServiceName><CheckStartupType>false</CheckStartupType></Configuration></UnitMonitor><UnitMonitor ID="Microsoft.SystemCenter.ACS.Forwarder.ServiceStateMonitor" Accessibility="Public" Enabled="true" Target="Microsoft.SystemCenter.ACS.Forwarder" ParentMonitorID="Microsoft.SystemCenter.ACS.Forwarder.AvailabilityHealthRollup" Remotable="true" Priority="Normal" TypeID="Windows!Microsoft.Windows.CheckNTServiceStateMonitorType" ConfirmDelivery="false"><Category>AvailabilityHealth</Category><AlertSettings AlertMessage="Microsoft.SystemCenter.ACS.Forwarder.ServiceStateMonitor.AlertMessage"><AlertOnState>Error</AlertOnState><AutoResolve>true</AutoResolve><AlertPriority>Low</AlertPriority><AlertSeverity>Error</AlertSeverity><AlertParameters><AlertParameter1>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</AlertParameter1></AlertParameters></AlertSettings><OperationalStates><OperationalState ID="Success" MonitorTypeStateID="Running"
HealthState="Success" /><OperationalState ID="Error" MonitorTypeStateID="NotRunning" HealthState="Error" /></OperationalStates><Configuration><ComputerName /><ServiceName>adtagent</ServiceName><CheckStartupType>true</CheckStartupType></Configuration></UnitMonitor><UnitMonitor ID="Microsoft.SystemCenter.ACS.Forwarder.UnableToConnectToCollector" Accessibility="Internal" Enabled="true" Target="Microsoft.SystemCenter.ACS.Forwarder" ParentMonitorID="Microsoft.SystemCenter.ACS.Forwarder.AvailabilityHealthRollup" Remotable="true" Priority="Normal" TypeID="Windows!Microsoft.Windows.2SingleEventLog2StateMonitorType" ConfirmDelivery="true"><Category>AvailabilityHealth</Category><OperationalStates><OperationalState ID="SuccessfullyConnectedToCollector" MonitorTypeStateID="SecondEventRaised" HealthState="Success" /><OperationalState ID="FailedConnectingToCollector" MonitorTypeStateID="FirstEventRaised" HealthState="Warning"
/></OperationalStates><Configuration><FirstComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</FirstComputerName><FirstLogName>Operations Manager</FirstLogName><FirstExpression><And><Expression><SimpleExpression><ValueExpression><XPathQuery Type="UnsignedInteger">EventDisplayNumber</XPathQuery></ValueExpression><Operator>Equal</Operator><ValueExpression><Value Type="UnsignedInteger">4369</Value></ValueExpression></SimpleExpression></Expression><Expression><SimpleExpression><ValueExpression><XPathQuery Type="String">PublisherName</XPathQuery></ValueExpression><Operator>Equal</Operator><ValueExpression><Value Type="String">AdtAgent</Value></ValueExpression></SimpleExpression></Expression></And></FirstExpression><SecondComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</SecondComputerName><SecondLogName>Operations
Manager</SecondLogName><SecondExpression><And><Expression><SimpleExpression><ValueExpression><XPathQuery Type="UnsignedInteger">EventDisplayNumber</XPathQuery></ValueExpression><Operator>Equal</Operator><ValueExpression><Value Type="UnsignedInteger">4368</Value></ValueExpression></SimpleExpression></Expression><Expression><SimpleExpression><ValueExpression><XPathQuery Type="String">PublisherName</XPathQuery></ValueExpression><Operator>Equal</Operator><ValueExpression><Value Type="String">AdtAgent</Value></ValueExpression></SimpleExpression></Expression></And></SecondExpression></Configuration></UnitMonitor><UnitMonitor ID="Microsoft.SystemCenter.AuditCollectionService.Forwarder.ServiceMonitor" Accessibility="Internal" Enabled="true" Target="SCLibrary!Microsoft.SystemCenter.Agent" ParentMonitorID="Microsoft.SystemCenter.AuditCollectionService.AvailabilityHealthRollup" Remotable="true" Priority="Normal" TypeID="Windows!Microsoft.Windows.CheckNTServiceStateMonitorType"
ConfirmDelivery="true"><Category>StateCollection</Category><OperationalStates><OperationalState ID="Running" MonitorTypeStateID="Running" HealthState="Success" /><OperationalState ID="NotRunning" MonitorTypeStateID="NotRunning" HealthState="Error" /></OperationalStates><Configuration><ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName><ServiceName>AdtAgent</ServiceName></Configuration></UnitMonitor><DependencyMonitor ID="Microsoft.SystemCenter.AuditCollectionServiceGroup.DependOnACS.Collector.AvailabilityRollup" Accessibility="Public" Enabled="true" Target="Microsoft.SystemCenter.AuditCollectionService.Group" ParentMonitorID="Health!System.Health.AvailabilityState" Remotable="true" Priority="Normal" RelationshipType="Microsoft.SystemCenter.AuditCollectionServiceGroup.ContainsACS.Collector"
MemberMonitor="Health!System.Health.AvailabilityState"><Category>AvailabilityHealth</Category><Algorithm>WorstOf</Algorithm><MemberUnAvailable>Error</MemberUnAvailable></DependencyMonitor><DependencyMonitor ID="Microsoft.Windows.Computer.DependOnACS.Collector.AvailabilityRollup" Accessibility="Public" Enabled="true" Target="Windows!Microsoft.Windows.Computer" ParentMonitorID="Health!System.Health.AvailabilityState" Remotable="true" Priority="Normal" RelationshipType="Microsoft.Windows.Computer.Hosts.Microsoft.SystemCenter.ACS.Collector" MemberMonitor="Health!System.Health.AvailabilityState"><Category>AvailabilityHealth</Category><Algorithm>WorstOf</Algorithm><MemberUnAvailable>Error</MemberUnAvailable></DependencyMonitor></Monitors></Monitoring><Presentation><Views><View ID="Microsoft.SystemCenter.ACS.Collector.EventView" Accessibility="Internal" Enabled="true" Target="Microsoft.SystemCenter.ACS.Collector" TypeID="SCLibrary!Microsoft.SystemCenter.EventViewType"
Visible="true"><Category>Operations</Category><Criteria><PublisherName>AdtServer</PublisherName></Criteria><Presentation><ColumnInfo Index="0" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="false" Visible="true" SortOrder="Ascending"><Name>Level</Name><Id>LevelId</Id></ColumnInfo><ColumnInfo Index="1" SortIndex="0" Width="100" Grouped="false" Sorted="true" IsSortable="true" Visible="true" SortOrder="Descending"><Name>Date and Time</Name><Id>TimeGenerated</Id></ColumnInfo><ColumnInfo Index="2" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="true" SortOrder="Ascending"><Name>Source</Name><Id>PublisherName</Id></ColumnInfo><ColumnInfo Index="3" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="true" SortOrder="Ascending"><Name>Name</Name><Id>MonitoringObjectName</Id></ColumnInfo><ColumnInfo Index="4" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="false"
SortOrder="Ascending"><Name>User</Name><Id>User</Id></ColumnInfo><ColumnInfo Index="5" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="true" SortOrder="Ascending"><Name>Event Number</Name><Id>Number</Id></ColumnInfo><ColumnInfo Index="6" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="false" SortOrder="Ascending"><Name>Log Name</Name><Id>Channel</Id></ColumnInfo><ColumnInfo Index="7" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="true" SortOrder="Ascending"><Name>Logging Computer</Name><Id>LoggingComputer</Id></ColumnInfo></Presentation><Target /></View><View ID="Microsoft.SystemCenter.ACS.Collector.PerformanceView.ConnectedClients" Accessibility="Internal" Enabled="true" Target="Microsoft.SystemCenter.ACS.Collector" TypeID="SCLibrary!Microsoft.SystemCenter.PerformanceViewType" Visible="true"><Category>Operations</Category><Criteria><Object>ACS
Collector</Object><Counter>Connected Clients</Counter></Criteria></View><View ID="Microsoft.SystemCenter.ACS.Collector.PerformanceView.DatabaseQueueBackoffThresholdInPercent" Accessibility="Internal" Enabled="true" Target="Microsoft.SystemCenter.ACS.Collector" TypeID="SCLibrary!Microsoft.SystemCenter.PerformanceViewType" Visible="true"><Category>Operations</Category><Criteria><Object>ACS Collector</Object><Counter>Database Queue Backoff Threshold in %</Counter></Criteria></View><View ID="Microsoft.SystemCenter.ACS.Collector.PerformanceView.DatabaseQueueDisconnectThresholdInPercent" Accessibility="Internal" Enabled="true" Target="Microsoft.SystemCenter.ACS.Collector" TypeID="SCLibrary!Microsoft.SystemCenter.PerformanceViewType" Visible="true"><Category>Operations</Category><Criteria><Object>ACS Collector</Object><Counter>Database Queue Disconnect Threshold in %</Counter></Criteria></View><View ID="Microsoft.SystemCenter.ACS.Collector.PerformanceView.DatabaseQueuePercentFull"
Accessibility="Internal" Enabled="true" Target="Microsoft.SystemCenter.ACS.Collector" TypeID="SCLibrary!Microsoft.SystemCenter.PerformanceViewType" Visible="true"><Category>Operations</Category><Criteria><Object>ACS Collector</Object><Counter>Database Queue % Full</Counter></Criteria></View><View ID="Microsoft.SystemCenter.ACS.Collector.PerformanceView.DBLoaderEventInsertsPerSecond" Accessibility="Internal" Enabled="true" Target="Microsoft.SystemCenter.ACS.Collector" TypeID="SCLibrary!Microsoft.SystemCenter.PerformanceViewType" Visible="true"><Category>Operations</Category><Criteria><Object>ACS Collector</Object><Counter>DB Loader Event Inserts/sec</Counter></Criteria></View><View ID="Microsoft.SystemCenter.ACS.Collector.PerformanceView.DBStringCacheHitPercent" Accessibility="Internal" Enabled="true" Target="Microsoft.SystemCenter.ACS.Collector" TypeID="SCLibrary!Microsoft.SystemCenter.PerformanceViewType" Visible="true"><Category>Operations</Category><Criteria><Object>ACS
Collector</Object><Counter>DB String Cache Hit %</Counter></Criteria></View><View ID="Microsoft.SystemCenter.ACS.Collector.PerformanceView.IncomingEventsPerSecond" Accessibility="Internal" Enabled="true" Target="Microsoft.SystemCenter.ACS.Collector" TypeID="SCLibrary!Microsoft.SystemCenter.PerformanceViewType" Visible="true"><Category>Operations</Category><Criteria><Object>ACS Collector</Object><Counter>Incoming Events/sec</Counter></Criteria></View><View ID="Microsoft.SystemCenter.ACS.Collector.StateView" Accessibility="Public" Enabled="true" Target="Microsoft.SystemCenter.ACS.Collector" TypeID="SCLibrary!Microsoft.SystemCenter.StateViewType" Visible="true"><Category>Operations</Category><Criteria /><Presentation /></View><View ID="Microsoft.SystemCenter.ACS.Forwarder.EventView" Accessibility="Internal" Enabled="true" Target="Microsoft.SystemCenter.ACS.Forwarder" TypeID="SCLibrary!Microsoft.SystemCenter.EventViewType"
Visible="true"><Category>Operations</Category><Criteria><PublisherName>AdtAgent</PublisherName></Criteria><Presentation><ColumnInfo Index="0" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="false" Visible="true" SortOrder="Ascending"><Name>Level</Name><Id>LevelId</Id></ColumnInfo><ColumnInfo Index="1" SortIndex="0" Width="100" Grouped="false" Sorted="true" IsSortable="true" Visible="true" SortOrder="Descending"><Name>Date and Time</Name><Id>TimeGenerated</Id></ColumnInfo><ColumnInfo Index="2" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="true" SortOrder="Ascending"><Name>Source</Name><Id>PublisherName</Id></ColumnInfo><ColumnInfo Index="3" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="true" SortOrder="Ascending"><Name>Name</Name><Id>MonitoringObjectName</Id></ColumnInfo><ColumnInfo Index="4" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="false"
SortOrder="Ascending"><Name>User</Name><Id>User</Id></ColumnInfo><ColumnInfo Index="5" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="true" SortOrder="Ascending"><Name>Event Number</Name><Id>Number</Id></ColumnInfo><ColumnInfo Index="6" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="false" SortOrder="Ascending"><Name>Log Name</Name><Id>Channel</Id></ColumnInfo><ColumnInfo Index="7" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="true" SortOrder="Ascending"><Name>Logging Computer</Name><Id>LoggingComputer</Id></ColumnInfo></Presentation><Target /></View><View ID="Microsoft.SystemCenter.ACS.Forwarder.StateView" Accessibility="Public" Enabled="true" Target="Microsoft.SystemCenter.ACS.Forwarder" TypeID="SCLibrary!Microsoft.SystemCenter.StateViewType" Visible="true"><Category>Operations</Category><Criteria /><Presentation /></View></Views><Folders><Folder
ID="Microsoft.SystemCenter.ACS.Collector.Performance.ViewFolder.Root" Accessibility="Public" ParentFolder="Microsoft.SystemCenter.ACS.Collector.ViewFolder.Root" /><Folder ID="Microsoft.SystemCenter.ACS.Collector.ViewFolder.Root" Accessibility="Public" ParentFolder="Microsoft.SystemCenter.ACS.ViewFolder.Root" /><Folder ID="Microsoft.SystemCenter.ACS.Forwarder.ViewFolder.Root" Accessibility="Public" ParentFolder="Microsoft.SystemCenter.ACS.ViewFolder.Root" /><Folder ID="Microsoft.SystemCenter.ACS.ViewFolder.Root" Accessibility="Public" ParentFolder="SCLibrary!Microsoft.SystemCenter.Monitoring.ViewFolder.Root" /></Folders><FolderItems><FolderItem ElementID="Microsoft.SystemCenter.ACS.Collector.EventView" ID="Microsoft.SystemCenter.ACS.Collector.EventView" Folder="Microsoft.SystemCenter.ACS.Collector.ViewFolder.Root" /><FolderItem ElementID="Microsoft.SystemCenter.ACS.Collector.PerformanceView.ConnectedClients" ID="Microsoft.SystemCenter.ACS.Collector.PerformanceView.ConnectedClients"
Folder="Microsoft.SystemCenter.ACS.Collector.Performance.ViewFolder.Root" /><FolderItem ElementID="Microsoft.SystemCenter.ACS.Collector.PerformanceView.DatabaseQueueBackoffThresholdInPercent" ID="Microsoft.SystemCenter.ACS.Collector.PerformanceView.DatabaseQueueBackoffThresholdInPercent" Folder="Microsoft.SystemCenter.ACS.Collector.Performance.ViewFolder.Root" /><FolderItem ElementID="Microsoft.SystemCenter.ACS.Collector.PerformanceView.DatabaseQueueDisconnectThresholdInPercent" ID="Microsoft.SystemCenter.ACS.Collector.PerformanceView.DatabaseQueueDisconnectThresholdInPercent" Folder="Microsoft.SystemCenter.ACS.Collector.Performance.ViewFolder.Root" /><FolderItem ElementID="Microsoft.SystemCenter.ACS.Collector.PerformanceView.DatabaseQueuePercentFull" ID="Microsoft.SystemCenter.ACS.Collector.PerformanceView.DatabaseQueuePercentFull" Folder="Microsoft.SystemCenter.ACS.Collector.Performance.ViewFolder.Root" /><FolderItem
ElementID="Microsoft.SystemCenter.ACS.Collector.PerformanceView.DBLoaderEventInsertsPerSecond" ID="Microsoft.SystemCenter.ACS.Collector.PerformanceView.DBLoaderEventInsertsPerSecond" Folder="Microsoft.SystemCenter.ACS.Collector.Performance.ViewFolder.Root" /><FolderItem ElementID="Microsoft.SystemCenter.ACS.Collector.PerformanceView.DBStringCacheHitPercent" ID="Microsoft.SystemCenter.ACS.Collector.PerformanceView.DBStringCacheHitPercent" Folder="Microsoft.SystemCenter.ACS.Collector.Performance.ViewFolder.Root" /><FolderItem ElementID="Microsoft.SystemCenter.ACS.Collector.PerformanceView.IncomingEventsPerSecond" ID="Microsoft.SystemCenter.ACS.Collector.PerformanceView.IncomingEventsPerSecond" Folder="Microsoft.SystemCenter.ACS.Collector.Performance.ViewFolder.Root" /><FolderItem ElementID="Microsoft.SystemCenter.ACS.Collector.StateView" ID="Microsoft.SystemCenter.ACS.Collector.StateView" Folder="Microsoft.SystemCenter.ACS.Collector.ViewFolder.Root" /><FolderItem
ElementID="Microsoft.SystemCenter.ACS.Forwarder.EventView" ID="Microsoft.SystemCenter.ACS.Forwarder.EventView" Folder="Microsoft.SystemCenter.ACS.Forwarder.ViewFolder.Root" /><FolderItem ElementID="Microsoft.SystemCenter.ACS.Forwarder.StateView" ID="Microsoft.SystemCenter.ACS.Forwarder.StateView" Folder="Microsoft.SystemCenter.ACS.Forwarder.ViewFolder.Root" /></FolderItems><ImageReferences><ImageReference ElementID="Microsoft.SystemCenter.ACS.Collector" ImageID="Microsoft.SystemCenter.ACS.Collector.80x80Image" /><ImageReference ElementID="Microsoft.SystemCenter.ACS.Collector" ImageID="Microsoft.SystemCenter.ACS.Collector.16x16Image" /><ImageReference ElementID="Microsoft.SystemCenter.AuditCollectionService.Group" ImageID="Microsoft.SystemCenter.ACS.Collector.80x80Image" /><ImageReference ElementID="Microsoft.SystemCenter.AuditCollectionService.Group" ImageID="Microsoft.SystemCenter.ACS.Collector.16x16Image" /></ImageReferences><StringResources><StringResource
ID="Microsoft.SystemCenter.ACS.Collector.DatabaseOperation.Failure.AlertMessage" /><StringResource ID="Microsoft.SystemCenter.ACS.Collector.EventStreamGap.AlertMessage" /><StringResource ID="Microsoft.SystemCenter.ACS.Collector.ForwarderDisconnected.AlertMessage" /><StringResource ID="Microsoft.SystemCenter.ACS.Collector.ForwarderRejected.AlertMessage" /><StringResource ID="Microsoft.SystemCenter.ACS.Collector.ServiceStateMonitor.AlertMessage" /><StringResource ID="Microsoft.SystemCenter.ACS.Forwarder.ServiceStateMonitor.AlertMessage" /></StringResources></Presentation><LanguagePacks><LanguagePack ID="ENU" IsDefault="true"><DisplayStrings><DisplayString ElementID="Microsoft.SystemCenter.ACS.Collector"><Name>Microsoft Audit Collection Services Collector</Name></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.ACS.Collector.AcceptingNewClientConnections"><Name>Microsoft Audit Collector Service Collector Connection Establishment State</Name><Description>Monitors the ability
of the Microsoft Audit Collector Service Collector to accept new connections</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.ACS.Collector.AcceptingNewClientConnections" SubElementID="AcceptingNewClientConnections"><Name>Microsoft Audit Collector Service Collector Accepting New Connections</Name><Description>The Microsoft Audit Collector Service Collector is accepting new client connections</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.ACS.Collector.AcceptingNewClientConnections" SubElementID="RejectingNewClientConnections"><Name>Microsoft Audit Collector Service Collector Rejecting New Connections</Name><Description>The Microsoft Audit Collector Service Collector is rejecting new client connections due to database queue length</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.ACS.Collector.AvailabilityHealthRollup"><Name>Microsoft Audit Collection Services Collector
Availability</Name></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.ACS.Collector.CollectionRule.Performance.ConnectedClients"><Name>Collect ACS Collector Connected Clients </Name><Description>Collects ACS Collector Connected Clients Performance Counter</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.ACS.Collector.CollectionRule.Performance.DatabaseQueueBackoffThresholdInPercent"><Name>Collect ACS Collector Database Queue Backoff Threshold in %</Name><Description>Collects ACS Collector Database Queue Backoff Threshold in % performance counter</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.ACS.Collector.CollectionRule.Performance.DatabaseQueueDisconnectThresholdInPercent"><Name>Collect ACS Collector Database Queue Disconnect Threshold in %</Name><Description>Collects ACS Collector Database Queue Disconnect Threshold in % performance counter</Description></DisplayString><DisplayString
ElementID="Microsoft.SystemCenter.ACS.Collector.CollectionRule.Performance.DatabaseQueuePercentFull"><Name>Collect ACS Collector Database Queue % Full</Name><Description>Collects ACS Collector Database Queue % Full performance counter</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.ACS.Collector.CollectionRule.Performance.DBLoaderEventInsertsPerSec"><Name>Collect ACS Collector DB Loader Event Inserts/sec</Name><Description>Collects ACS Collector DB Loader Event Inserts/sec performance counter</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.ACS.Collector.CollectionRule.Performance.DBStringCacheHitPercent"><Name>Collect ACS Collector DB String Cache Hit %</Name><Description>Collects ACS Collector DB String Cache Hit % performance counter</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.ACS.Collector.CollectionRule.Performance.IncomingEventsPerSec"><Name>Collect ACS Collector Incoming
Events/sec</Name><Description>Collects ACS Collector Incoming Events/sec performance counter</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.ACS.Collector.DatabaseOperation.Failure"><Name>Microsoft Audit Collection Services Collector Database Operation Failure</Name></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.ACS.Collector.DatabaseOperation.Failure.AlertMessage"><Name>Microsoft Audit Collection Services Collector Database Operation Failure</Name><Description>An error occurred while performing a database operation.  The error code was {0}.</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.ACS.Collector.DBConnectionState"><Name>Microsoft Audit Collector Service Collector Database Connection Establishment State</Name><Description>Monitors the state of the Microsoft Audit Collector Service Collector's connection to its database</Description></DisplayString><DisplayString
ElementID="Microsoft.SystemCenter.ACS.Collector.DBConnectionState" SubElementID="DBConnectionError"><Name>Microsoft Audit Collector Service Collector Error Establishing DataBase Connection</Name><Description>The Microsoft Audit Collector Service Collector encountered an error connecting to the database</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.ACS.Collector.DBConnectionState" SubElementID="DBConnectionEstablished"><Name>Microsoft Audit Collector Service Collector DataBase Connection Established</Name><Description>The Microsoft Audit Collector Service Collector is connected to the database</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.ACS.Collector.Discovery"><Name>Microsoft Audit Collection Services Collector Discovery Rule</Name><Description>This rule discovers the Microsoft Audit Collection Service Collector service</Description></DisplayString><DisplayString
ElementID="Microsoft.SystemCenter.ACS.Collector.EventCollection"><Name>Microsoft Audit Collection Services Collector Event Collection Rule</Name><Description>This rule collects all events associated with the Microsoft Audit Collection Services Collector service</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.ACS.Collector.EventStreamGap"><Name>Microsoft Audit Collection Services Collector Event Stream Gap Detected</Name></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.ACS.Collector.EventStreamGap.AlertMessage"><Name>Microsoft Audit Collection Services Collector Event Stream Gap Detected</Name><Description>Microsoft Audit Collection Services Collector detected a gap in the event stream from Forwarder {0}.</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.ACS.Collector.EventView"><Name>Event View</Name><Description>This displays all events associated with the ACS Collector
Service</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.ACS.Collector.ForwarderDisconnected"><Name>Microsoft Audit Collection Services Collector Forwarder Disconnect</Name><Description>Microsoft Audit Collection Services Collector disconnected Forwarder to due timeout waiting for heartbeat</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.ACS.Collector.ForwarderDisconnected.AlertMessage"><Name>Microsoft Audit Collection Services Forwarder Disconnected Due To Timeout</Name><Description>Microsoft Audit Collection Services Collector disconnected Forwarder {0} due to timeout waiting for Forwarder heartbeat.</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.ACS.Collector.ForwarderRejected"><Name>Microsoft Audit Collection Services Collector Rejected Forwarder</Name><Description>Microsoft Audit Collection Services Collector Rejected Forwarder due to an error</Description></DisplayString><DisplayString
ElementID="Microsoft.SystemCenter.ACS.Collector.ForwarderRejected.AlertMessage"><Name>Microsoft Audit Collection Services Collector Rejected Forwarder</Name><Description>Microsoft Audit Collection Services Collector Rejected Forwarder {0} because of error {1}</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.ACS.Collector.MaintainingClientConnections"><Name>Microsoft Audit Collector Service Collector Connection Maintenance State</Name><Description>Monitors the ability of the Microsoft Audit Collector Service Collector to maintain client connections</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.ACS.Collector.MaintainingClientConnections" SubElementID="AcceptingNewClientConnections"><Name>Microsoft Audit Collector Service Collector Accepting New Connections</Name><Description>The Microsoft Audit Collector Service Collector is accepting new client connections</Description></DisplayString><DisplayString
ElementID="Microsoft.SystemCenter.ACS.Collector.MaintainingClientConnections" SubElementID="DisconnectingClientConnections"><Name>Microsoft Audit Collector Service Collector Disconnecting Client Connections</Name><Description>The Microsoft Audit Collector Service Collector is disconnecting client connections due to database queue length</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.ACS.Collector.Performance.ViewFolder.Root"><Name>Performance</Name></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.ACS.Collector.PerformanceView.ConnectedClients"><Name>Connected Clients</Name></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.ACS.Collector.PerformanceView.DatabaseQueueBackoffThresholdInPercent"><Name>Database Queue Backoff Threshold in %</Name></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.ACS.Collector.PerformanceView.DatabaseQueueDisconnectThresholdInPercent"><Name>Database Queue Disconnect Threshold in
%</Name></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.ACS.Collector.PerformanceView.DatabaseQueuePercentFull"><Name>Database Queue % Full</Name></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.ACS.Collector.PerformanceView.DBLoaderEventInsertsPerSecond"><Name>DB Loader Event Inserts/sec</Name></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.ACS.Collector.PerformanceView.DBStringCacheHitPercent"><Name>DB String Cache Hit %</Name></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.ACS.Collector.PerformanceView.IncomingEventsPerSecond"><Name>Incoming Events/sec</Name></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.ACS.Collector.ServiceStateMonitor"><Name>Microsoft Audit Collection Services Collector Running State</Name><Description>Monitors the current status of the Microsoft Audit Collection Collector service.  An alert from this monitor indicates the Microsoft Audit Collection Service Collector is not
currently running</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.ACS.Collector.ServiceStateMonitor" SubElementID="Error"><Name>Microsoft Audit Collection Services Collector is not running</Name><Description>Microsoft Audit Collection Service Collector is not running</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.ACS.Collector.ServiceStateMonitor" SubElementID="Success"><Name>Microsoft Audit Collection Services Collector is running</Name><Description>Microsoft Audit Collection Service Collector is running</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.ACS.Collector.ServiceStateMonitor.AlertMessage"><Name>Microsoft Audit Collector Service Collector Stopped</Name><Description>The Microsoft Audit Collector service on computer {0} has stopped running</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.ACS.Collector.StateView"><Name>State View</Name><Description>This
monitors the state of the ACS Collector Service</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.ACS.Collector.ViewFolder.Root"><Name>Collector</Name></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.ACS.Forwarder"><Name>Microsoft Audit Collection Services Forwarder</Name></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.ACS.Forwarder.AvailabilityHealthRollup"><Name>Microsoft Audit Collection Services Forwarder Availability</Name></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.ACS.Forwarder.Discovery"><Name>Microsoft Audit Collection Services Forwarder Discovery</Name><Description>This rule discovers the Microsoft Audit Collection Services Forwarder service</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.ACS.Forwarder.DiscoveryDataSource"><Name>Microsoft Audit Collection Services Forwarder Discovery Data Source</Name></DisplayString><DisplayString
ElementID="Microsoft.SystemCenter.ACS.Forwarder.EventCollection"><Name>Microsoft Audit Collection Services Forwarder Event Collection Rule</Name><Description>This displays all events associated with the ACS Forwarder Service</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.ACS.Forwarder.EventView"><Name>Event View</Name></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.ACS.Forwarder.HandleCountThreshold"><Name>Microsoft Audit Collection Services Forwarder Handle Count Monitor</Name></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.ACS.Forwarder.PrivateBytesThreshold"><Name>Microsoft Audit Collection Services Forwarder Private Bytes Monitor</Name></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.ACS.Forwarder.ServiceStateMonitor"><Name>ACS Forwarder Service Running State</Name><Description>Monitors the current status of the Microsoft Audit Collection Service Forwarder.  An alert from this monitor indicates the
Microsoft Audit Collection Service Forwarder is not currently running</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.ACS.Forwarder.ServiceStateMonitor" SubElementID="Error"><Name>Microsoft Audit Collection Services Forwarder is not running</Name><Description>Microsoft Audit Collection Service Forwarder is not running</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.ACS.Forwarder.ServiceStateMonitor" SubElementID="Success"><Name>Microsoft Audit Collection Services Forwarder is running</Name><Description>Microsoft Audit Collection Service Forwarder is running</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.ACS.Forwarder.ServiceStateMonitor.AlertMessage"><Name>Microsoft Audit Collector Service Forwarder Stopped</Name><Description>The Microsoft Audit Collector Service Forwarder on computer {0} has stopped running</Description></DisplayString><DisplayString
ElementID="Microsoft.SystemCenter.ACS.Forwarder.StateView"><Name>State View</Name><Description>This monitors the state of the ACS Forwarder Service</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.ACS.Forwarder.UnableToConnectToCollector"><Name>ACS Forwarder Unable to Connect to Collector</Name><Description>This monitor checks if the ACS Forwarder service is able to connect to the collector.</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.ACS.Forwarder.UnableToConnectToCollector" SubElementID="FailedConnectingToCollector"><Name>Failed Connecting to Collector</Name></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.ACS.Forwarder.UnableToConnectToCollector" SubElementID="SuccessfullyConnectedToCollector"><Name>Successfully connected to Collector</Name></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.ACS.Forwarder.ViewFolder.Root"><Name>Forwarder</Name></DisplayString><DisplayString
ElementID="Microsoft.SystemCenter.ACS.Internal"><Name>Microsoft Audit Collection Services</Name></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.ACS.RestartACSForwarderAction"><Name>Restart Microsoft Audit Collection Services Forwarder</Name></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.ACS.ViewFolder.Root"><Name>Microsoft Audit Collection Services</Name></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.AuditCollectionService.AvailabilityHealthRollup"><Name>Audit Collection Availability</Name><Description>Audit Collection Availability roll up monitor.</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.AuditCollectionService.Forwarder.ServiceMonitor"><Name>Audit Collection Forwarder - Windows Service</Name><Description>This monitor checks the state of the ACS forwarder windows service.</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.AuditCollectionService.Forwarder.ServiceMonitor"
SubElementID="NotRunning"><Name>Service Not Running</Name></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.AuditCollectionService.Forwarder.ServiceMonitor" SubElementID="Running"><Name>Service Running</Name></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.DisableACSAction"><Name>Disable ACS Write Action</Name><Description>Disables the ACS Service.</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.DisableAuditCollectionService"><Name>Disable Audit Collection</Name><Description>Stops and disables the Audit Collection Service on the appropriate Operations Manager Health Service.</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.EnableACSAction"><Name>Enable ACS Write Action</Name><Description>Enable ACS Service.</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.EnableACSAction" SubElementID="CollectorServer"><Name>Collector Server</Name></DisplayString><DisplayString
ElementID="Microsoft.SystemCenter.EnableAuditCollectionService"><Name>Enable Audit Collection</Name><Description>Enables and configures the Audit Collection Service on the appropriate Operations Manager Health Service.</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.StartACSService"><Name>Start Audit Collection</Name><Description>Starts the Audit Collection Service on the appropriate Operations Manager Health Service.</Description></DisplayString><DisplayString ElementID="Microsoft.Windows.Computer.Hosts.Microsoft.SystemCenter.ACS.Collector"><Name>Microsoft Windows Computer Hosts Microsoft Audit Collection Services Collector</Name></DisplayString><DisplayString ElementID="Microsoft.Windows.Computer.Hosts.Microsoft.SystemCenter.ACS.Forwarder"><Name>Microsoft Windows Computer Hosts Microsoft Audit Collection Services Forwarder</Name></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.AuditCollectionService.Group"><Name>Audit Collection
Services</Name><Description>This group represents the health of the Operations Manager Audit Collection Services function. It contains all instances of the audit collection service.</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.AuditCollectionServiceGroup.ContainsACS.Collector"><Name>Audit Collection Services Contains ACS Collector</Name><Description>This is the relationship between Audit Collection Services and ACS Collectors.</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.ManagementGroup.ContainsAuditCollectionServiceGroup"><Name>Management Group Contains Audit Collection Services</Name><Description>This is the relationship between MG and ACS group.</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.ACSGroupPopulator"><Name>Audit Collection Services Contains Audit Collector Discovery</Name><Description>Discovery rule that populates ACS Group.</Description></DisplayString><DisplayString
ElementID="Microsoft.SystemCenter.ManagementGroup.ContainsAuditCollectionServiceGroupRelationship"><Name>Management Group contains Audit Collection Services Discovery</Name><Description>Discovery rule that populates relationship between MG and ACS Group.</Description></DisplayString><DisplayString ElementID="Microsoft.SystemCenter.AuditCollectionServiceGroup.DependOnACS.Collector.AvailabilityRollup"><Name>Audit Collection Services Depends on AC Service</Name><Description>This monitor rolls up healths from AC Service instances contained in the Group.</Description></DisplayString><DisplayString ElementID="Microsoft.Windows.Computer.DependOnACS.Collector.AvailabilityRollup"><Name>Microsoft Windows Computer Depends on Audit Collection Service</Name><Description>This monitor rolls up healths from Audit Collection Service contained in the Windows Computer.</Description></DisplayString></DisplayStrings><KnowledgeArticles><KnowledgeArticle
ElementID="Microsoft.SystemCenter.ACS.Collector.CollectionRule.Performance.ConnectedClients" Visible="true"><MamlContent><maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10"><maml:title>Summary</maml:title><maml:para>This rule collects ACS Collector “Connected Clients” performance data that will be used in either reporting or a view.</maml:para></maml:section></MamlContent></KnowledgeArticle><KnowledgeArticle ElementID="Microsoft.SystemCenter.ACS.Collector.CollectionRule.Performance.DatabaseQueueBackoffThresholdInPercent" Visible="true"><MamlContent><maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10"><maml:title>Summary</maml:title><maml:para>This rule collects ACS Collector “Database Queue Backoff Threshold in %” performance data that will be used in either reporting or a view.</maml:para></maml:section></MamlContent></KnowledgeArticle><KnowledgeArticle
ElementID="Microsoft.SystemCenter.ACS.Collector.CollectionRule.Performance.DatabaseQueueDisconnectThresholdInPercent" Visible="true"><MamlContent><maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10"><maml:title>Summary</maml:title><maml:para>This rule collects ACS Collector “Database Queue Disconnect Threshold in %” performance data that will be used in either reporting or a view.</maml:para></maml:section></MamlContent></KnowledgeArticle><KnowledgeArticle ElementID="Microsoft.SystemCenter.ACS.Collector.CollectionRule.Performance.DatabaseQueuePercentFull" Visible="true"><MamlContent><maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10"><maml:title>Summary</maml:title><maml:para>This rule collects ACS Collector “Database Queue % Full” performance data that will be used in either reporting or a view.</maml:para></maml:section></MamlContent></KnowledgeArticle><KnowledgeArticle
ElementID="Microsoft.SystemCenter.ACS.Collector.CollectionRule.Performance.DBLoaderEventInsertsPerSec" Visible="true"><MamlContent><maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10"><maml:title>Summary</maml:title><maml:para>This rule collects ACS Collector “DB Loader Event Inserts/sec” performance data that will be used in either reporting or a view.</maml:para></maml:section></MamlContent></KnowledgeArticle><KnowledgeArticle ElementID="Microsoft.SystemCenter.ACS.Collector.CollectionRule.Performance.DBStringCacheHitPercent" Visible="true"><MamlContent><maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10"><maml:title>Summary</maml:title><maml:para>This rule collects ACS Collector “DB String Cache Hit %” performance data that will be used in either reporting or a view.</maml:para></maml:section></MamlContent></KnowledgeArticle><KnowledgeArticle ElementID="Microsoft.SystemCenter.ACS.Collector.CollectionRule.Performance.IncomingEventsPerSec"
Visible="true"><MamlContent><maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10"><maml:title>Summary</maml:title><maml:para>This rule collects ACS Collector “DB String Cache Hit %” performance data that will be used in either reporting or a view.</maml:para></maml:section></MamlContent></KnowledgeArticle><KnowledgeArticle ElementID="Microsoft.SystemCenter.ACS.Collector.DBConnectionState" Visible="true"><MamlContent><maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10"><maml:title>Summary</maml:title><maml:para>This monitor and alert indicates that the ACS Collector has problem connecting to the database, and therefore it is unable to record events.</maml:para><maml:para /><maml:para>Below is a summary of the default configuration of this monitor:</maml:para><maml:list><maml:listItem><maml:para><maml:ui>Red state</maml:ui>: Transition to red state if the collector has problem connecting to the database (AdtServer
4618)</maml:para></maml:listItem><maml:listItem><maml:para><maml:ui>Green state</maml:ui>: Transition to green state if the collector has successfully connected to the database (AdtServer 4616).</maml:para></maml:listItem></maml:list><maml:para /><maml:para /></maml:section><maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10"><maml:title>Causes</maml:title><maml:para>The red state can indicate the following may be happening:</maml:para><maml:para /><maml:list><maml:listItem><maml:para>The database server is not online</maml:para></maml:listItem><maml:listItem><maml:para>Network connectivity between the collector and database is lost</maml:para></maml:listItem><maml:listItem><maml:para>The collector's machine account does not have permission to log on to the database.</maml:para></maml:listItem></maml:list><maml:para /></maml:section><maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10"><maml:title>Resolutions</maml:title><maml:para>You can use the below
steps to resolve the issue:</maml:para><maml:para /><maml:list><maml:listItem><maml:para>Bring the database back online if it is unavailable</maml:para></maml:listItem><maml:listItem><maml:para>Restore network connectivity between collector and database</maml:para></maml:listItem><maml:listItem><maml:para>Ensure the collector's machine account has permission to write to the OperationsManagerAC database. (The collector machine account needs permission because the collector service account runs as Network Service) If the machine account does not have proper permission, then try repairing this by uninstalling and reinstalling the collector.</maml:para></maml:listItem></maml:list><maml:para /></maml:section></MamlContent></KnowledgeArticle><KnowledgeArticle ElementID="Microsoft.SystemCenter.ACS.Collector.EventStreamGap" Visible="true"><MamlContent><maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10"><maml:title>Summary</maml:title><maml:para>This monitor and alert
indicates that the ACS Collector detected a gap from the incoming event stream from an ACS forwarder. This means some events may be missing due to event log wrapping or someone clearing the event log on the managed computer.</maml:para><maml:para /><maml:para>The alert is raised when the rule detects event: Source = AdtServer and ID = 4635.</maml:para><maml:para /></maml:section><maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10"><maml:title>Causes</maml:title><maml:para>The alert can indicate the following may be happening on the agent:</maml:para><maml:para /><maml:list><maml:listItem><maml:para>Someone cleared the event log when the forwarder lost connection to the collector</maml:para></maml:listItem><maml:listItem><maml:para>The event log wrapped when the forwarder lost connection to the collector</maml:para></maml:listItem></maml:list><maml:para /><maml:para /></maml:section><maml:section
xmlns:maml="http://schemas.microsoft.com/maml/2004/10"><maml:title>Resolutions</maml:title><maml:para /><maml:list><maml:listItem><maml:para>Run the "System Integrity - Audit Log Cleared" report to see if anyone had cleared the security log.</maml:para></maml:listItem><maml:listItem><maml:para>Ensure the security log size is large enough to queue events to endure a routine system maintenance or a typical troubleshooting duration.</maml:para></maml:listItem></maml:list><maml:para /><maml:para /></maml:section></MamlContent></KnowledgeArticle><KnowledgeArticle ElementID="Microsoft.SystemCenter.ACS.Collector.MaintainingClientConnections" Visible="true"><MamlContent><maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10"><maml:title>Summary</maml:title><maml:para>This monitor and alert indicates that the ACS Collector is disconnecting forwarders in order to reduce incoming traffic and allocate resources to service a backlog of events that need to be processed and written to
the database.</maml:para><maml:para /><maml:para>Below is a summary of the default configuration of this monitor:</maml:para><maml:list><maml:listItem><maml:para><maml:ui>Red state</maml:ui>: Transition to red state if the collector begins to disconnect existing forwarder sessions in order to service the backlog in the database queue (AdtServer 4615)</maml:para></maml:listItem><maml:listItem><maml:para><maml:ui>Green state</maml:ui>: Transition to green state if the collector begins to accept forwarders trying to connect again (AdtServer 4613).</maml:para></maml:listItem></maml:list><maml:para /></maml:section><maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10"><maml:title>Configuration</maml:title><maml:para>The red state can indicate the following:</maml:para><maml:para /><maml:list><maml:listItem><maml:para>A managed computer that has many existing security events in the security event log (e.g. a domain controller), attempts to forward security events to an ACS
collector for the first time. The forwarder on the managed computer will attempt to forward all of the events in the log to the collector very quickly, causing a buildup of events in the collector's database queue.</maml:para></maml:listItem><maml:listItem><maml:para>If the database is mounted on SQL Server Standard Edition, then during the daily database maintenance period when the database is performing indexing operations, the collector cannot write data to the database, causing backlog in the queue.</maml:para></maml:listItem><maml:listItem><maml:para>If this condition is persistent throughout the day, this may indicate the collector lacks capacity to manage the current number of forwarders.</maml:para></maml:listItem></maml:list><maml:para /></maml:section><maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10"><maml:title>Resolutions</maml:title><maml:para>You can use the below steps to resolve the issue:</maml:para><maml:para
/><maml:list><maml:listItem><maml:para>Consider using SQL Server Enterprise Edition</maml:para></maml:listItem><maml:listItem><maml:para>Consider adding more ACS Collectors</maml:para></maml:listItem></maml:list><maml:para /></maml:section></MamlContent></KnowledgeArticle><KnowledgeArticle ElementID="Microsoft.SystemCenter.AuditCollectionService.AvailabilityHealthRollup" Visible="true"><MamlContent><maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10"><maml:title>Summary</maml:title><maml:para>This rolls up overall availability health for the Audit Collection Service.</maml:para></maml:section></MamlContent></KnowledgeArticle><KnowledgeArticle ElementID="Microsoft.SystemCenter.AuditCollectionService.Forwarder.ServiceMonitor" Visible="true"><MamlContent><maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10"><maml:title>Summary</maml:title><maml:para>The Audit Collection Service has entered a stopped state. When the Audit Collection Service is not running,
no audit data is being forwarded to a Management Server.</maml:para></maml:section><maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10"><maml:title>Causes</maml:title><maml:para>The Agent side Audit Collection is not configured properly.</maml:para></maml:section><maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10"><maml:title>Resolutions</maml:title><maml:para>Check the System event logs to determine why the Audit Collection Service has entered a stopped state.</maml:para><maml:para>You can attempt to restart the service using the following link:</maml:para><maml:para><maml:navigationLink targetVerification="false"><maml:linkText>Start Audit Collection Service</maml:linkText><maml:uri condition="Task" href="Microsoft.SystemCenter.StartACSService&amp;tasktarget={$TARGET$}" uri="MOM.Console.Exe" /></maml:navigationLink></maml:para></maml:section></MamlContent></KnowledgeArticle><KnowledgeArticle ElementID="Microsoft.SystemCenter.ACSGroupPopulator"
Visible="true"><MamlContent><maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10"><maml:title>Summary</maml:title><maml:para>Discovers the members of the Audit Collection Services.</maml:para></maml:section></MamlContent></KnowledgeArticle><KnowledgeArticle ElementID="Microsoft.SystemCenter.ManagementGroup.ContainsAuditCollectionServiceGroupRelationship" Visible="true"><MamlContent><maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10"><maml:title>Summary</maml:title><maml:para>Relationship between the Audit Collection Services and the Management Group.</maml:para></maml:section></MamlContent></KnowledgeArticle></KnowledgeArticles></LanguagePack></LanguagePacks><Resources><Image ID="Microsoft.SystemCenter.ACS.Collector.16x16Image" Accessibility="Public" FileName="Microsoft.SystemCenter.ACS.Collector.16x16Image" HasNullStream="false" /><Image ID="Microsoft.SystemCenter.ACS.Collector.80x80Image" Accessibility="Public"
FileName="Microsoft.SystemCenter.ACS.Collector.80x80Image" HasNullStream="false" /></Resources></ManagementPack>
